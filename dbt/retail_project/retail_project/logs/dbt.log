[0m11:49:38.725160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a5c7a780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a5480860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a56c09b0>]}


============================== 11:49:38.737145 | 3e986f57-600c-4508-835a-063a96c8c39d ==============================
[0m11:49:38.737145 [info ] [MainThread]: Running with dbt=1.7.0
[0m11:49:38.742172 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/dbt/retail_project/retail_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps --profiles-dir /root/.dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:49:38.946283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e986f57-600c-4508-835a-063a96c8c39d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a53ae240>]}
[0m11:49:38.947043 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:49:38.955307 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:49:38.957899 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.28323352, "process_user_time": 2.448344, "process_kernel_time": 0.255489, "process_mem_max_rss": "151440", "process_in_blocks": "40", "process_out_blocks": "16"}
[0m11:49:38.958477 [debug] [MainThread]: Command `dbt deps` succeeded at 11:49:38.958347 after 0.28 seconds
[0m11:49:38.958814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a545f110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a56c09b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a56c2300>]}
[0m11:49:38.959860 [debug] [MainThread]: Flushing usage events
[0m11:49:44.778094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107de2f9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107db25fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107eec3ce0>]}


============================== 11:49:44.783059 | f0b9847b-b67f-496f-9555-48a2bd5f4ef2 ==============================
[0m11:49:44.783059 [info ] [MainThread]: Running with dbt=1.7.0
[0m11:49:44.786006 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/dbt/retail_project/retail_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /root/.dbt', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:49:45.009545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0b9847b-b67f-496f-9555-48a2bd5f4ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107d9a3f80>]}
[0m11:49:45.114664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0b9847b-b67f-496f-9555-48a2bd5f4ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107d137050>]}
[0m11:49:45.115477 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m11:49:45.125563 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m11:49:45.126156 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:49:45.127990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f0b9847b-b67f-496f-9555-48a2bd5f4ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107d16e6c0>]}
[0m11:49:46.343668 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail_project.intermediate
[0m11:49:46.350177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0b9847b-b67f-496f-9555-48a2bd5f4ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107c134cb0>]}
[0m11:49:46.363025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0b9847b-b67f-496f-9555-48a2bd5f4ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107cd16f90>]}
[0m11:49:46.363510 [info ] [MainThread]: Found 8 models, 4 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:49:46.364293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0b9847b-b67f-496f-9555-48a2bd5f4ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107f2b5760>]}
[0m11:49:46.367021 [info ] [MainThread]: 
[0m11:49:46.368463 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:49:46.370335 [debug] [ThreadPool]: Acquiring new postgres connection 'list_retail_dwh'
[0m11:49:46.382366 [debug] [ThreadPool]: Acquiring new postgres connection 'list_retail_dwh'
[0m11:49:46.386992 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh"
[0m11:49:46.389592 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh"
[0m11:49:46.390950 [debug] [ThreadPool]: On list_retail_dwh: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh"} */

    select distinct nspname from pg_namespace
  
[0m11:49:46.395814 [debug] [ThreadPool]: On list_retail_dwh: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh"} */

    select distinct nspname from pg_namespace
  
[0m11:49:46.396527 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:49:46.397733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:49:46.418142 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m11:49:46.420742 [debug] [ThreadPool]: On list_retail_dwh: Close
[0m11:49:46.424960 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m11:49:46.427185 [debug] [ThreadPool]: On list_retail_dwh: Close
[0m11:49:46.429766 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_dwh, now create_retail_dwh_marts_staging)
[0m11:49:46.431928 [debug] [ThreadPool]: Creating schema "database: "retail_dwh"
schema: "marts_staging"
"
[0m11:49:46.438623 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_dwh, now create_retail_dwh_marts_marts)
[0m11:49:46.440147 [debug] [ThreadPool]: Creating schema "database: "retail_dwh"
schema: "marts_marts"
"
[0m11:49:46.450070 [debug] [ThreadPool]: Using postgres connection "create_retail_dwh_marts_staging"
[0m11:49:46.451055 [debug] [ThreadPool]: On create_retail_dwh_marts_staging: BEGIN
[0m11:49:46.452196 [debug] [ThreadPool]: Using postgres connection "create_retail_dwh_marts_marts"
[0m11:49:46.452934 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:49:46.454036 [debug] [ThreadPool]: On create_retail_dwh_marts_marts: BEGIN
[0m11:49:46.455052 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:49:46.471967 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:49:46.472861 [debug] [ThreadPool]: Using postgres connection "create_retail_dwh_marts_marts"
[0m11:49:46.473253 [debug] [ThreadPool]: On create_retail_dwh_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "create_retail_dwh_marts_marts"} */
create schema if not exists "marts_marts"
[0m11:49:46.474204 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:49:46.474546 [debug] [ThreadPool]: Using postgres connection "create_retail_dwh_marts_staging"
[0m11:49:46.475157 [debug] [ThreadPool]: On create_retail_dwh_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "create_retail_dwh_marts_staging"} */
create schema if not exists "marts_staging"
[0m11:49:46.476035 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m11:49:46.478177 [debug] [ThreadPool]: On create_retail_dwh_marts_marts: COMMIT
[0m11:49:46.479014 [debug] [ThreadPool]: Using postgres connection "create_retail_dwh_marts_marts"
[0m11:49:46.479703 [debug] [ThreadPool]: On create_retail_dwh_marts_marts: COMMIT
[0m11:49:46.480324 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m11:49:46.482134 [debug] [ThreadPool]: On create_retail_dwh_marts_staging: COMMIT
[0m11:49:46.482534 [debug] [ThreadPool]: Using postgres connection "create_retail_dwh_marts_staging"
[0m11:49:46.482825 [debug] [ThreadPool]: On create_retail_dwh_marts_staging: COMMIT
[0m11:49:46.547903 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m11:49:46.548706 [debug] [ThreadPool]: On create_retail_dwh_marts_marts: Close
[0m11:49:46.551501 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m11:49:46.551935 [debug] [ThreadPool]: On create_retail_dwh_marts_staging: Close
[0m11:49:46.557164 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_retail_dwh_marts_staging, now list_retail_dwh_marts_staging)
[0m11:49:46.559324 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_retail_dwh_marts_marts, now list_retail_dwh_marts_marts)
[0m11:49:46.565996 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_staging"
[0m11:49:46.570096 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_marts"
[0m11:49:46.571761 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: BEGIN
[0m11:49:46.572936 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: BEGIN
[0m11:49:46.574062 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:49:46.575135 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:49:46.590596 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:49:46.591790 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:49:46.593079 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_marts"
[0m11:49:46.593854 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_staging"
[0m11:49:46.595210 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh_marts_marts"} */
select
      'retail_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'retail_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'retail_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m11:49:46.596601 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh_marts_staging"} */
select
      'retail_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'retail_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'retail_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m11:49:46.603866 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m11:49:46.605911 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: ROLLBACK
[0m11:49:46.606746 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m11:49:46.609462 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: ROLLBACK
[0m11:49:46.610860 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: Close
[0m11:49:46.612722 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: Close
[0m11:49:46.623172 [debug] [MainThread]: Using postgres connection "master"
[0m11:49:46.623600 [debug] [MainThread]: On master: BEGIN
[0m11:49:46.623887 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:49:46.639911 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:49:46.640407 [debug] [MainThread]: Using postgres connection "master"
[0m11:49:46.641236 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:49:46.666045 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m11:49:46.670196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0b9847b-b67f-496f-9555-48a2bd5f4ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107c19bc20>]}
[0m11:49:46.670738 [debug] [MainThread]: On master: ROLLBACK
[0m11:49:46.671948 [debug] [MainThread]: Using postgres connection "master"
[0m11:49:46.672598 [debug] [MainThread]: On master: BEGIN
[0m11:49:46.674169 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:49:46.674636 [debug] [MainThread]: On master: COMMIT
[0m11:49:46.675308 [debug] [MainThread]: Using postgres connection "master"
[0m11:49:46.675910 [debug] [MainThread]: On master: COMMIT
[0m11:49:46.677115 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:49:46.677455 [debug] [MainThread]: On master: Close
[0m11:49:46.679159 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:49:46.680925 [info ] [MainThread]: 
[0m11:49:46.693038 [debug] [Thread-1 (]: Began running node model.retail_project.stg_customers
[0m11:49:46.693992 [info ] [Thread-1 (]: 1 of 8 START sql view model marts_staging.stg_customers ........................ [RUN]
[0m11:49:46.697716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail_dwh_marts_marts, now model.retail_project.stg_customers)
[0m11:49:46.698365 [debug] [Thread-1 (]: Began compiling node model.retail_project.stg_customers
[0m11:49:46.706073 [debug] [Thread-2 (]: Began running node model.retail_project.stg_products
[0m11:49:46.707432 [info ] [Thread-2 (]: 2 of 8 START sql view model marts_staging.stg_products ......................... [RUN]
[0m11:49:46.710468 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_retail_dwh_marts_staging, now model.retail_project.stg_products)
[0m11:49:46.711882 [debug] [Thread-2 (]: Began compiling node model.retail_project.stg_products
[0m11:49:46.717577 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_project.stg_products"
[0m11:49:46.722828 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_project.stg_customers"
[0m11:49:46.723809 [debug] [Thread-3 (]: Began running node model.retail_project.stg_sales_transaction
[0m11:49:46.724954 [info ] [Thread-3 (]: 3 of 8 START sql view model marts_staging.stg_sales_transaction ................ [RUN]
[0m11:49:46.726767 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.retail_project.stg_sales_transaction'
[0m11:49:46.727884 [debug] [Thread-3 (]: Began compiling node model.retail_project.stg_sales_transaction
[0m11:49:46.735033 [debug] [Thread-4 (]: Began running node model.retail_project.stg_stores
[0m11:49:46.736272 [info ] [Thread-4 (]: 4 of 8 START sql view model marts_staging.stg_stores ........................... [RUN]
[0m11:49:46.738943 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.retail_project.stg_stores'
[0m11:49:46.739978 [debug] [Thread-4 (]: Began compiling node model.retail_project.stg_stores
[0m11:49:46.743163 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_project.stg_stores"
[0m11:49:46.746842 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_project.stg_sales_transaction"
[0m11:49:46.749070 [debug] [Thread-1 (]: Timing info for model.retail_project.stg_customers (compile): 11:49:46.699102 => 11:49:46.748720
[0m11:49:46.751053 [debug] [Thread-4 (]: Timing info for model.retail_project.stg_stores (compile): 11:49:46.740427 => 11:49:46.750591
[0m11:49:46.752400 [debug] [Thread-1 (]: Began executing node model.retail_project.stg_customers
[0m11:49:46.753954 [debug] [Thread-2 (]: Timing info for model.retail_project.stg_products (compile): 11:49:46.712310 => 11:49:46.753324
[0m11:49:46.755164 [debug] [Thread-4 (]: Began executing node model.retail_project.stg_stores
[0m11:49:46.756109 [debug] [Thread-3 (]: Timing info for model.retail_project.stg_sales_transaction (compile): 11:49:46.728407 => 11:49:46.755776
[0m11:49:46.794287 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_project.stg_customers"
[0m11:49:46.796971 [debug] [Thread-2 (]: Began executing node model.retail_project.stg_products
[0m11:49:46.805557 [debug] [Thread-3 (]: Began executing node model.retail_project.stg_sales_transaction
[0m11:49:46.806530 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_project.stg_stores"
[0m11:49:46.812905 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_project.stg_products"
[0m11:49:46.819706 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_project.stg_sales_transaction"
[0m11:49:46.822004 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m11:49:46.823431 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m11:49:46.825223 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m11:49:46.826397 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m11:49:46.827988 [debug] [Thread-1 (]: On model.retail_project.stg_customers: BEGIN
[0m11:49:46.829060 [debug] [Thread-4 (]: On model.retail_project.stg_stores: BEGIN
[0m11:49:46.829987 [debug] [Thread-2 (]: On model.retail_project.stg_products: BEGIN
[0m11:49:46.830861 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: BEGIN
[0m11:49:46.831936 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:49:46.833066 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:49:46.833969 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:49:46.835027 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:49:46.851797 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:49:46.852585 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m11:49:46.854087 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */

  create view "retail_dwh"."marts_staging"."stg_products__dbt_tmp"
    
    
  as (
    SELECT
    product_id,
    product_name,
    TRIM(category) AS product_category,
    TRIM(sub_category) AS product_sub_category,
    CAST(price AS NUMERIC) AS product_price
FROM
    "retail_dwh"."raw"."products_raw"
  );
[0m11:49:46.857866 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:49:46.859037 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m11:49:46.859950 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */

  create view "retail_dwh"."marts_staging"."stg_customers__dbt_tmp"
    
    
  as (
    SELECT
    customer_id,
    customer_name,
    UPPER(TRIM(gender)) AS customer_gender,
    TRIM(city) AS customer_city,
    CAST(signup_date AS DATE) AS customer_signup_date
FROM
    "retail_dwh"."raw"."customers_raw"
  );
[0m11:49:46.862078 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:49:46.862476 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m11:49:46.862847 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */

  create view "retail_dwh"."marts_staging"."stg_stores__dbt_tmp"
    
    
  as (
    SELECT
    store_id,
    store_name,
    TRIM(address) AS store_address,
    TRIM(city) AS store_city,
    CAST(open_date AS DATE) AS store_open_date
FROM
    "retail_dwh"."raw"."stores_raw"
  );
[0m11:49:46.860990 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:49:46.863860 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:49:46.871745 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m11:49:46.874134 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column "address" does not exist
LINE 10:     TRIM(address) AS store_address,
                  ^

[0m11:49:46.875596 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m11:49:46.877478 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:49:46.879122 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
alter table "retail_dwh"."marts_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m11:49:46.880116 [debug] [Thread-4 (]: On model.retail_project.stg_stores: ROLLBACK
[0m11:49:46.881096 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */

  create view "retail_dwh"."marts_staging"."stg_sales_transaction__dbt_tmp"
    
    
  as (
    SELECT
    transaction_id,
    CAST(transaction_date AS DATE) AS transaction_date,
    customer_id,
    product_id,
    store_id,
    CAST(quantity AS INTEGER) AS quantity,
    CAST(total_price AS NUMERIC) AS total_price
FROM
    "retail_dwh"."raw"."sales_transaction_raw"
  );
[0m11:49:46.886585 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m11:49:46.890228 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
alter table "retail_dwh"."marts_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m11:49:46.891119 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:49:46.892876 [debug] [Thread-4 (]: Timing info for model.retail_project.stg_stores (execute): 11:49:46.797775 => 11:49:46.892048
[0m11:49:46.894915 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:49:46.912769 [debug] [Thread-2 (]: On model.retail_project.stg_products: COMMIT
[0m11:49:46.915267 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:49:46.916505 [debug] [Thread-4 (]: On model.retail_project.stg_stores: Close
[0m11:49:46.920909 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m11:49:46.923009 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m11:49:46.926676 [debug] [Thread-1 (]: On model.retail_project.stg_customers: COMMIT
[0m11:49:46.928074 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */
alter table "retail_dwh"."marts_staging"."stg_sales_transaction__dbt_tmp" rename to "stg_sales_transaction"
[0m11:49:46.934311 [debug] [Thread-2 (]: On model.retail_project.stg_products: COMMIT
[0m11:49:46.935906 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m11:49:46.940921 [debug] [Thread-1 (]: On model.retail_project.stg_customers: COMMIT
[0m11:49:46.939057 [debug] [Thread-4 (]: Database Error in model stg_stores (models/staging/stg_stores.sql)
  column "address" does not exist
  LINE 10:     TRIM(address) AS store_address,
                    ^
  compiled Code at target/run/retail_project/models/staging/stg_stores.sql
[0m11:49:46.942325 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0b9847b-b67f-496f-9555-48a2bd5f4ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107c57a750>]}
[0m11:49:46.943681 [error] [Thread-4 (]: 4 of 8 ERROR creating sql view model marts_staging.stg_stores .................. [[31mERROR[0m in 0.20s]
[0m11:49:46.946368 [debug] [Thread-4 (]: Finished running node model.retail_project.stg_stores
[0m11:49:46.947919 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:49:46.948975 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:49:46.949561 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:49:46.953228 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: COMMIT
[0m11:49:46.962959 [debug] [Thread-2 (]: Applying DROP to: "retail_dwh"."marts_staging"."stg_products__dbt_backup"
[0m11:49:46.972258 [debug] [Thread-1 (]: Applying DROP to: "retail_dwh"."marts_staging"."stg_customers__dbt_backup"
[0m11:49:46.973779 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m11:49:46.974865 [debug] [Thread-4 (]: Began running node model.retail_project.dim_store
[0m11:49:46.982057 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m11:49:46.985975 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m11:49:46.987617 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: COMMIT
[0m11:49:46.989168 [info ] [Thread-4 (]: 5 of 8 SKIP relation marts_marts.dim_store ..................................... [[33mSKIP[0m]
[0m11:49:46.990729 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
drop view if exists "retail_dwh"."marts_staging"."stg_products__dbt_backup" cascade
[0m11:49:46.991872 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
drop view if exists "retail_dwh"."marts_staging"."stg_customers__dbt_backup" cascade
[0m11:49:46.993277 [debug] [Thread-4 (]: Finished running node model.retail_project.dim_store
[0m11:49:46.995713 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:49:47.002821 [debug] [Thread-2 (]: Timing info for model.retail_project.stg_products (execute): 11:49:46.808262 => 11:49:47.002241
[0m11:49:47.004101 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:49:47.005260 [debug] [Thread-2 (]: On model.retail_project.stg_products: Close
[0m11:49:47.006562 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:49:47.012477 [debug] [Thread-3 (]: Applying DROP to: "retail_dwh"."marts_staging"."stg_sales_transaction__dbt_backup"
[0m11:49:47.014884 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0b9847b-b67f-496f-9555-48a2bd5f4ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107c1f1d00>]}
[0m11:49:47.019031 [debug] [Thread-1 (]: Timing info for model.retail_project.stg_customers (execute): 11:49:46.757155 => 11:49:47.018738
[0m11:49:47.021766 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m11:49:47.023345 [info ] [Thread-2 (]: 2 of 8 OK created sql view model marts_staging.stg_products .................... [[32mCREATE VIEW[0m in 0.31s]
[0m11:49:47.028235 [debug] [Thread-2 (]: Finished running node model.retail_project.stg_products
[0m11:49:47.026610 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */
drop view if exists "retail_dwh"."marts_staging"."stg_sales_transaction__dbt_backup" cascade
[0m11:49:47.024831 [debug] [Thread-1 (]: On model.retail_project.stg_customers: Close
[0m11:49:47.031050 [debug] [Thread-4 (]: Began running node model.retail_project.dim_product
[0m11:49:47.032695 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0b9847b-b67f-496f-9555-48a2bd5f4ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107c1f9910>]}
[0m11:49:47.035138 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:49:47.034302 [info ] [Thread-4 (]: 6 of 8 START sql view model marts_marts.dim_product ............................ [RUN]
[0m11:49:47.040419 [debug] [Thread-3 (]: Timing info for model.retail_project.stg_sales_transaction (execute): 11:49:46.814159 => 11:49:47.040142
[0m11:49:47.036969 [info ] [Thread-1 (]: 1 of 8 OK created sql view model marts_staging.stg_customers ................... [[32mCREATE VIEW[0m in 0.34s]
[0m11:49:47.042041 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_stores, now model.retail_project.dim_product)
[0m11:49:47.043745 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: Close
[0m11:49:47.045228 [debug] [Thread-1 (]: Finished running node model.retail_project.stg_customers
[0m11:49:47.046123 [debug] [Thread-4 (]: Began compiling node model.retail_project.dim_product
[0m11:49:47.047534 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0b9847b-b67f-496f-9555-48a2bd5f4ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107c1bda00>]}
[0m11:49:47.052406 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_project.dim_product"
[0m11:49:47.053894 [debug] [Thread-2 (]: Began running node model.retail_project.dim_customer
[0m11:49:47.055286 [info ] [Thread-3 (]: 3 of 8 OK created sql view model marts_staging.stg_sales_transaction ........... [[32mCREATE VIEW[0m in 0.32s]
[0m11:49:47.056886 [info ] [Thread-2 (]: 7 of 8 START sql view model marts_marts.dim_customer ........................... [RUN]
[0m11:49:47.058770 [debug] [Thread-3 (]: Finished running node model.retail_project.stg_sales_transaction
[0m11:49:47.061083 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_products, now model.retail_project.dim_customer)
[0m11:49:47.061867 [debug] [Thread-4 (]: Timing info for model.retail_project.dim_product (compile): 11:49:47.049138 => 11:49:47.061609
[0m11:49:47.063303 [debug] [Thread-2 (]: Began compiling node model.retail_project.dim_customer
[0m11:49:47.064092 [debug] [Thread-4 (]: Began executing node model.retail_project.dim_product
[0m11:49:47.069262 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_project.dim_customer"
[0m11:49:47.074426 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_project.dim_product"
[0m11:49:47.076747 [debug] [Thread-2 (]: Timing info for model.retail_project.dim_customer (compile): 11:49:47.065182 => 11:49:47.075824
[0m11:49:47.077533 [debug] [Thread-2 (]: Began executing node model.retail_project.dim_customer
[0m11:49:47.084433 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_product"
[0m11:49:47.085065 [debug] [Thread-4 (]: On model.retail_project.dim_product: BEGIN
[0m11:49:47.085619 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:49:47.090387 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_project.dim_customer"
[0m11:49:47.091969 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_customer"
[0m11:49:47.092611 [debug] [Thread-2 (]: On model.retail_project.dim_customer: BEGIN
[0m11:49:47.093089 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:49:47.101475 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:49:47.102393 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_product"
[0m11:49:47.102951 [debug] [Thread-4 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */

  create view "retail_dwh"."marts_marts"."dim_product__dbt_tmp"
    
    
  as (
    SELECT
    product_id,
    product_name,
    product_category,
    product_sub_category,
    product_price
FROM
    "retail_dwh"."marts_staging"."stg_products"
  );
[0m11:49:47.106159 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:49:47.113453 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_product"
[0m11:49:47.115042 [debug] [Thread-4 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */
alter table "retail_dwh"."marts_marts"."dim_product__dbt_tmp" rename to "dim_product"
[0m11:49:47.116685 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:49:47.118001 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_customer"
[0m11:49:47.118855 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:49:47.120069 [debug] [Thread-2 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */

  create view "retail_dwh"."marts_marts"."dim_customer__dbt_tmp"
    
    
  as (
    SELECT
    customer_id,
    customer_name,
    customer_gender,
    customer_city,
    customer_signup_date
FROM
    "retail_dwh"."marts_staging"."stg_customers"
  );
[0m11:49:47.123325 [debug] [Thread-4 (]: On model.retail_project.dim_product: COMMIT
[0m11:49:47.124874 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_product"
[0m11:49:47.125369 [debug] [Thread-4 (]: On model.retail_project.dim_product: COMMIT
[0m11:49:47.127015 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:49:47.132098 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_customer"
[0m11:49:47.134496 [debug] [Thread-2 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */
alter table "retail_dwh"."marts_marts"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m11:49:47.135611 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m11:49:47.140894 [debug] [Thread-4 (]: Applying DROP to: "retail_dwh"."marts_marts"."dim_product__dbt_backup"
[0m11:49:47.142451 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_product"
[0m11:49:47.143384 [debug] [Thread-4 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */
drop view if exists "retail_dwh"."marts_marts"."dim_product__dbt_backup" cascade
[0m11:49:47.144146 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:49:47.147185 [debug] [Thread-2 (]: On model.retail_project.dim_customer: COMMIT
[0m11:49:47.147977 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_customer"
[0m11:49:47.148527 [debug] [Thread-2 (]: On model.retail_project.dim_customer: COMMIT
[0m11:49:47.150711 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:49:47.153787 [debug] [Thread-4 (]: Timing info for model.retail_project.dim_product (execute): 11:49:47.069946 => 11:49:47.153520
[0m11:49:47.154817 [debug] [Thread-4 (]: On model.retail_project.dim_product: Close
[0m11:49:47.155747 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:49:47.160256 [debug] [Thread-2 (]: Applying DROP to: "retail_dwh"."marts_marts"."dim_customer__dbt_backup"
[0m11:49:47.162252 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_customer"
[0m11:49:47.162883 [debug] [Thread-2 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */
drop view if exists "retail_dwh"."marts_marts"."dim_customer__dbt_backup" cascade
[0m11:49:47.164890 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0b9847b-b67f-496f-9555-48a2bd5f4ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107b9560c0>]}
[0m11:49:47.165984 [info ] [Thread-4 (]: 6 of 8 OK created sql view model marts_marts.dim_product ....................... [[32mCREATE VIEW[0m in 0.12s]
[0m11:49:47.167674 [debug] [Thread-4 (]: Finished running node model.retail_project.dim_product
[0m11:49:47.168960 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:49:47.171885 [debug] [Thread-2 (]: Timing info for model.retail_project.dim_customer (execute): 11:49:47.078483 => 11:49:47.171595
[0m11:49:47.172785 [debug] [Thread-2 (]: On model.retail_project.dim_customer: Close
[0m11:49:47.174050 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0b9847b-b67f-496f-9555-48a2bd5f4ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107b943080>]}
[0m11:49:47.174898 [info ] [Thread-2 (]: 7 of 8 OK created sql view model marts_marts.dim_customer ...................... [[32mCREATE VIEW[0m in 0.11s]
[0m11:49:47.177136 [debug] [Thread-2 (]: Finished running node model.retail_project.dim_customer
[0m11:49:47.179176 [debug] [Thread-1 (]: Began running node model.retail_project.fact_sales
[0m11:49:47.180169 [info ] [Thread-1 (]: 8 of 8 START sql view model marts_marts.fact_sales ............................. [RUN]
[0m11:49:47.181018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_customers, now model.retail_project.fact_sales)
[0m11:49:47.182438 [debug] [Thread-1 (]: Began compiling node model.retail_project.fact_sales
[0m11:49:47.186353 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_project.fact_sales"
[0m11:49:47.187115 [debug] [Thread-1 (]: Timing info for model.retail_project.fact_sales (compile): 11:49:47.182928 => 11:49:47.186869
[0m11:49:47.187552 [debug] [Thread-1 (]: Began executing node model.retail_project.fact_sales
[0m11:49:47.191824 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_project.fact_sales"
[0m11:49:47.192524 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.fact_sales"
[0m11:49:47.192880 [debug] [Thread-1 (]: On model.retail_project.fact_sales: BEGIN
[0m11:49:47.193206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:49:47.208985 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:49:47.209478 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.fact_sales"
[0m11:49:47.209852 [debug] [Thread-1 (]: On model.retail_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.fact_sales"} */

  create view "retail_dwh"."marts_marts"."fact_sales__dbt_tmp"
    
    
  as (
    SELECT
    -- Kunci Unik
    transaction_id,
    
    -- Kunci Asing (FKs)
    transaction_date,
    customer_id,
    product_id,
    store_id,
    
    -- Metrik
    quantity,
    total_price,
    
    -- Metrik Turunan
    (quantity * product.product_price) AS calculated_revenue
    
FROM
    "retail_dwh"."marts_staging"."stg_sales_transaction" AS sales
LEFT JOIN
    -- Join ke dim_product untuk mendapatkan harga saat ini
    "retail_dwh"."marts_marts"."dim_product" AS product
ON
    sales.product_id = product.product_id
  );
[0m11:49:47.212201 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column reference "product_id" is ambiguous
LINE 14:     product_id,
             ^

[0m11:49:47.213230 [debug] [Thread-1 (]: On model.retail_project.fact_sales: ROLLBACK
[0m11:49:47.214720 [debug] [Thread-1 (]: Timing info for model.retail_project.fact_sales (execute): 11:49:47.187774 => 11:49:47.214219
[0m11:49:47.215475 [debug] [Thread-1 (]: On model.retail_project.fact_sales: Close
[0m11:49:47.221858 [debug] [Thread-1 (]: Database Error in model fact_sales (models/marts/facts/fact_sales.sql)
  column reference "product_id" is ambiguous
  LINE 14:     product_id,
               ^
  compiled Code at target/run/retail_project/models/marts/facts/fact_sales.sql
[0m11:49:47.222396 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0b9847b-b67f-496f-9555-48a2bd5f4ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107b943080>]}
[0m11:49:47.223210 [error] [Thread-1 (]: 8 of 8 ERROR creating sql view model marts_marts.fact_sales .................... [[31mERROR[0m in 0.04s]
[0m11:49:47.224617 [debug] [Thread-1 (]: Finished running node model.retail_project.fact_sales
[0m11:49:47.231160 [debug] [MainThread]: Using postgres connection "master"
[0m11:49:47.231574 [debug] [MainThread]: On master: BEGIN
[0m11:49:47.232195 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:49:47.246915 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:49:47.247826 [debug] [MainThread]: On master: COMMIT
[0m11:49:47.248189 [debug] [MainThread]: Using postgres connection "master"
[0m11:49:47.248722 [debug] [MainThread]: On master: COMMIT
[0m11:49:47.249861 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:49:47.250259 [debug] [MainThread]: On master: Close
[0m11:49:47.251920 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:49:47.252412 [debug] [MainThread]: Connection 'model.retail_project.fact_sales' was properly closed.
[0m11:49:47.253069 [debug] [MainThread]: Connection 'model.retail_project.dim_customer' was properly closed.
[0m11:49:47.253487 [debug] [MainThread]: Connection 'model.retail_project.stg_sales_transaction' was properly closed.
[0m11:49:47.253916 [debug] [MainThread]: Connection 'model.retail_project.dim_product' was properly closed.
[0m11:49:47.254848 [info ] [MainThread]: 
[0m11:49:47.255446 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 0.89 seconds (0.89s).
[0m11:49:47.257755 [debug] [MainThread]: Command end result
[0m11:49:47.270687 [info ] [MainThread]: 
[0m11:49:47.271546 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m11:49:47.272692 [info ] [MainThread]: 
[0m11:49:47.273421 [error] [MainThread]:   Database Error in model stg_stores (models/staging/stg_stores.sql)
  column "address" does not exist
  LINE 10:     TRIM(address) AS store_address,
                    ^
  compiled Code at target/run/retail_project/models/staging/stg_stores.sql
[0m11:49:47.275092 [info ] [MainThread]: 
[0m11:49:47.275919 [error] [MainThread]:   Database Error in model fact_sales (models/marts/facts/fact_sales.sql)
  column reference "product_id" is ambiguous
  LINE 14:     product_id,
               ^
  compiled Code at target/run/retail_project/models/marts/facts/fact_sales.sql
[0m11:49:47.276456 [info ] [MainThread]: 
[0m11:49:47.277293 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=1 TOTAL=8
[0m11:49:47.279134 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.5524635, "process_user_time": 3.714206, "process_kernel_time": 0.920693, "process_mem_max_rss": "151336", "process_out_blocks": "2624", "command_success": false, "process_in_blocks": "0"}
[0m11:49:47.280235 [debug] [MainThread]: Command `dbt run` failed at 11:49:47.279720 after 2.55 seconds
[0m11:49:47.280904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107de2f9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107c135160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107b9497f0>]}
[0m11:49:47.281286 [debug] [MainThread]: Flushing usage events
[0m11:54:09.375206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda31d60ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda31e25ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda31d61280>]}


============================== 11:54:09.379086 | 16497f22-abfe-45fe-9fff-51917d60790c ==============================
[0m11:54:09.379086 [info ] [MainThread]: Running with dbt=1.7.0
[0m11:54:09.380290 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/opt/dbt/retail_project/retail_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /root/.dbt', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:54:09.763760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16497f22-abfe-45fe-9fff-51917d60790c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda31ecfb90>]}
[0m11:54:09.905197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16497f22-abfe-45fe-9fff-51917d60790c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda3693b380>]}
[0m11:54:09.905983 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m11:54:09.920942 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m11:54:09.954800 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:54:09.957057 [debug] [MainThread]: Partial parsing: updated file: retail_project://models/marts/facts/fact_sales.sql
[0m11:54:09.957596 [debug] [MainThread]: Partial parsing: updated file: retail_project://models/staging/stg_stores.sql
[0m11:54:10.219853 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.retail_project.stg_stores' (models/staging/stg_stores.sql) depends on a source named 'retail_raw.stores_raw' which was not found
[0m11:54:10.221694 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.91683567, "process_user_time": 3.869729, "process_kernel_time": 0.515637, "process_mem_max_rss": "151264", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m11:54:10.222260 [debug] [MainThread]: Command `dbt run` failed at 11:54:10.222126 after 0.92 seconds
[0m11:54:10.222654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda320a09b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda30fb5eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda30fc7d40>]}
[0m11:54:10.223010 [debug] [MainThread]: Flushing usage events
[0m11:57:51.478389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7992559b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79927afce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7992690bf0>]}


============================== 11:57:51.481564 | b5592f65-1264-4a18-970d-6d7b150cdd08 ==============================
[0m11:57:51.481564 [info ] [MainThread]: Running with dbt=1.7.0
[0m11:57:51.484629 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/opt/dbt/retail_project/retail_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /root/.dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:57:51.712884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5592f65-1264-4a18-970d-6d7b150cdd08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7991da6ae0>]}
[0m11:57:51.841436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5592f65-1264-4a18-970d-6d7b150cdd08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79919a4da0>]}
[0m11:57:51.842465 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m11:57:51.854853 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m11:57:51.887672 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m11:57:51.888987 [debug] [MainThread]: Partial parsing: updated file: retail_project://models/sources.yml
[0m11:57:51.889376 [debug] [MainThread]: Partial parsing: updated file: retail_project://models/marts/facts/fact_sales.sql
[0m11:57:51.889749 [debug] [MainThread]: Partial parsing: updated file: retail_project://models/staging/stg_stores.sql
[0m11:57:52.320921 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail_project.intermediate
[0m11:57:52.330438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5592f65-1264-4a18-970d-6d7b150cdd08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7990de3b90>]}
[0m11:57:52.350638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5592f65-1264-4a18-970d-6d7b150cdd08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79915606e0>]}
[0m11:57:52.351400 [info ] [MainThread]: Found 8 models, 4 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:57:52.352219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5592f65-1264-4a18-970d-6d7b150cdd08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f799117df70>]}
[0m11:57:52.355470 [info ] [MainThread]: 
[0m11:57:52.357170 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:57:52.360024 [debug] [ThreadPool]: Acquiring new postgres connection 'list_retail_dwh'
[0m11:57:52.376922 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh"
[0m11:57:52.378126 [debug] [ThreadPool]: On list_retail_dwh: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh"} */

    select distinct nspname from pg_namespace
  
[0m11:57:52.379414 [debug] [ThreadPool]: Acquiring new postgres connection 'list_retail_dwh'
[0m11:57:52.380276 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:57:52.385351 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh"
[0m11:57:52.387328 [debug] [ThreadPool]: On list_retail_dwh: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh"} */

    select distinct nspname from pg_namespace
  
[0m11:57:52.388200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:57:52.407259 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m11:57:52.409864 [debug] [ThreadPool]: On list_retail_dwh: Close
[0m11:57:52.410774 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m11:57:52.412796 [debug] [ThreadPool]: On list_retail_dwh: Close
[0m11:57:52.420078 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_dwh, now list_retail_dwh_marts_marts)
[0m11:57:52.429062 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_dwh, now list_retail_dwh_marts_staging)
[0m11:57:52.441362 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_staging"
[0m11:57:52.442316 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: BEGIN
[0m11:57:52.443054 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:57:52.446924 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_marts"
[0m11:57:52.448031 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: BEGIN
[0m11:57:52.448550 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:57:52.458876 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:57:52.459330 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_staging"
[0m11:57:52.459675 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh_marts_staging"} */
select
      'retail_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'retail_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'retail_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m11:57:52.460707 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:57:52.461165 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_marts"
[0m11:57:52.461483 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh_marts_marts"} */
select
      'retail_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'retail_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'retail_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m11:57:52.463514 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m11:57:52.465961 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: ROLLBACK
[0m11:57:52.466958 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m11:57:52.468738 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: ROLLBACK
[0m11:57:52.469308 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: Close
[0m11:57:52.469887 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: Close
[0m11:57:52.485910 [debug] [MainThread]: Using postgres connection "master"
[0m11:57:52.486667 [debug] [MainThread]: On master: BEGIN
[0m11:57:52.487691 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:57:52.502032 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:57:52.503018 [debug] [MainThread]: Using postgres connection "master"
[0m11:57:52.503796 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:57:52.535037 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m11:57:52.541120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5592f65-1264-4a18-970d-6d7b150cdd08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7991143dd0>]}
[0m11:57:52.542125 [debug] [MainThread]: On master: ROLLBACK
[0m11:57:52.543692 [debug] [MainThread]: Using postgres connection "master"
[0m11:57:52.544087 [debug] [MainThread]: On master: BEGIN
[0m11:57:52.545812 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:57:52.546580 [debug] [MainThread]: On master: COMMIT
[0m11:57:52.547311 [debug] [MainThread]: Using postgres connection "master"
[0m11:57:52.547615 [debug] [MainThread]: On master: COMMIT
[0m11:57:52.548737 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:57:52.549426 [debug] [MainThread]: On master: Close
[0m11:57:52.551465 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:57:52.552017 [info ] [MainThread]: 
[0m11:57:52.561864 [debug] [Thread-1 (]: Began running node model.retail_project.stg_customers
[0m11:57:52.565679 [info ] [Thread-1 (]: 1 of 8 START sql view model marts_staging.stg_customers ........................ [RUN]
[0m11:57:52.564167 [debug] [Thread-3 (]: Began running node model.retail_project.stg_sales_transaction
[0m11:57:52.563481 [debug] [Thread-2 (]: Began running node model.retail_project.stg_products
[0m11:57:52.567947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail_dwh_marts_marts, now model.retail_project.stg_customers)
[0m11:57:52.570815 [info ] [Thread-3 (]: 3 of 8 START sql view model marts_staging.stg_sales_transaction ................ [RUN]
[0m11:57:52.572180 [info ] [Thread-2 (]: 2 of 8 START sql view model marts_staging.stg_products ......................... [RUN]
[0m11:57:52.573843 [debug] [Thread-1 (]: Began compiling node model.retail_project.stg_customers
[0m11:57:52.574484 [debug] [Thread-4 (]: Began running node model.retail_project.stg_stores
[0m11:57:52.576933 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.retail_project.stg_sales_transaction'
[0m11:57:52.596476 [debug] [Thread-3 (]: Began compiling node model.retail_project.stg_sales_transaction
[0m11:57:52.587047 [info ] [Thread-4 (]: 4 of 8 START sql view model marts_staging.stg_stores ........................... [RUN]
[0m11:57:52.594325 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_project.stg_customers"
[0m11:57:52.578413 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_retail_dwh_marts_staging, now model.retail_project.stg_products)
[0m11:57:52.602238 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_project.stg_sales_transaction"
[0m11:57:52.605124 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.retail_project.stg_stores'
[0m11:57:52.607263 [debug] [Thread-2 (]: Began compiling node model.retail_project.stg_products
[0m11:57:52.609889 [debug] [Thread-1 (]: Timing info for model.retail_project.stg_customers (compile): 11:57:52.579825 => 11:57:52.609248
[0m11:57:52.616632 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_project.stg_products"
[0m11:57:52.612219 [debug] [Thread-3 (]: Timing info for model.retail_project.stg_sales_transaction (compile): 11:57:52.597031 => 11:57:52.611963
[0m11:57:52.611294 [debug] [Thread-4 (]: Began compiling node model.retail_project.stg_stores
[0m11:57:52.618710 [debug] [Thread-1 (]: Began executing node model.retail_project.stg_customers
[0m11:57:52.620724 [debug] [Thread-3 (]: Began executing node model.retail_project.stg_sales_transaction
[0m11:57:52.624919 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_project.stg_stores"
[0m11:57:52.626766 [debug] [Thread-2 (]: Timing info for model.retail_project.stg_products (compile): 11:57:52.612894 => 11:57:52.625981
[0m11:57:52.681832 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_project.stg_sales_transaction"
[0m11:57:52.668627 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_project.stg_customers"
[0m11:57:52.684349 [debug] [Thread-2 (]: Began executing node model.retail_project.stg_products
[0m11:57:52.688871 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m11:57:52.694645 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_project.stg_products"
[0m11:57:52.697228 [debug] [Thread-4 (]: Timing info for model.retail_project.stg_stores (compile): 11:57:52.621783 => 11:57:52.696709
[0m11:57:52.698356 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: BEGIN
[0m11:57:52.701128 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m11:57:52.702987 [debug] [Thread-4 (]: Began executing node model.retail_project.stg_stores
[0m11:57:52.705859 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:57:52.704707 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m11:57:52.707013 [debug] [Thread-1 (]: On model.retail_project.stg_customers: BEGIN
[0m11:57:52.714010 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_project.stg_stores"
[0m11:57:52.716070 [debug] [Thread-2 (]: On model.retail_project.stg_products: BEGIN
[0m11:57:52.718840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:57:52.721243 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:57:52.724048 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m11:57:52.725388 [debug] [Thread-4 (]: On model.retail_project.stg_stores: BEGIN
[0m11:57:52.726349 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:57:52.738380 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:57:52.739098 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m11:57:52.739779 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */

  create view "retail_dwh"."marts_staging"."stg_customers__dbt_tmp"
    
    
  as (
    SELECT
    customer_id,
    customer_name,
    UPPER(TRIM(gender)) AS customer_gender,
    TRIM(city) AS customer_city,
    CAST(signup_date AS DATE) AS customer_signup_date
FROM
    "retail_dwh"."raw"."customers_raw"
  );
[0m11:57:52.746037 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:57:52.747817 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m11:57:52.749239 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */

  create view "retail_dwh"."marts_staging"."stg_sales_transaction__dbt_tmp"
    
    
  as (
    SELECT
    transaction_id,
    CAST(transaction_date AS DATE) AS transaction_date,
    customer_id,
    product_id,
    store_id,
    CAST(quantity AS INTEGER) AS quantity,
    CAST(total_price AS NUMERIC) AS total_price
FROM
    "retail_dwh"."raw"."sales_transaction_raw"
  );
[0m11:57:52.752279 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:57:52.753023 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m11:57:52.755392 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */

  create view "retail_dwh"."marts_staging"."stg_stores__dbt_tmp"
    
    
  as (
    with source as (
    select
        store_id,
        store_name,
        city,
        region
    from "retail_dwh"."raw"."stores_raw"
),

renamed as (
    select
        store_id,
        store_name,
        city,
        region as store_region
    from source
)

select * from renamed;
  );
[0m11:57:52.758312 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:57:52.759433 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:57:52.760344 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 25: select * from renamed;
                              ^

[0m11:57:52.761378 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:57:52.770261 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m11:57:52.772701 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m11:57:52.773847 [debug] [Thread-4 (]: On model.retail_project.stg_stores: ROLLBACK
[0m11:57:52.778484 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m11:57:52.780453 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */
alter table "retail_dwh"."marts_staging"."stg_sales_transaction" rename to "stg_sales_transaction__dbt_backup"
[0m11:57:52.783242 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */

  create view "retail_dwh"."marts_staging"."stg_products__dbt_tmp"
    
    
  as (
    SELECT
    product_id,
    product_name,
    TRIM(category) AS product_category,
    TRIM(sub_category) AS product_sub_category,
    CAST(price AS NUMERIC) AS product_price
FROM
    "retail_dwh"."raw"."products_raw"
  );
[0m11:57:52.785342 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
alter table "retail_dwh"."marts_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m11:57:52.786820 [debug] [Thread-4 (]: Timing info for model.retail_project.stg_stores (execute): 11:57:52.707879 => 11:57:52.786070
[0m11:57:52.789023 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:57:52.791195 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:57:52.792361 [debug] [Thread-4 (]: On model.retail_project.stg_stores: Close
[0m11:57:52.793815 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:57:52.798543 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m11:57:52.803346 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m11:57:52.812171 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m11:57:52.817473 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */
alter table "retail_dwh"."marts_staging"."stg_sales_transaction__dbt_tmp" rename to "stg_sales_transaction"
[0m11:57:52.819033 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
alter table "retail_dwh"."marts_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m11:57:52.822338 [debug] [Thread-4 (]: Database Error in model stg_stores (models/staging/stg_stores.sql)
  syntax error at or near ";"
  LINE 25: select * from renamed;
                                ^
  compiled Code at target/run/retail_project/models/staging/stg_stores.sql
[0m11:57:52.823749 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
alter table "retail_dwh"."marts_staging"."stg_products" rename to "stg_products__dbt_backup"
[0m11:57:52.826996 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5592f65-1264-4a18-970d-6d7b150cdd08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7990d43230>]}
[0m11:57:52.828057 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:57:52.829353 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:57:52.831339 [error] [Thread-4 (]: 4 of 8 ERROR creating sql view model marts_staging.stg_stores .................. [[31mERROR[0m in 0.22s]
[0m11:57:52.833787 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:57:52.868105 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: COMMIT
[0m11:57:52.872294 [debug] [Thread-4 (]: Finished running node model.retail_project.stg_stores
[0m11:57:52.876537 [debug] [Thread-1 (]: On model.retail_project.stg_customers: COMMIT
[0m11:57:52.881539 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m11:57:52.883879 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m11:57:52.885289 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m11:57:52.888142 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
alter table "retail_dwh"."marts_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m11:57:52.889804 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: COMMIT
[0m11:57:52.890953 [debug] [Thread-1 (]: On model.retail_project.stg_customers: COMMIT
[0m11:57:52.893317 [debug] [Thread-4 (]: Began running node model.retail_project.dim_store
[0m11:57:52.894624 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:57:52.895868 [info ] [Thread-4 (]: 5 of 8 SKIP relation marts_marts.dim_store ..................................... [[33mSKIP[0m]
[0m11:57:52.899956 [debug] [Thread-2 (]: On model.retail_project.stg_products: COMMIT
[0m11:57:52.901243 [debug] [Thread-4 (]: Finished running node model.retail_project.dim_store
[0m11:57:52.902775 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m11:57:52.904618 [debug] [Thread-2 (]: On model.retail_project.stg_products: COMMIT
[0m11:57:52.920297 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:57:52.928240 [debug] [Thread-2 (]: Applying DROP to: "retail_dwh"."marts_staging"."stg_products__dbt_backup"
[0m11:57:52.929524 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:57:52.938506 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m11:57:52.940859 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:57:52.945466 [debug] [Thread-3 (]: Applying DROP to: "retail_dwh"."marts_staging"."stg_sales_transaction__dbt_backup"
[0m11:57:52.946807 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
drop view if exists "retail_dwh"."marts_staging"."stg_products__dbt_backup" cascade
[0m11:57:52.951983 [debug] [Thread-1 (]: Applying DROP to: "retail_dwh"."marts_staging"."stg_customers__dbt_backup"
[0m11:57:52.953573 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m11:57:52.957032 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m11:57:52.958883 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */
drop view if exists "retail_dwh"."marts_staging"."stg_sales_transaction__dbt_backup" cascade
[0m11:57:52.959873 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
drop view if exists "retail_dwh"."marts_staging"."stg_customers__dbt_backup" cascade
[0m11:57:52.968496 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:57:52.972857 [debug] [Thread-2 (]: Timing info for model.retail_project.stg_products (execute): 11:57:52.689397 => 11:57:52.972234
[0m11:57:52.974798 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:57:52.975696 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:57:52.976996 [debug] [Thread-2 (]: On model.retail_project.stg_products: Close
[0m11:57:52.979838 [debug] [Thread-3 (]: Timing info for model.retail_project.stg_sales_transaction (execute): 11:57:52.673051 => 11:57:52.979580
[0m11:57:52.983230 [debug] [Thread-1 (]: Timing info for model.retail_project.stg_customers (execute): 11:57:52.627676 => 11:57:52.982756
[0m11:57:52.985852 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5592f65-1264-4a18-970d-6d7b150cdd08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7990d38920>]}
[0m11:57:52.987269 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: Close
[0m11:57:52.988790 [debug] [Thread-1 (]: On model.retail_project.stg_customers: Close
[0m11:57:52.990067 [info ] [Thread-2 (]: 2 of 8 OK created sql view model marts_staging.stg_products .................... [[32mCREATE VIEW[0m in 0.41s]
[0m11:57:52.992907 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5592f65-1264-4a18-970d-6d7b150cdd08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7991154560>]}
[0m11:57:52.995104 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5592f65-1264-4a18-970d-6d7b150cdd08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79909514f0>]}
[0m11:57:52.997148 [debug] [Thread-2 (]: Finished running node model.retail_project.stg_products
[0m11:57:52.998505 [info ] [Thread-3 (]: 3 of 8 OK created sql view model marts_staging.stg_sales_transaction ........... [[32mCREATE VIEW[0m in 0.42s]
[0m11:57:53.001032 [info ] [Thread-1 (]: 1 of 8 OK created sql view model marts_staging.stg_customers ................... [[32mCREATE VIEW[0m in 0.43s]
[0m11:57:53.003171 [debug] [Thread-3 (]: Finished running node model.retail_project.stg_sales_transaction
[0m11:57:53.004088 [debug] [Thread-1 (]: Finished running node model.retail_project.stg_customers
[0m11:57:53.007148 [debug] [Thread-4 (]: Began running node model.retail_project.dim_product
[0m11:57:53.008835 [info ] [Thread-4 (]: 6 of 8 START sql view model marts_marts.dim_product ............................ [RUN]
[0m11:57:53.010583 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_stores, now model.retail_project.dim_product)
[0m11:57:53.011816 [debug] [Thread-4 (]: Began compiling node model.retail_project.dim_product
[0m11:57:53.015808 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_project.dim_product"
[0m11:57:53.019521 [debug] [Thread-3 (]: Began running node model.retail_project.dim_customer
[0m11:57:53.020604 [info ] [Thread-3 (]: 7 of 8 START sql view model marts_marts.dim_customer ........................... [RUN]
[0m11:57:53.022266 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_sales_transaction, now model.retail_project.dim_customer)
[0m11:57:53.023589 [debug] [Thread-3 (]: Began compiling node model.retail_project.dim_customer
[0m11:57:53.029420 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_project.dim_customer"
[0m11:57:53.032507 [debug] [Thread-4 (]: Timing info for model.retail_project.dim_product (compile): 11:57:53.012399 => 11:57:53.031287
[0m11:57:53.034323 [debug] [Thread-4 (]: Began executing node model.retail_project.dim_product
[0m11:57:53.039649 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_project.dim_product"
[0m11:57:53.041865 [debug] [Thread-3 (]: Timing info for model.retail_project.dim_customer (compile): 11:57:53.024372 => 11:57:53.040582
[0m11:57:53.042694 [debug] [Thread-3 (]: Began executing node model.retail_project.dim_customer
[0m11:57:53.047758 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_project.dim_customer"
[0m11:57:53.051131 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_product"
[0m11:57:53.052598 [debug] [Thread-4 (]: On model.retail_project.dim_product: BEGIN
[0m11:57:53.053330 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:57:53.054338 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_customer"
[0m11:57:53.056031 [debug] [Thread-3 (]: On model.retail_project.dim_customer: BEGIN
[0m11:57:53.057138 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:57:53.068058 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:57:53.068570 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_product"
[0m11:57:53.068951 [debug] [Thread-4 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */

  create view "retail_dwh"."marts_marts"."dim_product__dbt_tmp"
    
    
  as (
    SELECT
    product_id,
    product_name,
    product_category,
    product_sub_category,
    product_price
FROM
    "retail_dwh"."marts_staging"."stg_products"
  );
[0m11:57:53.070870 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:57:53.074510 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_product"
[0m11:57:53.077953 [debug] [Thread-4 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */
alter table "retail_dwh"."marts_marts"."dim_product__dbt_tmp" rename to "dim_product"
[0m11:57:53.079069 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:57:53.080737 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:57:53.083835 [debug] [Thread-4 (]: On model.retail_project.dim_product: COMMIT
[0m11:57:53.085865 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_customer"
[0m11:57:53.087107 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_product"
[0m11:57:53.088054 [debug] [Thread-3 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */

  create view "retail_dwh"."marts_marts"."dim_customer__dbt_tmp"
    
    
  as (
    SELECT
    customer_id,
    customer_name,
    customer_gender,
    customer_city,
    customer_signup_date
FROM
    "retail_dwh"."marts_staging"."stg_customers"
  );
[0m11:57:53.089275 [debug] [Thread-4 (]: On model.retail_project.dim_product: COMMIT
[0m11:57:53.092680 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:57:53.097013 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_customer"
[0m11:57:53.097843 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m11:57:53.099876 [debug] [Thread-3 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */
alter table "retail_dwh"."marts_marts"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m11:57:53.103361 [debug] [Thread-4 (]: Applying DROP to: "retail_dwh"."marts_marts"."dim_product__dbt_backup"
[0m11:57:53.106508 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_product"
[0m11:57:53.107662 [debug] [Thread-4 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */
drop view if exists "retail_dwh"."marts_marts"."dim_product__dbt_backup" cascade
[0m11:57:53.108344 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:57:53.111503 [debug] [Thread-3 (]: On model.retail_project.dim_customer: COMMIT
[0m11:57:53.112305 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_customer"
[0m11:57:53.113746 [debug] [Thread-3 (]: On model.retail_project.dim_customer: COMMIT
[0m11:57:53.115084 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:57:53.118015 [debug] [Thread-4 (]: Timing info for model.retail_project.dim_product (execute): 11:57:53.034933 => 11:57:53.117716
[0m11:57:53.119849 [debug] [Thread-4 (]: On model.retail_project.dim_product: Close
[0m11:57:53.120727 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:57:53.122809 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5592f65-1264-4a18-970d-6d7b150cdd08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7990929070>]}
[0m11:57:53.130275 [debug] [Thread-3 (]: Applying DROP to: "retail_dwh"."marts_marts"."dim_customer__dbt_backup"
[0m11:57:53.134732 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_customer"
[0m11:57:53.135260 [debug] [Thread-3 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */
drop view if exists "retail_dwh"."marts_marts"."dim_customer__dbt_backup" cascade
[0m11:57:53.132427 [info ] [Thread-4 (]: 6 of 8 OK created sql view model marts_marts.dim_product ....................... [[32mCREATE VIEW[0m in 0.11s]
[0m11:57:53.136682 [debug] [Thread-4 (]: Finished running node model.retail_project.dim_product
[0m11:57:53.139526 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:57:53.142714 [debug] [Thread-3 (]: Timing info for model.retail_project.dim_customer (execute): 11:57:53.043076 => 11:57:53.141537
[0m11:57:53.143241 [debug] [Thread-3 (]: On model.retail_project.dim_customer: Close
[0m11:57:53.146367 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5592f65-1264-4a18-970d-6d7b150cdd08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7991947bc0>]}
[0m11:57:53.150006 [info ] [Thread-3 (]: 7 of 8 OK created sql view model marts_marts.dim_customer ...................... [[32mCREATE VIEW[0m in 0.12s]
[0m11:57:53.154277 [debug] [Thread-3 (]: Finished running node model.retail_project.dim_customer
[0m11:57:53.158252 [debug] [Thread-2 (]: Began running node model.retail_project.fact_sales
[0m11:57:53.159103 [info ] [Thread-2 (]: 8 of 8 SKIP relation marts_marts.fact_sales .................................... [[33mSKIP[0m]
[0m11:57:53.161389 [debug] [Thread-2 (]: Finished running node model.retail_project.fact_sales
[0m11:57:53.169318 [debug] [MainThread]: Using postgres connection "master"
[0m11:57:53.169976 [debug] [MainThread]: On master: BEGIN
[0m11:57:53.170496 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:57:53.190018 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:57:53.190649 [debug] [MainThread]: On master: COMMIT
[0m11:57:53.191217 [debug] [MainThread]: Using postgres connection "master"
[0m11:57:53.192697 [debug] [MainThread]: On master: COMMIT
[0m11:57:53.194218 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:57:53.194831 [debug] [MainThread]: On master: Close
[0m11:57:53.196534 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:57:53.197778 [debug] [MainThread]: Connection 'model.retail_project.stg_customers' was properly closed.
[0m11:57:53.198843 [debug] [MainThread]: Connection 'model.retail_project.stg_products' was properly closed.
[0m11:57:53.199838 [debug] [MainThread]: Connection 'model.retail_project.dim_customer' was properly closed.
[0m11:57:53.200823 [debug] [MainThread]: Connection 'model.retail_project.dim_product' was properly closed.
[0m11:57:53.202187 [info ] [MainThread]: 
[0m11:57:53.203258 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m11:57:53.210093 [debug] [MainThread]: Command end result
[0m11:57:53.221909 [info ] [MainThread]: 
[0m11:57:53.222668 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:57:53.223030 [info ] [MainThread]: 
[0m11:57:53.223342 [error] [MainThread]:   Database Error in model stg_stores (models/staging/stg_stores.sql)
  syntax error at or near ";"
  LINE 25: select * from renamed;
                                ^
  compiled Code at target/run/retail_project/models/staging/stg_stores.sql
[0m11:57:53.223742 [info ] [MainThread]: 
[0m11:57:53.224124 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=2 TOTAL=8
[0m11:57:53.226961 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.8062952, "process_user_time": 3.999092, "process_kernel_time": 0.841722, "process_mem_max_rss": "151452", "process_out_blocks": "2592", "command_success": false, "process_in_blocks": "0"}
[0m11:57:53.227535 [debug] [MainThread]: Command `dbt run` failed at 11:57:53.227394 after 1.81 seconds
[0m11:57:53.227930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7992586cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79927afce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f799092aae0>]}
[0m11:57:53.228413 [debug] [MainThread]: Flushing usage events
[0m11:59:41.249185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36811f800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36811d0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36811f320>]}


============================== 11:59:41.252368 | 638fe3ca-3f80-4120-8880-27fc568a6e04 ==============================
[0m11:59:41.252368 [info ] [MainThread]: Running with dbt=1.7.0
[0m11:59:41.253460 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/dbt/retail_project/retail_project/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /root/.dbt', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:59:41.525689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '638fe3ca-3f80-4120-8880-27fc568a6e04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa367fefad0>]}
[0m11:59:41.690090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '638fe3ca-3f80-4120-8880-27fc568a6e04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa367b54e00>]}
[0m11:59:41.691111 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m11:59:41.703152 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m11:59:41.738432 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:59:41.739184 [debug] [MainThread]: Partial parsing: updated file: retail_project://models/staging/stg_stores.sql
[0m11:59:42.016476 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail_project.intermediate
[0m11:59:42.025714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '638fe3ca-3f80-4120-8880-27fc568a6e04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa366ffda90>]}
[0m11:59:42.039786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '638fe3ca-3f80-4120-8880-27fc568a6e04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa367788ec0>]}
[0m11:59:42.040805 [info ] [MainThread]: Found 8 models, 4 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:59:42.042717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '638fe3ca-3f80-4120-8880-27fc568a6e04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa366f41a00>]}
[0m11:59:42.045831 [info ] [MainThread]: 
[0m11:59:42.049558 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:59:42.052677 [debug] [ThreadPool]: Acquiring new postgres connection 'list_retail_dwh'
[0m11:59:42.055318 [debug] [ThreadPool]: Acquiring new postgres connection 'list_retail_dwh'
[0m11:59:42.070000 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh"
[0m11:59:42.073632 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh"
[0m11:59:42.074987 [debug] [ThreadPool]: On list_retail_dwh: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh"} */

    select distinct nspname from pg_namespace
  
[0m11:59:42.076876 [debug] [ThreadPool]: On list_retail_dwh: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh"} */

    select distinct nspname from pg_namespace
  
[0m11:59:42.077804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:59:42.078848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:59:42.096026 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m11:59:42.097773 [debug] [ThreadPool]: On list_retail_dwh: Close
[0m11:59:42.098931 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m11:59:42.103385 [debug] [ThreadPool]: On list_retail_dwh: Close
[0m11:59:42.108436 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_dwh, now list_retail_dwh_marts_staging)
[0m11:59:42.115815 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_dwh, now list_retail_dwh_marts_marts)
[0m11:59:42.122152 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_staging"
[0m11:59:42.184544 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_marts"
[0m11:59:42.190810 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: BEGIN
[0m11:59:42.196877 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: BEGIN
[0m11:59:42.198119 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:59:42.199367 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:59:42.213985 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:59:42.215210 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_staging"
[0m11:59:42.217084 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh_marts_staging"} */
select
      'retail_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'retail_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'retail_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m11:59:42.218859 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:59:42.219421 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_marts"
[0m11:59:42.219999 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh_marts_marts"} */
select
      'retail_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'retail_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'retail_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m11:59:42.222591 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m11:59:42.224754 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: ROLLBACK
[0m11:59:42.225940 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m11:59:42.229072 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: ROLLBACK
[0m11:59:42.232322 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: Close
[0m11:59:42.234447 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: Close
[0m11:59:42.252800 [debug] [MainThread]: Using postgres connection "master"
[0m11:59:42.253241 [debug] [MainThread]: On master: BEGIN
[0m11:59:42.253903 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:59:42.271749 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:59:42.272219 [debug] [MainThread]: Using postgres connection "master"
[0m11:59:42.272611 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:59:42.305060 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m11:59:42.311973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '638fe3ca-3f80-4120-8880-27fc568a6e04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa366fe2fc0>]}
[0m11:59:42.312484 [debug] [MainThread]: On master: ROLLBACK
[0m11:59:42.313695 [debug] [MainThread]: Using postgres connection "master"
[0m11:59:42.314052 [debug] [MainThread]: On master: BEGIN
[0m11:59:42.316213 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:59:42.316881 [debug] [MainThread]: On master: COMMIT
[0m11:59:42.317199 [debug] [MainThread]: Using postgres connection "master"
[0m11:59:42.317552 [debug] [MainThread]: On master: COMMIT
[0m11:59:42.318391 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:59:42.319093 [debug] [MainThread]: On master: Close
[0m11:59:42.320216 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:59:42.321023 [info ] [MainThread]: 
[0m11:59:42.334728 [debug] [Thread-1 (]: Began running node model.retail_project.stg_customers
[0m11:59:42.335878 [info ] [Thread-1 (]: 1 of 8 START sql view model marts_staging.stg_customers ........................ [RUN]
[0m11:59:42.337263 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail_dwh_marts_marts, now model.retail_project.stg_customers)
[0m11:59:42.338258 [debug] [Thread-2 (]: Began running node model.retail_project.stg_products
[0m11:59:42.339299 [debug] [Thread-1 (]: Began compiling node model.retail_project.stg_customers
[0m11:59:42.340758 [debug] [Thread-3 (]: Began running node model.retail_project.stg_sales_transaction
[0m11:59:42.342059 [info ] [Thread-2 (]: 2 of 8 START sql view model marts_staging.stg_products ......................... [RUN]
[0m11:59:42.353731 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_project.stg_customers"
[0m11:59:42.356425 [debug] [Thread-4 (]: Began running node model.retail_project.stg_stores
[0m11:59:42.357693 [info ] [Thread-3 (]: 3 of 8 START sql view model marts_staging.stg_sales_transaction ................ [RUN]
[0m11:59:42.368079 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.retail_project.stg_sales_transaction'
[0m11:59:42.360722 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_retail_dwh_marts_staging, now model.retail_project.stg_products)
[0m11:59:42.364173 [info ] [Thread-4 (]: 4 of 8 START sql view model marts_staging.stg_stores ........................... [RUN]
[0m11:59:42.369017 [debug] [Thread-3 (]: Began compiling node model.retail_project.stg_sales_transaction
[0m11:59:42.370108 [debug] [Thread-2 (]: Began compiling node model.retail_project.stg_products
[0m11:59:42.371187 [debug] [Thread-1 (]: Timing info for model.retail_project.stg_customers (compile): 11:59:42.344142 => 11:59:42.370920
[0m11:59:42.372517 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.retail_project.stg_stores'
[0m11:59:42.378218 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_project.stg_sales_transaction"
[0m11:59:42.383924 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_project.stg_products"
[0m11:59:42.385737 [debug] [Thread-1 (]: Began executing node model.retail_project.stg_customers
[0m11:59:42.389146 [debug] [Thread-4 (]: Began compiling node model.retail_project.stg_stores
[0m11:59:42.392768 [debug] [Thread-3 (]: Timing info for model.retail_project.stg_sales_transaction (compile): 11:59:42.373687 => 11:59:42.392170
[0m11:59:42.394428 [debug] [Thread-2 (]: Timing info for model.retail_project.stg_products (compile): 11:59:42.379214 => 11:59:42.393969
[0m11:59:42.404779 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_project.stg_stores"
[0m11:59:42.417273 [debug] [Thread-3 (]: Began executing node model.retail_project.stg_sales_transaction
[0m11:59:42.435030 [debug] [Thread-2 (]: Began executing node model.retail_project.stg_products
[0m11:59:42.462857 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_project.stg_customers"
[0m11:59:42.478727 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_project.stg_products"
[0m11:59:42.481224 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_project.stg_sales_transaction"
[0m11:59:42.482056 [debug] [Thread-4 (]: Timing info for model.retail_project.stg_stores (compile): 11:59:42.401791 => 11:59:42.481800
[0m11:59:42.484839 [debug] [Thread-4 (]: Began executing node model.retail_project.stg_stores
[0m11:59:42.492677 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_project.stg_stores"
[0m11:59:42.494903 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m11:59:42.495805 [debug] [Thread-2 (]: On model.retail_project.stg_products: BEGIN
[0m11:59:42.496353 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:59:42.498319 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m11:59:42.500895 [debug] [Thread-1 (]: On model.retail_project.stg_customers: BEGIN
[0m11:59:42.501823 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:59:42.503786 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m11:59:42.504821 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: BEGIN
[0m11:59:42.505633 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:59:42.508370 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m11:59:42.510295 [debug] [Thread-4 (]: On model.retail_project.stg_stores: BEGIN
[0m11:59:42.511088 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:59:42.517089 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:59:42.517874 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m11:59:42.518619 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */

  create view "retail_dwh"."marts_staging"."stg_products__dbt_tmp"
    
    
  as (
    SELECT
    product_id,
    product_name,
    TRIM(category) AS product_category,
    TRIM(sub_category) AS product_sub_category,
    CAST(price AS NUMERIC) AS product_price
FROM
    "retail_dwh"."raw"."products_raw"
  );
[0m11:59:42.521996 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:59:42.537524 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m11:59:42.539710 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:59:42.540890 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
alter table "retail_dwh"."marts_staging"."stg_products" rename to "stg_products__dbt_backup"
[0m11:59:42.542934 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m11:59:42.544682 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:59:42.550271 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m11:59:42.547932 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */

  create view "retail_dwh"."marts_staging"."stg_customers__dbt_tmp"
    
    
  as (
    SELECT
    customer_id,
    customer_name,
    UPPER(TRIM(gender)) AS customer_gender,
    TRIM(city) AS customer_city,
    CAST(signup_date AS DATE) AS customer_signup_date
FROM
    "retail_dwh"."raw"."customers_raw"
  );
[0m11:59:42.549304 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:59:42.545871 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:59:42.551085 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */

  create view "retail_dwh"."marts_staging"."stg_sales_transaction__dbt_tmp"
    
    
  as (
    SELECT
    transaction_id,
    CAST(transaction_date AS DATE) AS transaction_date,
    customer_id,
    product_id,
    store_id,
    CAST(quantity AS INTEGER) AS quantity,
    CAST(total_price AS NUMERIC) AS total_price
FROM
    "retail_dwh"."raw"."sales_transaction_raw"
  );
[0m11:59:42.557328 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m11:59:42.561967 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
alter table "retail_dwh"."marts_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m11:59:42.560259 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:59:42.558943 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m11:59:42.567259 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m11:59:42.569391 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */

  create view "retail_dwh"."marts_staging"."stg_stores__dbt_tmp"
    
    
  as (
    with source as (
    select
        store_id,
        store_name,
        city,
        region
    from "retail_dwh"."raw"."stores_raw"
),

renamed as (
    select
        store_id,
        store_name,
        city,
        region as store_region
    from source
)

select * from renamed
  );
[0m11:59:42.570057 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:59:42.571605 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
alter table "retail_dwh"."marts_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m11:59:42.577686 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m11:59:42.579077 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:59:42.579986 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:59:42.581950 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */
alter table "retail_dwh"."marts_staging"."stg_sales_transaction" rename to "stg_sales_transaction__dbt_backup"
[0m11:59:42.597904 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:59:42.608403 [debug] [Thread-2 (]: On model.retail_project.stg_products: COMMIT
[0m11:59:42.613329 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m11:59:42.620292 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m11:59:42.621158 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m11:59:42.622634 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
alter table "retail_dwh"."marts_staging"."stg_stores__dbt_tmp" rename to "stg_stores"
[0m11:59:42.623960 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
alter table "retail_dwh"."marts_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m11:59:42.625042 [debug] [Thread-2 (]: On model.retail_project.stg_products: COMMIT
[0m11:59:42.626496 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:59:42.634194 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m11:59:42.636311 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */
alter table "retail_dwh"."marts_staging"."stg_sales_transaction__dbt_tmp" rename to "stg_sales_transaction"
[0m11:59:42.638655 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:59:42.649739 [debug] [Thread-2 (]: Applying DROP to: "retail_dwh"."marts_staging"."stg_products__dbt_backup"
[0m11:59:42.662670 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:59:42.665000 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:59:42.668138 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m11:59:42.672340 [debug] [Thread-4 (]: On model.retail_project.stg_stores: COMMIT
[0m11:59:42.674271 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:59:42.683053 [debug] [Thread-1 (]: On model.retail_project.stg_customers: COMMIT
[0m11:59:42.684922 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
drop view if exists "retail_dwh"."marts_staging"."stg_products__dbt_backup" cascade
[0m11:59:42.686749 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m11:59:42.690662 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: COMMIT
[0m11:59:42.694008 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m11:59:42.697961 [debug] [Thread-4 (]: On model.retail_project.stg_stores: COMMIT
[0m11:59:42.699984 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m11:59:42.701336 [debug] [Thread-1 (]: On model.retail_project.stg_customers: COMMIT
[0m11:59:42.702804 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:59:42.704422 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: COMMIT
[0m11:59:42.710222 [debug] [Thread-2 (]: Timing info for model.retail_project.stg_products (execute): 11:59:42.472874 => 11:59:42.708462
[0m11:59:42.712323 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m11:59:42.714566 [debug] [Thread-2 (]: On model.retail_project.stg_products: Close
[0m11:59:42.722773 [debug] [Thread-4 (]: Applying DROP to: "retail_dwh"."marts_staging"."stg_stores__dbt_backup"
[0m11:59:42.723685 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:59:42.728961 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:59:42.734049 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m11:59:42.746180 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '638fe3ca-3f80-4120-8880-27fc568a6e04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa366bee120>]}
[0m11:59:42.754546 [debug] [Thread-3 (]: Applying DROP to: "retail_dwh"."marts_staging"."stg_sales_transaction__dbt_backup"
[0m11:59:42.765820 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m11:59:42.759989 [debug] [Thread-1 (]: Applying DROP to: "retail_dwh"."marts_staging"."stg_customers__dbt_backup"
[0m11:59:42.761463 [info ] [Thread-2 (]: 2 of 8 OK created sql view model marts_staging.stg_products .................... [[32mCREATE VIEW[0m in 0.39s]
[0m11:59:42.756841 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
drop view if exists "retail_dwh"."marts_staging"."stg_stores__dbt_backup" cascade
[0m11:59:42.767734 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */
drop view if exists "retail_dwh"."marts_staging"."stg_sales_transaction__dbt_backup" cascade
[0m11:59:42.770500 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m11:59:42.772778 [debug] [Thread-2 (]: Finished running node model.retail_project.stg_products
[0m11:59:42.775968 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
drop view if exists "retail_dwh"."marts_staging"."stg_customers__dbt_backup" cascade
[0m11:59:42.781818 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:59:42.783316 [debug] [Thread-2 (]: Began running node model.retail_project.dim_product
[0m11:59:42.784469 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:59:42.789870 [debug] [Thread-4 (]: Timing info for model.retail_project.stg_stores (execute): 11:59:42.485828 => 11:59:42.789574
[0m11:59:42.791824 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:59:42.794024 [info ] [Thread-2 (]: 5 of 8 START sql view model marts_marts.dim_product ............................ [RUN]
[0m11:59:42.798469 [debug] [Thread-3 (]: Timing info for model.retail_project.stg_sales_transaction (execute): 11:59:42.466635 => 11:59:42.798169
[0m11:59:42.799465 [debug] [Thread-4 (]: On model.retail_project.stg_stores: Close
[0m11:59:42.807448 [debug] [Thread-1 (]: Timing info for model.retail_project.stg_customers (execute): 11:59:42.395088 => 11:59:42.806418
[0m11:59:42.812128 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_products, now model.retail_project.dim_product)
[0m11:59:42.813882 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: Close
[0m11:59:42.815577 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '638fe3ca-3f80-4120-8880-27fc568a6e04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa366bd3860>]}
[0m11:59:42.817667 [debug] [Thread-1 (]: On model.retail_project.stg_customers: Close
[0m11:59:42.818707 [debug] [Thread-2 (]: Began compiling node model.retail_project.dim_product
[0m11:59:42.820519 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '638fe3ca-3f80-4120-8880-27fc568a6e04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa366bd3140>]}
[0m11:59:42.831818 [info ] [Thread-3 (]: 3 of 8 OK created sql view model marts_staging.stg_sales_transaction ........... [[32mCREATE VIEW[0m in 0.45s]
[0m11:59:42.828203 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_project.dim_product"
[0m11:59:42.830953 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '638fe3ca-3f80-4120-8880-27fc568a6e04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa366bcbe90>]}
[0m11:59:42.823009 [info ] [Thread-4 (]: 4 of 8 OK created sql view model marts_staging.stg_stores ...................... [[32mCREATE VIEW[0m in 0.44s]
[0m11:59:42.833182 [debug] [Thread-3 (]: Finished running node model.retail_project.stg_sales_transaction
[0m11:59:42.836338 [info ] [Thread-1 (]: 1 of 8 OK created sql view model marts_staging.stg_customers ................... [[32mCREATE VIEW[0m in 0.49s]
[0m11:59:42.839989 [debug] [Thread-2 (]: Timing info for model.retail_project.dim_product (compile): 11:59:42.824094 => 11:59:42.839569
[0m11:59:42.843431 [debug] [Thread-2 (]: Began executing node model.retail_project.dim_product
[0m11:59:42.842002 [debug] [Thread-1 (]: Finished running node model.retail_project.stg_customers
[0m11:59:42.838441 [debug] [Thread-4 (]: Finished running node model.retail_project.stg_stores
[0m11:59:42.850097 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_project.dim_product"
[0m11:59:42.854842 [debug] [Thread-3 (]: Began running node model.retail_project.dim_customer
[0m11:59:42.856910 [debug] [Thread-1 (]: Began running node model.retail_project.dim_store
[0m11:59:42.860218 [info ] [Thread-3 (]: 6 of 8 START sql view model marts_marts.dim_customer ........................... [RUN]
[0m11:59:42.863557 [info ] [Thread-1 (]: 7 of 8 START sql view model marts_marts.dim_store .............................. [RUN]
[0m11:59:42.865928 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_sales_transaction, now model.retail_project.dim_customer)
[0m11:59:42.868196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_customers, now model.retail_project.dim_store)
[0m11:59:42.869099 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_product"
[0m11:59:42.869879 [debug] [Thread-3 (]: Began compiling node model.retail_project.dim_customer
[0m11:59:42.870925 [debug] [Thread-1 (]: Began compiling node model.retail_project.dim_store
[0m11:59:42.871991 [debug] [Thread-2 (]: On model.retail_project.dim_product: BEGIN
[0m11:59:42.877144 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_project.dim_customer"
[0m11:59:42.882625 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_project.dim_store"
[0m11:59:42.884888 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:59:42.888351 [debug] [Thread-1 (]: Timing info for model.retail_project.dim_store (compile): 11:59:42.878667 => 11:59:42.887964
[0m11:59:42.891214 [debug] [Thread-3 (]: Timing info for model.retail_project.dim_customer (compile): 11:59:42.872585 => 11:59:42.890357
[0m11:59:42.894329 [debug] [Thread-1 (]: Began executing node model.retail_project.dim_store
[0m11:59:42.896254 [debug] [Thread-3 (]: Began executing node model.retail_project.dim_customer
[0m11:59:42.904004 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_project.dim_store"
[0m11:59:42.912450 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_project.dim_customer"
[0m11:59:42.916843 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_store"
[0m11:59:42.918182 [debug] [Thread-1 (]: On model.retail_project.dim_store: BEGIN
[0m11:59:42.918910 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:59:42.920175 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:59:42.921184 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_product"
[0m11:59:42.922082 [debug] [Thread-2 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */

  create view "retail_dwh"."marts_marts"."dim_product__dbt_tmp"
    
    
  as (
    SELECT
    product_id,
    product_name,
    product_category,
    product_sub_category,
    product_price
FROM
    "retail_dwh"."marts_staging"."stg_products"
  );
[0m11:59:42.923303 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_customer"
[0m11:59:42.926959 [debug] [Thread-3 (]: On model.retail_project.dim_customer: BEGIN
[0m11:59:42.928321 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:59:42.929928 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:59:42.937420 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_product"
[0m11:59:42.938199 [debug] [Thread-2 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */
alter table "retail_dwh"."marts_marts"."dim_product__dbt_tmp" rename to "dim_product"
[0m11:59:42.941267 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:59:42.943601 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:59:42.945937 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_store"
[0m11:59:42.947099 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:59:42.950098 [debug] [Thread-2 (]: On model.retail_project.dim_product: COMMIT
[0m11:59:42.951976 [debug] [Thread-1 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */

  create view "retail_dwh"."marts_marts"."dim_store__dbt_tmp"
    
    
  as (
    SELECT
    store_id,
    store_name,
    store_address,
    store_city,
    store_open_date
FROM
    "retail_dwh"."marts_staging"."stg_stores"
  );
[0m11:59:42.953041 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_customer"
[0m11:59:42.954042 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_product"
[0m11:59:42.955555 [debug] [Thread-3 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */

  create view "retail_dwh"."marts_marts"."dim_customer__dbt_tmp"
    
    
  as (
    SELECT
    customer_id,
    customer_name,
    customer_gender,
    customer_city,
    customer_signup_date
FROM
    "retail_dwh"."marts_staging"."stg_customers"
  );
[0m11:59:42.957041 [debug] [Thread-2 (]: On model.retail_project.dim_product: COMMIT
[0m11:59:42.958221 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "store_address" does not exist
LINE 10:     store_address,
             ^

[0m11:59:42.961406 [debug] [Thread-1 (]: On model.retail_project.dim_store: ROLLBACK
[0m11:59:42.964790 [debug] [Thread-1 (]: Timing info for model.retail_project.dim_store (execute): 11:59:42.897086 => 11:59:42.963404
[0m11:59:42.966134 [debug] [Thread-1 (]: On model.retail_project.dim_store: Close
[0m11:59:42.967798 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:59:42.976901 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:59:42.982991 [debug] [Thread-2 (]: Applying DROP to: "retail_dwh"."marts_marts"."dim_product__dbt_backup"
[0m11:59:42.994328 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_customer"
[0m11:59:42.996567 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_product"
[0m11:59:43.000879 [debug] [Thread-3 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */
alter table "retail_dwh"."marts_marts"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m11:59:43.003060 [debug] [Thread-2 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */
drop view if exists "retail_dwh"."marts_marts"."dim_product__dbt_backup" cascade
[0m11:59:43.005372 [debug] [Thread-1 (]: Database Error in model dim_store (models/marts/dimensions/dim_store.sql)
  column "store_address" does not exist
  LINE 10:     store_address,
               ^
  compiled Code at target/run/retail_project/models/marts/dimensions/dim_store.sql
[0m11:59:43.008806 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '638fe3ca-3f80-4120-8880-27fc568a6e04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa366fce510>]}
[0m11:59:43.011341 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:59:43.014782 [debug] [Thread-2 (]: Timing info for model.retail_project.dim_product (execute): 11:59:42.844352 => 11:59:43.014266
[0m11:59:43.015628 [debug] [Thread-2 (]: On model.retail_project.dim_product: Close
[0m11:59:43.010341 [error] [Thread-1 (]: 7 of 8 ERROR creating sql view model marts_marts.dim_store ..................... [[31mERROR[0m in 0.14s]
[0m11:59:43.016820 [debug] [Thread-1 (]: Finished running node model.retail_project.dim_store
[0m11:59:43.019781 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:59:43.023054 [debug] [Thread-3 (]: On model.retail_project.dim_customer: COMMIT
[0m11:59:43.023958 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_customer"
[0m11:59:43.025819 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '638fe3ca-3f80-4120-8880-27fc568a6e04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa366bd6000>]}
[0m11:59:43.027125 [debug] [Thread-3 (]: On model.retail_project.dim_customer: COMMIT
[0m11:59:43.028954 [info ] [Thread-2 (]: 5 of 8 OK created sql view model marts_marts.dim_product ....................... [[32mCREATE VIEW[0m in 0.21s]
[0m11:59:43.031739 [debug] [Thread-2 (]: Finished running node model.retail_project.dim_product
[0m11:59:43.035086 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:59:43.039931 [debug] [Thread-3 (]: Applying DROP to: "retail_dwh"."marts_marts"."dim_customer__dbt_backup"
[0m11:59:43.042516 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_customer"
[0m11:59:43.043183 [debug] [Thread-3 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */
drop view if exists "retail_dwh"."marts_marts"."dim_customer__dbt_backup" cascade
[0m11:59:43.044952 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:59:43.047703 [debug] [Thread-3 (]: Timing info for model.retail_project.dim_customer (execute): 11:59:42.905924 => 11:59:43.046969
[0m11:59:43.048171 [debug] [Thread-3 (]: On model.retail_project.dim_customer: Close
[0m11:59:43.049317 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '638fe3ca-3f80-4120-8880-27fc568a6e04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3677ddbb0>]}
[0m11:59:43.049969 [info ] [Thread-3 (]: 6 of 8 OK created sql view model marts_marts.dim_customer ...................... [[32mCREATE VIEW[0m in 0.18s]
[0m11:59:43.051704 [debug] [Thread-3 (]: Finished running node model.retail_project.dim_customer
[0m11:59:43.053029 [debug] [Thread-4 (]: Began running node model.retail_project.fact_sales
[0m11:59:43.056744 [info ] [Thread-4 (]: 8 of 8 SKIP relation marts_marts.fact_sales .................................... [[33mSKIP[0m]
[0m11:59:43.057966 [debug] [Thread-4 (]: Finished running node model.retail_project.fact_sales
[0m11:59:43.064925 [debug] [MainThread]: Using postgres connection "master"
[0m11:59:43.065386 [debug] [MainThread]: On master: BEGIN
[0m11:59:43.065679 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:59:43.079346 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:59:43.080436 [debug] [MainThread]: On master: COMMIT
[0m11:59:43.080901 [debug] [MainThread]: Using postgres connection "master"
[0m11:59:43.082040 [debug] [MainThread]: On master: COMMIT
[0m11:59:43.084139 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:59:43.085325 [debug] [MainThread]: On master: Close
[0m11:59:43.087333 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:59:43.088081 [debug] [MainThread]: Connection 'model.retail_project.dim_store' was properly closed.
[0m11:59:43.088625 [debug] [MainThread]: Connection 'model.retail_project.dim_product' was properly closed.
[0m11:59:43.089162 [debug] [MainThread]: Connection 'model.retail_project.dim_customer' was properly closed.
[0m11:59:43.091825 [debug] [MainThread]: Connection 'model.retail_project.stg_stores' was properly closed.
[0m11:59:43.092982 [info ] [MainThread]: 
[0m11:59:43.094146 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 1.04 seconds (1.04s).
[0m11:59:43.097007 [debug] [MainThread]: Command end result
[0m11:59:43.114827 [info ] [MainThread]: 
[0m11:59:43.116113 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:59:43.117364 [info ] [MainThread]: 
[0m11:59:43.119143 [error] [MainThread]:   Database Error in model dim_store (models/marts/dimensions/dim_store.sql)
  column "store_address" does not exist
  LINE 10:     store_address,
               ^
  compiled Code at target/run/retail_project/models/marts/dimensions/dim_store.sql
[0m11:59:43.120982 [info ] [MainThread]: 
[0m11:59:43.121774 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=1 TOTAL=8
[0m11:59:43.123279 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.9565811, "process_user_time": 4.398595, "process_kernel_time": 0.976731, "process_mem_max_rss": "151448", "process_out_blocks": "2608", "command_success": false, "process_in_blocks": "0"}
[0m11:59:43.123857 [debug] [MainThread]: Command `dbt run` failed at 11:59:43.123703 after 1.96 seconds
[0m11:59:43.124407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa368a1de80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa368012e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa366f16ea0>]}
[0m11:59:43.124930 [debug] [MainThread]: Flushing usage events
[0m12:02:30.715896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbbbff9df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbbc074440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbbbff9d00>]}


============================== 12:02:30.724348 | b3f51ce7-8f7d-414f-bc1f-911e15c7eda6 ==============================
[0m12:02:30.724348 [info ] [MainThread]: Running with dbt=1.7.0
[0m12:02:30.725864 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/dbt/retail_project/retail_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /root/.dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:02:30.981619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3f51ce7-8f7d-414f-bc1f-911e15c7eda6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbbc107380>]}
[0m12:02:31.134139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3f51ce7-8f7d-414f-bc1f-911e15c7eda6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbbd99c770>]}
[0m12:02:31.135466 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m12:02:31.155999 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m12:02:31.197818 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:02:31.198803 [debug] [MainThread]: Partial parsing: updated file: retail_project://models/marts/dimensions/dim_store.sql
[0m12:02:31.424622 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail_project.intermediate
[0m12:02:31.431720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3f51ce7-8f7d-414f-bc1f-911e15c7eda6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbbabfde80>]}
[0m12:02:31.449498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3f51ce7-8f7d-414f-bc1f-911e15c7eda6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbbb3852e0>]}
[0m12:02:31.450120 [info ] [MainThread]: Found 8 models, 4 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:02:31.451746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3f51ce7-8f7d-414f-bc1f-911e15c7eda6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbbb7569f0>]}
[0m12:02:31.454746 [info ] [MainThread]: 
[0m12:02:31.458140 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:02:31.461193 [debug] [ThreadPool]: Acquiring new postgres connection 'list_retail_dwh'
[0m12:02:31.472581 [debug] [ThreadPool]: Acquiring new postgres connection 'list_retail_dwh'
[0m12:02:31.490216 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh"
[0m12:02:31.491088 [debug] [ThreadPool]: On list_retail_dwh: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh"} */

    select distinct nspname from pg_namespace
  
[0m12:02:31.491984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:02:31.503970 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh"
[0m12:02:31.504860 [debug] [ThreadPool]: On list_retail_dwh: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh"} */

    select distinct nspname from pg_namespace
  
[0m12:02:31.505625 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:02:31.512418 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m12:02:31.514728 [debug] [ThreadPool]: On list_retail_dwh: Close
[0m12:02:31.524116 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m12:02:31.527207 [debug] [ThreadPool]: On list_retail_dwh: Close
[0m12:02:31.533703 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_dwh, now list_retail_dwh_marts_marts)
[0m12:02:31.536530 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_dwh, now list_retail_dwh_marts_staging)
[0m12:02:31.546036 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_marts"
[0m12:02:31.631884 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: BEGIN
[0m12:02:31.633030 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:02:31.638971 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_staging"
[0m12:02:31.639634 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: BEGIN
[0m12:02:31.640091 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:02:31.647937 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:02:31.649241 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_marts"
[0m12:02:31.649752 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh_marts_marts"} */
select
      'retail_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'retail_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'retail_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m12:02:31.657702 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m12:02:31.660368 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: ROLLBACK
[0m12:02:31.661869 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:02:31.663424 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_staging"
[0m12:02:31.664302 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh_marts_staging"} */
select
      'retail_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'retail_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'retail_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m12:02:31.665205 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: Close
[0m12:02:31.671606 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:02:31.673802 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: ROLLBACK
[0m12:02:31.675602 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: Close
[0m12:02:31.685295 [debug] [MainThread]: Using postgres connection "master"
[0m12:02:31.686976 [debug] [MainThread]: On master: BEGIN
[0m12:02:31.688756 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:02:31.703392 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:02:31.704230 [debug] [MainThread]: Using postgres connection "master"
[0m12:02:31.705085 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:02:31.739667 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m12:02:31.743983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3f51ce7-8f7d-414f-bc1f-911e15c7eda6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbbabfd790>]}
[0m12:02:31.744673 [debug] [MainThread]: On master: ROLLBACK
[0m12:02:31.745997 [debug] [MainThread]: Using postgres connection "master"
[0m12:02:31.746360 [debug] [MainThread]: On master: BEGIN
[0m12:02:31.748735 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:02:31.749212 [debug] [MainThread]: On master: COMMIT
[0m12:02:31.749550 [debug] [MainThread]: Using postgres connection "master"
[0m12:02:31.749831 [debug] [MainThread]: On master: COMMIT
[0m12:02:31.750950 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:02:31.751574 [debug] [MainThread]: On master: Close
[0m12:02:31.753493 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:02:31.754768 [info ] [MainThread]: 
[0m12:02:31.768843 [debug] [Thread-1 (]: Began running node model.retail_project.stg_customers
[0m12:02:31.771154 [debug] [Thread-2 (]: Began running node model.retail_project.stg_products
[0m12:02:31.772304 [info ] [Thread-1 (]: 1 of 8 START sql view model marts_staging.stg_customers ........................ [RUN]
[0m12:02:31.774155 [info ] [Thread-2 (]: 2 of 8 START sql view model marts_staging.stg_products ......................... [RUN]
[0m12:02:31.776050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail_dwh_marts_staging, now model.retail_project.stg_customers)
[0m12:02:31.777265 [debug] [Thread-3 (]: Began running node model.retail_project.stg_sales_transaction
[0m12:02:31.778499 [debug] [Thread-4 (]: Began running node model.retail_project.stg_stores
[0m12:02:31.780000 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_retail_dwh_marts_marts, now model.retail_project.stg_products)
[0m12:02:31.781916 [debug] [Thread-1 (]: Began compiling node model.retail_project.stg_customers
[0m12:02:31.783117 [info ] [Thread-3 (]: 3 of 8 START sql view model marts_staging.stg_sales_transaction ................ [RUN]
[0m12:02:31.785060 [info ] [Thread-4 (]: 4 of 8 START sql view model marts_staging.stg_stores ........................... [RUN]
[0m12:02:31.801307 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.retail_project.stg_stores'
[0m12:02:31.797173 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_project.stg_customers"
[0m12:02:31.799543 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.retail_project.stg_sales_transaction'
[0m12:02:31.787217 [debug] [Thread-2 (]: Began compiling node model.retail_project.stg_products
[0m12:02:31.802164 [debug] [Thread-4 (]: Began compiling node model.retail_project.stg_stores
[0m12:02:31.804058 [debug] [Thread-3 (]: Began compiling node model.retail_project.stg_sales_transaction
[0m12:02:31.805393 [debug] [Thread-1 (]: Timing info for model.retail_project.stg_customers (compile): 12:02:31.787959 => 12:02:31.804947
[0m12:02:31.809122 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_project.stg_products"
[0m12:02:31.813538 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_project.stg_stores"
[0m12:02:31.818402 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_project.stg_sales_transaction"
[0m12:02:31.820316 [debug] [Thread-1 (]: Began executing node model.retail_project.stg_customers
[0m12:02:31.825373 [debug] [Thread-3 (]: Timing info for model.retail_project.stg_sales_transaction (compile): 12:02:31.815119 => 12:02:31.824891
[0m12:02:31.845162 [debug] [Thread-2 (]: Timing info for model.retail_project.stg_products (compile): 12:02:31.806143 => 12:02:31.844493
[0m12:02:31.846740 [debug] [Thread-3 (]: Began executing node model.retail_project.stg_sales_transaction
[0m12:02:31.884589 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_project.stg_customers"
[0m12:02:31.888843 [debug] [Thread-4 (]: Timing info for model.retail_project.stg_stores (compile): 12:02:31.810699 => 12:02:31.886436
[0m12:02:31.890199 [debug] [Thread-2 (]: Began executing node model.retail_project.stg_products
[0m12:02:31.896137 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_project.stg_sales_transaction"
[0m12:02:31.898817 [debug] [Thread-4 (]: Began executing node model.retail_project.stg_stores
[0m12:02:31.907315 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_project.stg_products"
[0m12:02:31.908351 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:02:31.915480 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_project.stg_stores"
[0m12:02:31.918527 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m12:02:31.923915 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: BEGIN
[0m12:02:31.920628 [debug] [Thread-1 (]: On model.retail_project.stg_customers: BEGIN
[0m12:02:31.928016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:31.925083 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:02:31.926517 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:02:31.921462 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:02:31.932179 [debug] [Thread-2 (]: On model.retail_project.stg_products: BEGIN
[0m12:02:31.929936 [debug] [Thread-4 (]: On model.retail_project.stg_stores: BEGIN
[0m12:02:31.934415 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:02:31.933131 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:02:31.948243 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:02:31.948747 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m12:02:31.949197 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */

  create view "retail_dwh"."marts_staging"."stg_sales_transaction__dbt_tmp"
    
    
  as (
    SELECT
    transaction_id,
    CAST(transaction_date AS DATE) AS transaction_date,
    customer_id,
    product_id,
    store_id,
    CAST(quantity AS INTEGER) AS quantity,
    CAST(total_price AS NUMERIC) AS total_price
FROM
    "retail_dwh"."raw"."sales_transaction_raw"
  );
[0m12:02:31.952561 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:02:31.958516 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:02:31.960628 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:02:31.961834 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:02:31.964100 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:02:31.963007 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */

  create view "retail_dwh"."marts_staging"."stg_products__dbt_tmp"
    
    
  as (
    SELECT
    product_id,
    product_name,
    TRIM(category) AS product_category,
    TRIM(sub_category) AS product_sub_category,
    CAST(price AS NUMERIC) AS product_price
FROM
    "retail_dwh"."raw"."products_raw"
  );
[0m12:02:31.974423 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m12:02:31.980083 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */
alter table "retail_dwh"."marts_staging"."stg_sales_transaction" rename to "stg_sales_transaction__dbt_backup"
[0m12:02:31.976756 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */

  create view "retail_dwh"."marts_staging"."stg_customers__dbt_tmp"
    
    
  as (
    SELECT
    customer_id,
    customer_name,
    UPPER(TRIM(gender)) AS customer_gender,
    TRIM(city) AS customer_city,
    CAST(signup_date AS DATE) AS customer_signup_date
FROM
    "retail_dwh"."raw"."customers_raw"
  );
[0m12:02:31.978942 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:02:31.982181 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:02:31.982616 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */

  create view "retail_dwh"."marts_staging"."stg_stores__dbt_tmp"
    
    
  as (
    with source as (
    select
        store_id,
        store_name,
        city,
        region
    from "retail_dwh"."raw"."stores_raw"
),

renamed as (
    select
        store_id,
        store_name,
        city,
        region as store_region
    from source
)

select * from renamed
  );
[0m12:02:31.984553 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:02:31.992930 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:02:31.995097 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:02:31.996244 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:02:31.997203 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:02:32.002533 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:02:32.004374 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
alter table "retail_dwh"."marts_staging"."stg_products" rename to "stg_products__dbt_backup"
[0m12:02:32.009073 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m12:02:32.014988 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:02:32.016287 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
alter table "retail_dwh"."marts_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m12:02:32.017918 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */
alter table "retail_dwh"."marts_staging"."stg_sales_transaction__dbt_tmp" rename to "stg_sales_transaction"
[0m12:02:32.020468 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
alter table "retail_dwh"."marts_staging"."stg_stores" rename to "stg_stores__dbt_backup"
[0m12:02:32.021429 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:02:32.027406 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:02:32.028900 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:02:32.030543 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
alter table "retail_dwh"."marts_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m12:02:32.031814 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:02:32.032844 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:02:32.054835 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:02:32.069328 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:02:32.071101 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: COMMIT
[0m12:02:32.075017 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:02:32.076513 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
alter table "retail_dwh"."marts_staging"."stg_stores__dbt_tmp" rename to "stg_stores"
[0m12:02:32.079874 [debug] [Thread-2 (]: On model.retail_project.stg_products: COMMIT
[0m12:02:32.081122 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m12:02:32.082786 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
alter table "retail_dwh"."marts_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m12:02:32.084607 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:02:32.085609 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:02:32.087235 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: COMMIT
[0m12:02:32.088952 [debug] [Thread-2 (]: On model.retail_project.stg_products: COMMIT
[0m12:02:32.092446 [debug] [Thread-4 (]: On model.retail_project.stg_stores: COMMIT
[0m12:02:32.093955 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:02:32.097202 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:02:32.100716 [debug] [Thread-1 (]: On model.retail_project.stg_customers: COMMIT
[0m12:02:32.103311 [debug] [Thread-4 (]: On model.retail_project.stg_stores: COMMIT
[0m12:02:32.104998 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:02:32.106390 [debug] [Thread-1 (]: On model.retail_project.stg_customers: COMMIT
[0m12:02:32.108001 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m12:02:32.119075 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:02:32.123250 [debug] [Thread-3 (]: Applying DROP to: "retail_dwh"."marts_staging"."stg_sales_transaction__dbt_backup"
[0m12:02:32.124899 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m12:02:32.125831 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:02:32.132237 [debug] [Thread-2 (]: Applying DROP to: "retail_dwh"."marts_staging"."stg_products__dbt_backup"
[0m12:02:32.142980 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m12:02:32.149170 [debug] [Thread-4 (]: Applying DROP to: "retail_dwh"."marts_staging"."stg_stores__dbt_backup"
[0m12:02:32.155796 [debug] [Thread-1 (]: Applying DROP to: "retail_dwh"."marts_staging"."stg_customers__dbt_backup"
[0m12:02:32.158134 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:02:32.159109 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */
drop view if exists "retail_dwh"."marts_staging"."stg_sales_transaction__dbt_backup" cascade
[0m12:02:32.161402 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:02:32.163209 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:02:32.164317 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
drop view if exists "retail_dwh"."marts_staging"."stg_products__dbt_backup" cascade
[0m12:02:32.165921 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
drop view if exists "retail_dwh"."marts_staging"."stg_stores__dbt_backup" cascade
[0m12:02:32.167236 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
drop view if exists "retail_dwh"."marts_staging"."stg_customers__dbt_backup" cascade
[0m12:02:32.171368 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:02:32.179352 [debug] [Thread-3 (]: Timing info for model.retail_project.stg_sales_transaction (execute): 12:02:31.891255 => 12:02:32.179032
[0m12:02:32.180942 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: Close
[0m12:02:32.183115 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3f51ce7-8f7d-414f-bc1f-911e15c7eda6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbba7fdac0>]}
[0m12:02:32.184795 [info ] [Thread-3 (]: 3 of 8 OK created sql view model marts_staging.stg_sales_transaction ........... [[32mCREATE VIEW[0m in 0.38s]
[0m12:02:32.188042 [debug] [Thread-3 (]: Finished running node model.retail_project.stg_sales_transaction
[0m12:02:32.189178 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:02:32.191876 [debug] [Thread-2 (]: Timing info for model.retail_project.stg_products (execute): 12:02:31.899966 => 12:02:32.191624
[0m12:02:32.192925 [debug] [Thread-2 (]: On model.retail_project.stg_products: Close
[0m12:02:32.193865 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:02:32.196571 [debug] [Thread-1 (]: Timing info for model.retail_project.stg_customers (execute): 12:02:31.825953 => 12:02:32.196294
[0m12:02:32.199114 [debug] [Thread-1 (]: On model.retail_project.stg_customers: Close
[0m12:02:32.200933 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3f51ce7-8f7d-414f-bc1f-911e15c7eda6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbba7a0650>]}
[0m12:02:32.204893 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:02:32.208302 [debug] [Thread-4 (]: Timing info for model.retail_project.stg_stores (execute): 12:02:31.910722 => 12:02:32.208006
[0m12:02:32.208912 [debug] [Thread-4 (]: On model.retail_project.stg_stores: Close
[0m12:02:32.203574 [info ] [Thread-2 (]: 2 of 8 OK created sql view model marts_staging.stg_products .................... [[32mCREATE VIEW[0m in 0.42s]
[0m12:02:32.210970 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3f51ce7-8f7d-414f-bc1f-911e15c7eda6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbba7a3560>]}
[0m12:02:32.211938 [debug] [Thread-2 (]: Finished running node model.retail_project.stg_products
[0m12:02:32.213915 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3f51ce7-8f7d-414f-bc1f-911e15c7eda6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbba7a35c0>]}
[0m12:02:32.215513 [info ] [Thread-1 (]: 1 of 8 OK created sql view model marts_staging.stg_customers ................... [[32mCREATE VIEW[0m in 0.44s]
[0m12:02:32.220883 [debug] [Thread-1 (]: Finished running node model.retail_project.stg_customers
[0m12:02:32.218987 [info ] [Thread-4 (]: 4 of 8 OK created sql view model marts_staging.stg_stores ...................... [[32mCREATE VIEW[0m in 0.41s]
[0m12:02:32.223132 [debug] [Thread-1 (]: Began running node model.retail_project.dim_product
[0m12:02:32.224828 [debug] [Thread-4 (]: Finished running node model.retail_project.stg_stores
[0m12:02:32.226806 [info ] [Thread-1 (]: 5 of 8 START sql view model marts_marts.dim_product ............................ [RUN]
[0m12:02:32.229580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_customers, now model.retail_project.dim_product)
[0m12:02:32.231052 [debug] [Thread-2 (]: Began running node model.retail_project.dim_customer
[0m12:02:32.232655 [debug] [Thread-1 (]: Began compiling node model.retail_project.dim_product
[0m12:02:32.234214 [info ] [Thread-2 (]: 6 of 8 START sql view model marts_marts.dim_customer ........................... [RUN]
[0m12:02:32.240051 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_project.dim_product"
[0m12:02:32.242136 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_products, now model.retail_project.dim_customer)
[0m12:02:32.242994 [debug] [Thread-3 (]: Began running node model.retail_project.dim_store
[0m12:02:32.244329 [debug] [Thread-2 (]: Began compiling node model.retail_project.dim_customer
[0m12:02:32.246542 [info ] [Thread-3 (]: 7 of 8 START sql view model marts_marts.dim_store .............................. [RUN]
[0m12:02:32.251940 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_project.dim_customer"
[0m12:02:32.254243 [debug] [Thread-1 (]: Timing info for model.retail_project.dim_product (compile): 12:02:32.235684 => 12:02:32.253826
[0m12:02:32.256311 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_sales_transaction, now model.retail_project.dim_store)
[0m12:02:32.259087 [debug] [Thread-1 (]: Began executing node model.retail_project.dim_product
[0m12:02:32.261156 [debug] [Thread-3 (]: Began compiling node model.retail_project.dim_store
[0m12:02:32.262501 [debug] [Thread-2 (]: Timing info for model.retail_project.dim_customer (compile): 12:02:32.247799 => 12:02:32.262088
[0m12:02:32.277089 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_project.dim_product"
[0m12:02:32.279650 [debug] [Thread-2 (]: Began executing node model.retail_project.dim_customer
[0m12:02:32.280854 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_project.dim_store"
[0m12:02:32.289588 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:02:32.294041 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_project.dim_customer"
[0m12:02:32.295883 [debug] [Thread-3 (]: Timing info for model.retail_project.dim_store (compile): 12:02:32.270133 => 12:02:32.295134
[0m12:02:32.296979 [debug] [Thread-1 (]: On model.retail_project.dim_product: BEGIN
[0m12:02:32.298788 [debug] [Thread-3 (]: Began executing node model.retail_project.dim_store
[0m12:02:32.300162 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:02:32.301267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:32.309957 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_project.dim_store"
[0m12:02:32.312640 [debug] [Thread-2 (]: On model.retail_project.dim_customer: BEGIN
[0m12:02:32.318005 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:02:32.321961 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:02:32.323695 [debug] [Thread-3 (]: On model.retail_project.dim_store: BEGIN
[0m12:02:32.324200 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:02:32.335943 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:02:32.337011 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:02:32.338205 [debug] [Thread-1 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */

  create view "retail_dwh"."marts_marts"."dim_product__dbt_tmp"
    
    
  as (
    SELECT
    product_id,
    product_name,
    product_category,
    product_sub_category,
    product_price
FROM
    "retail_dwh"."marts_staging"."stg_products"
  );
[0m12:02:32.344867 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:02:32.354981 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:02:32.357019 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:02:32.359255 [debug] [Thread-3 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */

  create view "retail_dwh"."marts_marts"."dim_store__dbt_tmp"
    
    
  as (
    select
    store_id,
    store_name,
    city as store_city,
    store_region
from "retail_dwh"."marts_staging"."stg_stores"
  );
[0m12:02:32.370968 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:02:32.375100 [debug] [Thread-1 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */
alter table "retail_dwh"."marts_marts"."dim_product__dbt_tmp" rename to "dim_product"
[0m12:02:32.376655 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:02:32.378085 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:02:32.378648 [debug] [Thread-2 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */

  create view "retail_dwh"."marts_marts"."dim_customer__dbt_tmp"
    
    
  as (
    SELECT
    customer_id,
    customer_name,
    customer_gender,
    customer_city,
    customer_signup_date
FROM
    "retail_dwh"."marts_staging"."stg_customers"
  );
[0m12:02:32.379924 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:02:32.383483 [debug] [Thread-1 (]: On model.retail_project.dim_product: COMMIT
[0m12:02:32.385116 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:02:32.386665 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:02:32.387913 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:02:32.391957 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:02:32.396271 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:02:32.398359 [debug] [Thread-1 (]: On model.retail_project.dim_product: COMMIT
[0m12:02:32.399611 [debug] [Thread-3 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */
alter table "retail_dwh"."marts_marts"."dim_store__dbt_tmp" rename to "dim_store"
[0m12:02:32.400838 [debug] [Thread-2 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */
alter table "retail_dwh"."marts_marts"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m12:02:32.403849 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:02:32.406129 [debug] [Thread-3 (]: On model.retail_project.dim_store: COMMIT
[0m12:02:32.406657 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:02:32.407031 [debug] [Thread-3 (]: On model.retail_project.dim_store: COMMIT
[0m12:02:32.407854 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:02:32.410506 [debug] [Thread-2 (]: On model.retail_project.dim_customer: COMMIT
[0m12:02:32.410917 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:02:32.411287 [debug] [Thread-2 (]: On model.retail_project.dim_customer: COMMIT
[0m12:02:32.500107 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m12:02:32.516394 [debug] [Thread-3 (]: Applying DROP to: "retail_dwh"."marts_marts"."dim_store__dbt_backup"
[0m12:02:32.524220 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:02:32.526935 [debug] [Thread-3 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */
drop view if exists "retail_dwh"."marts_marts"."dim_store__dbt_backup" cascade
[0m12:02:32.528640 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:02:32.536689 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:02:32.539989 [debug] [Thread-3 (]: Timing info for model.retail_project.dim_store (execute): 12:02:32.302702 => 12:02:32.539642
[0m12:02:32.542491 [debug] [Thread-3 (]: On model.retail_project.dim_store: Close
[0m12:02:32.506241 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:02:32.548975 [debug] [Thread-1 (]: Applying DROP to: "retail_dwh"."marts_marts"."dim_product__dbt_backup"
[0m12:02:32.545859 [debug] [Thread-2 (]: Applying DROP to: "retail_dwh"."marts_marts"."dim_customer__dbt_backup"
[0m12:02:32.550663 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:02:32.554086 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3f51ce7-8f7d-414f-bc1f-911e15c7eda6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbba78ce00>]}
[0m12:02:32.557310 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:02:32.558960 [debug] [Thread-1 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */
drop view if exists "retail_dwh"."marts_marts"."dim_product__dbt_backup" cascade
[0m12:02:32.560173 [info ] [Thread-3 (]: 7 of 8 OK created sql view model marts_marts.dim_store ......................... [[32mCREATE VIEW[0m in 0.30s]
[0m12:02:32.561258 [debug] [Thread-2 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */
drop view if exists "retail_dwh"."marts_marts"."dim_customer__dbt_backup" cascade
[0m12:02:32.563529 [debug] [Thread-3 (]: Finished running node model.retail_project.dim_store
[0m12:02:32.564363 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:02:32.571567 [debug] [Thread-1 (]: Timing info for model.retail_project.dim_product (execute): 12:02:32.263261 => 12:02:32.571262
[0m12:02:32.573053 [debug] [Thread-1 (]: On model.retail_project.dim_product: Close
[0m12:02:32.576898 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:02:32.579476 [debug] [Thread-2 (]: Timing info for model.retail_project.dim_customer (execute): 12:02:32.282767 => 12:02:32.579195
[0m12:02:32.581793 [debug] [Thread-2 (]: On model.retail_project.dim_customer: Close
[0m12:02:32.584431 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3f51ce7-8f7d-414f-bc1f-911e15c7eda6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbbafd16a0>]}
[0m12:02:32.588710 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3f51ce7-8f7d-414f-bc1f-911e15c7eda6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbbafd27b0>]}
[0m12:02:32.585646 [info ] [Thread-1 (]: 5 of 8 OK created sql view model marts_marts.dim_product ....................... [[32mCREATE VIEW[0m in 0.36s]
[0m12:02:32.590919 [info ] [Thread-2 (]: 6 of 8 OK created sql view model marts_marts.dim_customer ...................... [[32mCREATE VIEW[0m in 0.35s]
[0m12:02:32.593039 [debug] [Thread-1 (]: Finished running node model.retail_project.dim_product
[0m12:02:32.594313 [debug] [Thread-2 (]: Finished running node model.retail_project.dim_customer
[0m12:02:32.598347 [debug] [Thread-4 (]: Began running node model.retail_project.fact_sales
[0m12:02:32.599387 [info ] [Thread-4 (]: 8 of 8 START sql view model marts_marts.fact_sales ............................. [RUN]
[0m12:02:32.600634 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_stores, now model.retail_project.fact_sales)
[0m12:02:32.601313 [debug] [Thread-4 (]: Began compiling node model.retail_project.fact_sales
[0m12:02:32.606142 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_project.fact_sales"
[0m12:02:32.607878 [debug] [Thread-4 (]: Timing info for model.retail_project.fact_sales (compile): 12:02:32.601974 => 12:02:32.607583
[0m12:02:32.608302 [debug] [Thread-4 (]: Began executing node model.retail_project.fact_sales
[0m12:02:32.613236 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_project.fact_sales"
[0m12:02:32.614751 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.fact_sales"
[0m12:02:32.615178 [debug] [Thread-4 (]: On model.retail_project.fact_sales: BEGIN
[0m12:02:32.615513 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:02:32.631238 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:02:32.632244 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.fact_sales"
[0m12:02:32.633090 [debug] [Thread-4 (]: On model.retail_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.fact_sales"} */

  create view "retail_dwh"."marts_marts"."fact_sales__dbt_tmp"
    
    
  as (
    with sales as (
    select *
    from "retail_dwh"."marts_staging"."stg_sales_transaction"  -- transaksi
),

joined as (
    select
        s.transaction_id,
        s.transaction_date,
        s.customer_id,
        s.product_id,          -- pakai alias s.
        s.store_id,
        s.quantity,
        s.unit_price,
        s.quantity * s.unit_price as gross_sales,

        c.customer_name,
        p.product_name,
        p.category,
        st.store_name,
        st.city,
        st.store_region
    from "retail_dwh"."marts_staging"."stg_sales_transaction" s
    left join "retail_dwh"."marts_marts"."dim_customer" c
        on s.customer_id = c.customer_id
    left join "retail_dwh"."marts_marts"."dim_product" p
        on s.product_id = p.product_id
    left join "retail_dwh"."marts_marts"."dim_store" st
        on s.store_id = st.store_id
)

select * from joined;
  );
[0m12:02:32.636058 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 38: select * from joined;
                             ^

[0m12:02:32.637036 [debug] [Thread-4 (]: On model.retail_project.fact_sales: ROLLBACK
[0m12:02:32.638392 [debug] [Thread-4 (]: Timing info for model.retail_project.fact_sales (execute): 12:02:32.608558 => 12:02:32.637995
[0m12:02:32.639934 [debug] [Thread-4 (]: On model.retail_project.fact_sales: Close
[0m12:02:32.646241 [debug] [Thread-4 (]: Database Error in model fact_sales (models/marts/facts/fact_sales.sql)
  syntax error at or near ";"
  LINE 38: select * from joined;
                               ^
  compiled Code at target/run/retail_project/models/marts/facts/fact_sales.sql
[0m12:02:32.647722 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3f51ce7-8f7d-414f-bc1f-911e15c7eda6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbba747830>]}
[0m12:02:32.648359 [error] [Thread-4 (]: 8 of 8 ERROR creating sql view model marts_marts.fact_sales .................... [[31mERROR[0m in 0.05s]
[0m12:02:32.649699 [debug] [Thread-4 (]: Finished running node model.retail_project.fact_sales
[0m12:02:32.657830 [debug] [MainThread]: Using postgres connection "master"
[0m12:02:32.659001 [debug] [MainThread]: On master: BEGIN
[0m12:02:32.659345 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:02:32.675297 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:02:32.676549 [debug] [MainThread]: On master: COMMIT
[0m12:02:32.677388 [debug] [MainThread]: Using postgres connection "master"
[0m12:02:32.678031 [debug] [MainThread]: On master: COMMIT
[0m12:02:32.679351 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:02:32.680722 [debug] [MainThread]: On master: Close
[0m12:02:32.683272 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:02:32.685029 [debug] [MainThread]: Connection 'model.retail_project.dim_product' was properly closed.
[0m12:02:32.686144 [debug] [MainThread]: Connection 'model.retail_project.dim_customer' was properly closed.
[0m12:02:32.687098 [debug] [MainThread]: Connection 'model.retail_project.dim_store' was properly closed.
[0m12:02:32.687585 [debug] [MainThread]: Connection 'model.retail_project.fact_sales' was properly closed.
[0m12:02:32.688004 [info ] [MainThread]: 
[0m12:02:32.688823 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 1.23 seconds (1.23s).
[0m12:02:32.691430 [debug] [MainThread]: Command end result
[0m12:02:32.707011 [info ] [MainThread]: 
[0m12:02:32.708054 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:02:32.709105 [info ] [MainThread]: 
[0m12:02:32.710053 [error] [MainThread]:   Database Error in model fact_sales (models/marts/facts/fact_sales.sql)
  syntax error at or near ";"
  LINE 38: select * from joined;
                               ^
  compiled Code at target/run/retail_project/models/marts/facts/fact_sales.sql
[0m12:02:32.710878 [info ] [MainThread]: 
[0m12:02:32.711436 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m12:02:32.713000 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.0775373, "process_user_time": 4.356507, "process_kernel_time": 0.959558, "process_mem_max_rss": "151448", "process_out_blocks": "2648", "command_success": false, "process_in_blocks": "0"}
[0m12:02:32.713558 [debug] [MainThread]: Command `dbt run` failed at 12:02:32.713371 after 2.08 seconds
[0m12:02:32.714002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbc0ef6810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbbb326270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbbcdc2d80>]}
[0m12:02:32.714364 [debug] [MainThread]: Flushing usage events
[0m12:03:55.672638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcab277710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcab275340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcab277c50>]}


============================== 12:03:55.676945 | 3fdcd707-345c-4b9b-aa5c-b3a1a20753f9 ==============================
[0m12:03:55.676945 [info ] [MainThread]: Running with dbt=1.7.0
[0m12:03:55.678182 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/opt/dbt/retail_project/retail_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /root/.dbt', 'send_anonymous_usage_stats': 'True'}
[0m12:03:55.917739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fdcd707-345c-4b9b-aa5c-b3a1a20753f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcab0b2210>]}
[0m12:03:56.038934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3fdcd707-345c-4b9b-aa5c-b3a1a20753f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcab126a80>]}
[0m12:03:56.039968 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m12:03:56.053880 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m12:03:56.100093 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:03:56.100988 [debug] [MainThread]: Partial parsing: updated file: retail_project://models/marts/facts/fact_sales.sql
[0m12:03:56.384088 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail_project.intermediate
[0m12:03:56.395050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fdcd707-345c-4b9b-aa5c-b3a1a20753f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcaa53f590>]}
[0m12:03:56.420390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fdcd707-345c-4b9b-aa5c-b3a1a20753f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcaa59c2c0>]}
[0m12:03:56.421268 [info ] [MainThread]: Found 8 models, 4 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:03:56.422208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fdcd707-345c-4b9b-aa5c-b3a1a20753f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcab126ed0>]}
[0m12:03:56.427622 [info ] [MainThread]: 
[0m12:03:56.429464 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:03:56.433442 [debug] [ThreadPool]: Acquiring new postgres connection 'list_retail_dwh'
[0m12:03:56.443416 [debug] [ThreadPool]: Acquiring new postgres connection 'list_retail_dwh'
[0m12:03:56.467289 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh"
[0m12:03:56.468969 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh"
[0m12:03:56.469905 [debug] [ThreadPool]: On list_retail_dwh: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh"} */

    select distinct nspname from pg_namespace
  
[0m12:03:56.470917 [debug] [ThreadPool]: On list_retail_dwh: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh"} */

    select distinct nspname from pg_namespace
  
[0m12:03:56.471741 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:03:56.472569 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:03:56.493088 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m12:03:56.495241 [debug] [ThreadPool]: On list_retail_dwh: Close
[0m12:03:56.495941 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m12:03:56.499296 [debug] [ThreadPool]: On list_retail_dwh: Close
[0m12:03:56.508295 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_dwh, now list_retail_dwh_marts_marts)
[0m12:03:56.519125 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_dwh, now list_retail_dwh_marts_staging)
[0m12:03:56.607586 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_marts"
[0m12:03:56.611761 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_staging"
[0m12:03:56.612659 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: BEGIN
[0m12:03:56.613994 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: BEGIN
[0m12:03:56.614723 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:03:56.616009 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:03:56.633245 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:03:56.634634 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_staging"
[0m12:03:56.635441 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh_marts_staging"} */
select
      'retail_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'retail_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'retail_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m12:03:56.636808 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:03:56.638026 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_marts"
[0m12:03:56.638396 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh_marts_marts"} */
select
      'retail_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'retail_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'retail_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m12:03:56.641977 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:03:56.644844 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: ROLLBACK
[0m12:03:56.645874 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m12:03:56.647980 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: ROLLBACK
[0m12:03:56.649824 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: Close
[0m12:03:56.651078 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: Close
[0m12:03:56.664691 [debug] [MainThread]: Using postgres connection "master"
[0m12:03:56.665493 [debug] [MainThread]: On master: BEGIN
[0m12:03:56.665970 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:03:56.678395 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:03:56.678871 [debug] [MainThread]: Using postgres connection "master"
[0m12:03:56.679397 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:03:56.720188 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m12:03:56.723925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fdcd707-345c-4b9b-aa5c-b3a1a20753f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdca9dfbaa0>]}
[0m12:03:56.724942 [debug] [MainThread]: On master: ROLLBACK
[0m12:03:56.725605 [debug] [MainThread]: Using postgres connection "master"
[0m12:03:56.725960 [debug] [MainThread]: On master: BEGIN
[0m12:03:56.726721 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:03:56.727332 [debug] [MainThread]: On master: COMMIT
[0m12:03:56.727643 [debug] [MainThread]: Using postgres connection "master"
[0m12:03:56.727924 [debug] [MainThread]: On master: COMMIT
[0m12:03:56.728400 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:03:56.728709 [debug] [MainThread]: On master: Close
[0m12:03:56.731223 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:03:56.731900 [info ] [MainThread]: 
[0m12:03:56.741996 [debug] [Thread-1 (]: Began running node model.retail_project.stg_customers
[0m12:03:56.744133 [debug] [Thread-2 (]: Began running node model.retail_project.stg_products
[0m12:03:56.746138 [debug] [Thread-3 (]: Began running node model.retail_project.stg_sales_transaction
[0m12:03:56.749526 [debug] [Thread-4 (]: Began running node model.retail_project.stg_stores
[0m12:03:56.743189 [info ] [Thread-1 (]: 1 of 8 START sql view model marts_staging.stg_customers ........................ [RUN]
[0m12:03:56.745139 [info ] [Thread-2 (]: 2 of 8 START sql view model marts_staging.stg_products ......................... [RUN]
[0m12:03:56.753187 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail_dwh_marts_marts, now model.retail_project.stg_customers)
[0m12:03:56.755534 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_retail_dwh_marts_staging, now model.retail_project.stg_products)
[0m12:03:56.757002 [debug] [Thread-1 (]: Began compiling node model.retail_project.stg_customers
[0m12:03:56.747984 [info ] [Thread-3 (]: 3 of 8 START sql view model marts_staging.stg_sales_transaction ................ [RUN]
[0m12:03:56.758854 [debug] [Thread-2 (]: Began compiling node model.retail_project.stg_products
[0m12:03:56.772858 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_project.stg_customers"
[0m12:03:56.775610 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.retail_project.stg_sales_transaction'
[0m12:03:56.785976 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_project.stg_products"
[0m12:03:56.750425 [info ] [Thread-4 (]: 4 of 8 START sql view model marts_staging.stg_stores ........................... [RUN]
[0m12:03:56.789336 [debug] [Thread-3 (]: Began compiling node model.retail_project.stg_sales_transaction
[0m12:03:56.791038 [debug] [Thread-1 (]: Timing info for model.retail_project.stg_customers (compile): 12:03:56.759913 => 12:03:56.790477
[0m12:03:56.793738 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.retail_project.stg_stores'
[0m12:03:56.800016 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_project.stg_sales_transaction"
[0m12:03:56.801710 [debug] [Thread-1 (]: Began executing node model.retail_project.stg_customers
[0m12:03:56.803319 [debug] [Thread-4 (]: Began compiling node model.retail_project.stg_stores
[0m12:03:56.802492 [debug] [Thread-2 (]: Timing info for model.retail_project.stg_products (compile): 12:03:56.777206 => 12:03:56.802245
[0m12:03:56.850673 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_project.stg_customers"
[0m12:03:56.862014 [debug] [Thread-3 (]: Timing info for model.retail_project.stg_sales_transaction (compile): 12:03:56.795466 => 12:03:56.861330
[0m12:03:56.863143 [debug] [Thread-2 (]: Began executing node model.retail_project.stg_products
[0m12:03:56.867414 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_project.stg_stores"
[0m12:03:56.869850 [debug] [Thread-3 (]: Began executing node model.retail_project.stg_sales_transaction
[0m12:03:56.877298 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_project.stg_products"
[0m12:03:56.878264 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:03:56.879924 [debug] [Thread-4 (]: Timing info for model.retail_project.stg_stores (compile): 12:03:56.855843 => 12:03:56.879656
[0m12:03:56.889054 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_project.stg_sales_transaction"
[0m12:03:56.891384 [debug] [Thread-1 (]: On model.retail_project.stg_customers: BEGIN
[0m12:03:56.893812 [debug] [Thread-4 (]: Began executing node model.retail_project.stg_stores
[0m12:03:56.895494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:03:56.896589 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m12:03:56.903763 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_project.stg_stores"
[0m12:03:56.904931 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:03:56.907768 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: BEGIN
[0m12:03:56.909399 [debug] [Thread-2 (]: On model.retail_project.stg_products: BEGIN
[0m12:03:56.910859 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:03:56.912732 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:03:56.913507 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:03:56.916132 [debug] [Thread-4 (]: On model.retail_project.stg_stores: BEGIN
[0m12:03:56.923036 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:03:56.928634 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:03:56.929917 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:03:56.930505 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */

  create view "retail_dwh"."marts_staging"."stg_customers__dbt_tmp"
    
    
  as (
    SELECT
    customer_id,
    customer_name,
    UPPER(TRIM(gender)) AS customer_gender,
    TRIM(city) AS customer_city,
    CAST(signup_date AS DATE) AS customer_signup_date
FROM
    "retail_dwh"."raw"."customers_raw"
  );
[0m12:03:56.933605 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:03:56.935012 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:03:56.936650 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */

  create view "retail_dwh"."marts_staging"."stg_products__dbt_tmp"
    
    
  as (
    SELECT
    product_id,
    product_name,
    TRIM(category) AS product_category,
    TRIM(sub_category) AS product_sub_category,
    CAST(price AS NUMERIC) AS product_price
FROM
    "retail_dwh"."raw"."products_raw"
  );
[0m12:03:56.937789 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:03:56.956892 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:03:56.958206 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:03:56.959188 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:03:56.964114 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:03:56.965538 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:03:56.967165 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m12:03:56.968231 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
alter table "retail_dwh"."marts_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m12:03:56.969359 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
alter table "retail_dwh"."marts_staging"."stg_products" rename to "stg_products__dbt_backup"
[0m12:03:56.970731 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:03:56.971883 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */

  create view "retail_dwh"."marts_staging"."stg_sales_transaction__dbt_tmp"
    
    
  as (
    SELECT
    transaction_id,
    CAST(transaction_date AS DATE) AS transaction_date,
    customer_id,
    product_id,
    store_id,
    CAST(quantity AS INTEGER) AS quantity,
    CAST(total_price AS NUMERIC) AS total_price
FROM
    "retail_dwh"."raw"."sales_transaction_raw"
  );
[0m12:03:56.973900 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */

  create view "retail_dwh"."marts_staging"."stg_stores__dbt_tmp"
    
    
  as (
    with source as (
    select
        store_id,
        store_name,
        city,
        region
    from "retail_dwh"."raw"."stores_raw"
),

renamed as (
    select
        store_id,
        store_name,
        city,
        region as store_region
    from source
)

select * from renamed
  );
[0m12:03:56.976383 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:03:56.977257 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:03:56.985055 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:03:56.985952 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:03:56.987098 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:03:56.991010 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:03:56.993318 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
alter table "retail_dwh"."marts_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m12:03:56.997892 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m12:03:57.003568 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:03:57.005819 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
alter table "retail_dwh"."marts_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m12:03:57.007799 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */
alter table "retail_dwh"."marts_staging"."stg_sales_transaction" rename to "stg_sales_transaction__dbt_backup"
[0m12:03:57.008906 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:03:57.010084 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
alter table "retail_dwh"."marts_staging"."stg_stores" rename to "stg_stores__dbt_backup"
[0m12:03:57.041109 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:03:57.050322 [debug] [Thread-1 (]: On model.retail_project.stg_customers: COMMIT
[0m12:03:57.053224 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:03:57.054609 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:03:57.058125 [debug] [Thread-2 (]: On model.retail_project.stg_products: COMMIT
[0m12:03:57.059874 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:03:57.064582 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m12:03:57.075218 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:03:57.076656 [debug] [Thread-1 (]: On model.retail_project.stg_customers: COMMIT
[0m12:03:57.078045 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:03:57.084783 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
alter table "retail_dwh"."marts_staging"."stg_stores__dbt_tmp" rename to "stg_stores"
[0m12:03:57.083089 [debug] [Thread-2 (]: On model.retail_project.stg_products: COMMIT
[0m12:03:57.079501 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */
alter table "retail_dwh"."marts_staging"."stg_sales_transaction__dbt_tmp" rename to "stg_sales_transaction"
[0m12:03:57.087028 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:03:57.091141 [debug] [Thread-4 (]: On model.retail_project.stg_stores: COMMIT
[0m12:03:57.092622 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:03:57.094593 [debug] [Thread-4 (]: On model.retail_project.stg_stores: COMMIT
[0m12:03:57.095724 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:03:57.098851 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: COMMIT
[0m12:03:57.099778 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m12:03:57.100243 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: COMMIT
[0m12:03:57.123842 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m12:03:57.125167 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m12:03:57.135273 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:03:57.136100 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:03:57.143067 [debug] [Thread-4 (]: Applying DROP to: "retail_dwh"."marts_staging"."stg_stores__dbt_backup"
[0m12:03:57.147241 [debug] [Thread-3 (]: Applying DROP to: "retail_dwh"."marts_staging"."stg_sales_transaction__dbt_backup"
[0m12:03:57.152115 [debug] [Thread-2 (]: Applying DROP to: "retail_dwh"."marts_staging"."stg_products__dbt_backup"
[0m12:03:57.156896 [debug] [Thread-1 (]: Applying DROP to: "retail_dwh"."marts_staging"."stg_customers__dbt_backup"
[0m12:03:57.167707 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:03:57.171410 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m12:03:57.173290 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:03:57.175276 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:03:57.176753 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
drop view if exists "retail_dwh"."marts_staging"."stg_stores__dbt_backup" cascade
[0m12:03:57.177663 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */
drop view if exists "retail_dwh"."marts_staging"."stg_sales_transaction__dbt_backup" cascade
[0m12:03:57.178980 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
drop view if exists "retail_dwh"."marts_staging"."stg_products__dbt_backup" cascade
[0m12:03:57.180031 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
drop view if exists "retail_dwh"."marts_staging"."stg_customers__dbt_backup" cascade
[0m12:03:57.188488 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:03:57.192181 [debug] [Thread-3 (]: Timing info for model.retail_project.stg_sales_transaction (execute): 12:03:56.880938 => 12:03:57.191903
[0m12:03:57.193309 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: Close
[0m12:03:57.195123 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:03:57.195623 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:03:57.200670 [debug] [Thread-2 (]: Timing info for model.retail_project.stg_products (execute): 12:03:56.871779 => 12:03:57.199954
[0m12:03:57.202912 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:03:57.204142 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fdcd707-345c-4b9b-aa5c-b3a1a20753f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdca99b1880>]}
[0m12:03:57.207815 [debug] [Thread-4 (]: Timing info for model.retail_project.stg_stores (execute): 12:03:56.897630 => 12:03:57.207026
[0m12:03:57.210499 [debug] [Thread-2 (]: On model.retail_project.stg_products: Close
[0m12:03:57.220816 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fdcd707-345c-4b9b-aa5c-b3a1a20753f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdca99b3f20>]}
[0m12:03:57.214222 [debug] [Thread-1 (]: Timing info for model.retail_project.stg_customers (execute): 12:03:56.805089 => 12:03:57.213903
[0m12:03:57.218136 [debug] [Thread-4 (]: On model.retail_project.stg_stores: Close
[0m12:03:57.216149 [info ] [Thread-3 (]: 3 of 8 OK created sql view model marts_staging.stg_sales_transaction ........... [[32mCREATE VIEW[0m in 0.43s]
[0m12:03:57.227055 [debug] [Thread-3 (]: Finished running node model.retail_project.stg_sales_transaction
[0m12:03:57.221844 [info ] [Thread-2 (]: 2 of 8 OK created sql view model marts_staging.stg_products .................... [[32mCREATE VIEW[0m in 0.47s]
[0m12:03:57.225840 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fdcd707-345c-4b9b-aa5c-b3a1a20753f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdca99b2de0>]}
[0m12:03:57.223170 [debug] [Thread-1 (]: On model.retail_project.stg_customers: Close
[0m12:03:57.229629 [debug] [Thread-2 (]: Finished running node model.retail_project.stg_products
[0m12:03:57.231759 [info ] [Thread-4 (]: 4 of 8 OK created sql view model marts_staging.stg_stores ...................... [[32mCREATE VIEW[0m in 0.43s]
[0m12:03:57.235268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fdcd707-345c-4b9b-aa5c-b3a1a20753f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdca99b28d0>]}
[0m12:03:57.238142 [debug] [Thread-4 (]: Finished running node model.retail_project.stg_stores
[0m12:03:57.240588 [info ] [Thread-1 (]: 1 of 8 OK created sql view model marts_staging.stg_customers ................... [[32mCREATE VIEW[0m in 0.48s]
[0m12:03:57.243389 [debug] [Thread-4 (]: Began running node model.retail_project.dim_product
[0m12:03:57.246052 [debug] [Thread-1 (]: Finished running node model.retail_project.stg_customers
[0m12:03:57.247392 [info ] [Thread-4 (]: 5 of 8 START sql view model marts_marts.dim_product ............................ [RUN]
[0m12:03:57.251806 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_stores, now model.retail_project.dim_product)
[0m12:03:57.252987 [debug] [Thread-4 (]: Began compiling node model.retail_project.dim_product
[0m12:03:57.256459 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_project.dim_product"
[0m12:03:57.259362 [debug] [Thread-4 (]: Timing info for model.retail_project.dim_product (compile): 12:03:57.253718 => 12:03:57.258879
[0m12:03:57.260976 [debug] [Thread-4 (]: Began executing node model.retail_project.dim_product
[0m12:03:57.270084 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_project.dim_product"
[0m12:03:57.272138 [debug] [Thread-2 (]: Began running node model.retail_project.dim_customer
[0m12:03:57.273924 [info ] [Thread-2 (]: 6 of 8 START sql view model marts_marts.dim_customer ........................... [RUN]
[0m12:03:57.277513 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_products, now model.retail_project.dim_customer)
[0m12:03:57.279065 [debug] [Thread-2 (]: Began compiling node model.retail_project.dim_customer
[0m12:03:57.283039 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_project.dim_customer"
[0m12:03:57.286176 [debug] [Thread-3 (]: Began running node model.retail_project.dim_store
[0m12:03:57.288007 [info ] [Thread-3 (]: 7 of 8 START sql view model marts_marts.dim_store .............................. [RUN]
[0m12:03:57.291548 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_sales_transaction, now model.retail_project.dim_store)
[0m12:03:57.293939 [debug] [Thread-3 (]: Began compiling node model.retail_project.dim_store
[0m12:03:57.298292 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_project.dim_store"
[0m12:03:57.307785 [debug] [Thread-3 (]: Timing info for model.retail_project.dim_store (compile): 12:03:57.294877 => 12:03:57.306977
[0m12:03:57.304421 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:03:57.302050 [debug] [Thread-2 (]: Timing info for model.retail_project.dim_customer (compile): 12:03:57.279833 => 12:03:57.301257
[0m12:03:57.308825 [debug] [Thread-3 (]: Began executing node model.retail_project.dim_store
[0m12:03:57.310438 [debug] [Thread-4 (]: On model.retail_project.dim_product: BEGIN
[0m12:03:57.312630 [debug] [Thread-2 (]: Began executing node model.retail_project.dim_customer
[0m12:03:57.321078 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_project.dim_store"
[0m12:03:57.323855 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:03:57.332071 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_project.dim_customer"
[0m12:03:57.336360 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:03:57.340222 [debug] [Thread-3 (]: On model.retail_project.dim_store: BEGIN
[0m12:03:57.342427 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:03:57.346757 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:03:57.351795 [debug] [Thread-2 (]: On model.retail_project.dim_customer: BEGIN
[0m12:03:57.352576 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:03:57.355636 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:03:57.356996 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:03:57.358221 [debug] [Thread-4 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */

  create view "retail_dwh"."marts_marts"."dim_product__dbt_tmp"
    
    
  as (
    SELECT
    product_id,
    product_name,
    product_category,
    product_sub_category,
    product_price
FROM
    "retail_dwh"."marts_staging"."stg_products"
  );
[0m12:03:57.361933 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:03:57.373196 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:03:57.374844 [debug] [Thread-4 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */
alter table "retail_dwh"."marts_marts"."dim_product__dbt_tmp" rename to "dim_product"
[0m12:03:57.376268 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:03:57.377540 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:03:57.379387 [debug] [Thread-3 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */

  create view "retail_dwh"."marts_marts"."dim_store__dbt_tmp"
    
    
  as (
    select
    store_id,
    store_name,
    city as store_city,
    store_region
from "retail_dwh"."marts_staging"."stg_stores"
  );
[0m12:03:57.383823 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:03:57.388204 [debug] [Thread-4 (]: On model.retail_project.dim_product: COMMIT
[0m12:03:57.389852 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:03:57.391821 [debug] [Thread-4 (]: On model.retail_project.dim_product: COMMIT
[0m12:03:57.394107 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:03:57.400414 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:03:57.402961 [debug] [Thread-3 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */
alter table "retail_dwh"."marts_marts"."dim_store__dbt_tmp" rename to "dim_store"
[0m12:03:57.404456 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m12:03:57.406284 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:03:57.407859 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:03:57.412860 [debug] [Thread-4 (]: Applying DROP to: "retail_dwh"."marts_marts"."dim_product__dbt_backup"
[0m12:03:57.417798 [debug] [Thread-3 (]: On model.retail_project.dim_store: COMMIT
[0m12:03:57.419869 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:03:57.421668 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:03:57.423211 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:03:57.425881 [debug] [Thread-2 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */

  create view "retail_dwh"."marts_marts"."dim_customer__dbt_tmp"
    
    
  as (
    SELECT
    customer_id,
    customer_name,
    customer_gender,
    customer_city,
    customer_signup_date
FROM
    "retail_dwh"."marts_staging"."stg_customers"
  );
[0m12:03:57.427099 [debug] [Thread-4 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */
drop view if exists "retail_dwh"."marts_marts"."dim_product__dbt_backup" cascade
[0m12:03:57.428194 [debug] [Thread-3 (]: On model.retail_project.dim_store: COMMIT
[0m12:03:57.431062 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:03:57.435896 [debug] [Thread-4 (]: Timing info for model.retail_project.dim_product (execute): 12:03:57.261495 => 12:03:57.435545
[0m12:03:57.437048 [debug] [Thread-4 (]: On model.retail_project.dim_product: Close
[0m12:03:57.438920 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:03:57.447903 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m12:03:57.453881 [debug] [Thread-3 (]: Applying DROP to: "retail_dwh"."marts_marts"."dim_store__dbt_backup"
[0m12:03:57.456501 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:03:57.459320 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fdcd707-345c-4b9b-aa5c-b3a1a20753f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdca9520440>]}
[0m12:03:57.461579 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:03:57.463928 [debug] [Thread-3 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */
drop view if exists "retail_dwh"."marts_marts"."dim_store__dbt_backup" cascade
[0m12:03:57.467192 [info ] [Thread-4 (]: 5 of 8 OK created sql view model marts_marts.dim_product ....................... [[32mCREATE VIEW[0m in 0.21s]
[0m12:03:57.469683 [debug] [Thread-2 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */
alter table "retail_dwh"."marts_marts"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m12:03:57.472663 [debug] [Thread-4 (]: Finished running node model.retail_project.dim_product
[0m12:03:57.474794 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:03:57.477021 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:03:57.480736 [debug] [Thread-3 (]: Timing info for model.retail_project.dim_store (execute): 12:03:57.313901 => 12:03:57.480218
[0m12:03:57.484300 [debug] [Thread-2 (]: On model.retail_project.dim_customer: COMMIT
[0m12:03:57.486664 [debug] [Thread-3 (]: On model.retail_project.dim_store: Close
[0m12:03:57.487964 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:03:57.490259 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fdcd707-345c-4b9b-aa5c-b3a1a20753f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdca9523f80>]}
[0m12:03:57.493089 [debug] [Thread-2 (]: On model.retail_project.dim_customer: COMMIT
[0m12:03:57.494901 [info ] [Thread-3 (]: 7 of 8 OK created sql view model marts_marts.dim_store ......................... [[32mCREATE VIEW[0m in 0.20s]
[0m12:03:57.497169 [debug] [Thread-3 (]: Finished running node model.retail_project.dim_store
[0m12:03:57.499609 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:03:57.503010 [debug] [Thread-2 (]: Applying DROP to: "retail_dwh"."marts_marts"."dim_customer__dbt_backup"
[0m12:03:57.504024 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:03:57.504447 [debug] [Thread-2 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */
drop view if exists "retail_dwh"."marts_marts"."dim_customer__dbt_backup" cascade
[0m12:03:57.505207 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:03:57.507120 [debug] [Thread-2 (]: Timing info for model.retail_project.dim_customer (execute): 12:03:57.325293 => 12:03:57.506859
[0m12:03:57.507570 [debug] [Thread-2 (]: On model.retail_project.dim_customer: Close
[0m12:03:57.512654 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fdcd707-345c-4b9b-aa5c-b3a1a20753f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdca993c7d0>]}
[0m12:03:57.513945 [info ] [Thread-2 (]: 6 of 8 OK created sql view model marts_marts.dim_customer ...................... [[32mCREATE VIEW[0m in 0.24s]
[0m12:03:57.516449 [debug] [Thread-2 (]: Finished running node model.retail_project.dim_customer
[0m12:03:57.519371 [debug] [Thread-1 (]: Began running node model.retail_project.fact_sales
[0m12:03:57.521036 [info ] [Thread-1 (]: 8 of 8 START sql view model marts_marts.fact_sales ............................. [RUN]
[0m12:03:57.523074 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_customers, now model.retail_project.fact_sales)
[0m12:03:57.524065 [debug] [Thread-1 (]: Began compiling node model.retail_project.fact_sales
[0m12:03:57.533303 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_project.fact_sales"
[0m12:03:57.535503 [debug] [Thread-1 (]: Timing info for model.retail_project.fact_sales (compile): 12:03:57.524485 => 12:03:57.535175
[0m12:03:57.536204 [debug] [Thread-1 (]: Began executing node model.retail_project.fact_sales
[0m12:03:57.545703 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_project.fact_sales"
[0m12:03:57.547530 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.fact_sales"
[0m12:03:57.549347 [debug] [Thread-1 (]: On model.retail_project.fact_sales: BEGIN
[0m12:03:57.550227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:03:57.568783 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:03:57.569316 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.fact_sales"
[0m12:03:57.570053 [debug] [Thread-1 (]: On model.retail_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.fact_sales"} */

  create view "retail_dwh"."marts_marts"."fact_sales__dbt_tmp"
    
    
  as (
    with sales as (
    select
        transaction_id,
        transaction_date,
        customer_id,
        product_id,
        store_id,
        quantity,
        unit_price,
        quantity * unit_price as gross_sales
    from "retail_dwh"."marts_staging"."stg_sales_transaction"
),

joined as (
    select
        s.transaction_id,
        s.transaction_date,
        s.customer_id,
        s.product_id,
        s.store_id,
        s.quantity,
        s.unit_price,
        s.gross_sales,

        c.customer_name,
        p.product_name,
        p.category,
        st.store_name,
        st.store_city,
        st.store_region
    from sales s
    left join "retail_dwh"."marts_marts"."dim_customer" c
        on s.customer_id = c.customer_id
    left join "retail_dwh"."marts_marts"."dim_product" p
        on s.product_id = p.product_id
    left join "retail_dwh"."marts_marts"."dim_store" st
        on s.store_id = st.store_id
)

select * from joined
  );
[0m12:03:57.571990 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "unit_price" does not exist
LINE 15:         unit_price,
                 ^

[0m12:03:57.572786 [debug] [Thread-1 (]: On model.retail_project.fact_sales: ROLLBACK
[0m12:03:57.574626 [debug] [Thread-1 (]: Timing info for model.retail_project.fact_sales (execute): 12:03:57.536841 => 12:03:57.574023
[0m12:03:57.575121 [debug] [Thread-1 (]: On model.retail_project.fact_sales: Close
[0m12:03:57.584371 [debug] [Thread-1 (]: Database Error in model fact_sales (models/marts/facts/fact_sales.sql)
  column "unit_price" does not exist
  LINE 15:         unit_price,
                   ^
  compiled Code at target/run/retail_project/models/marts/facts/fact_sales.sql
[0m12:03:57.585372 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fdcd707-345c-4b9b-aa5c-b3a1a20753f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdca992a870>]}
[0m12:03:57.586365 [error] [Thread-1 (]: 8 of 8 ERROR creating sql view model marts_marts.fact_sales .................... [[31mERROR[0m in 0.06s]
[0m12:03:57.589182 [debug] [Thread-1 (]: Finished running node model.retail_project.fact_sales
[0m12:03:57.596735 [debug] [MainThread]: Using postgres connection "master"
[0m12:03:57.598656 [debug] [MainThread]: On master: BEGIN
[0m12:03:57.599587 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:03:57.616040 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:03:57.619034 [debug] [MainThread]: On master: COMMIT
[0m12:03:57.619488 [debug] [MainThread]: Using postgres connection "master"
[0m12:03:57.620482 [debug] [MainThread]: On master: COMMIT
[0m12:03:57.622141 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:03:57.622785 [debug] [MainThread]: On master: Close
[0m12:03:57.624238 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:03:57.624809 [debug] [MainThread]: Connection 'model.retail_project.dim_customer' was properly closed.
[0m12:03:57.625346 [debug] [MainThread]: Connection 'model.retail_project.fact_sales' was properly closed.
[0m12:03:57.625831 [debug] [MainThread]: Connection 'model.retail_project.dim_store' was properly closed.
[0m12:03:57.626327 [debug] [MainThread]: Connection 'model.retail_project.dim_product' was properly closed.
[0m12:03:57.626970 [info ] [MainThread]: 
[0m12:03:57.628143 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 1.20 seconds (1.20s).
[0m12:03:57.633681 [debug] [MainThread]: Command end result
[0m12:03:57.648127 [info ] [MainThread]: 
[0m12:03:57.649614 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:03:57.651058 [info ] [MainThread]: 
[0m12:03:57.652076 [error] [MainThread]:   Database Error in model fact_sales (models/marts/facts/fact_sales.sql)
  column "unit_price" does not exist
  LINE 15:         unit_price,
                   ^
  compiled Code at target/run/retail_project/models/marts/facts/fact_sales.sql
[0m12:03:57.653239 [info ] [MainThread]: 
[0m12:03:57.653888 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m12:03:57.656788 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.0408487, "process_user_time": 3.918856, "process_kernel_time": 1.004963, "process_mem_max_rss": "151460", "process_out_blocks": "2648", "command_success": false, "process_in_blocks": "0"}
[0m12:03:57.657442 [debug] [MainThread]: Command `dbt run` failed at 12:03:57.657263 after 2.04 seconds
[0m12:03:57.657915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdca9953320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcab2764b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcab276630>]}
[0m12:03:57.658323 [debug] [MainThread]: Flushing usage events
[0m12:05:26.671109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb391f1280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb39547290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb39243d40>]}


============================== 12:05:26.689096 | 2de82a1e-1549-4fa1-908f-b8cf48b384d2 ==============================
[0m12:05:26.689096 [info ] [MainThread]: Running with dbt=1.7.0
[0m12:05:26.693212 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/dbt/retail_project/retail_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /root/.dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:05:26.940622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2de82a1e-1549-4fa1-908f-b8cf48b384d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb3ab64a40>]}
[0m12:05:27.067806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2de82a1e-1549-4fa1-908f-b8cf48b384d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb399a6840>]}
[0m12:05:27.068604 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m12:05:27.080382 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m12:05:27.119562 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:05:27.120231 [debug] [MainThread]: Partial parsing: updated file: retail_project://models/staging/stg_sales_transaction.sql
[0m12:05:27.300019 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail_project.intermediate
[0m12:05:27.306837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2de82a1e-1549-4fa1-908f-b8cf48b384d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb3794acc0>]}
[0m12:05:27.320662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2de82a1e-1549-4fa1-908f-b8cf48b384d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb3818c7a0>]}
[0m12:05:27.321976 [info ] [MainThread]: Found 8 models, 4 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:05:27.322790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2de82a1e-1549-4fa1-908f-b8cf48b384d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb3912fef0>]}
[0m12:05:27.325244 [info ] [MainThread]: 
[0m12:05:27.327287 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:05:27.329350 [debug] [ThreadPool]: Acquiring new postgres connection 'list_retail_dwh'
[0m12:05:27.347817 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh"
[0m12:05:27.349051 [debug] [ThreadPool]: On list_retail_dwh: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh"} */

    select distinct nspname from pg_namespace
  
[0m12:05:27.350136 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:27.351485 [debug] [ThreadPool]: Acquiring new postgres connection 'list_retail_dwh'
[0m12:05:27.358439 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh"
[0m12:05:27.358922 [debug] [ThreadPool]: On list_retail_dwh: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh"} */

    select distinct nspname from pg_namespace
  
[0m12:05:27.359222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:27.369144 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m12:05:27.371727 [debug] [ThreadPool]: On list_retail_dwh: Close
[0m12:05:27.375872 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m12:05:27.378172 [debug] [ThreadPool]: On list_retail_dwh: Close
[0m12:05:27.386384 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_dwh, now list_retail_dwh_marts_staging)
[0m12:05:27.394098 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_dwh, now list_retail_dwh_marts_marts)
[0m12:05:27.454899 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_marts"
[0m12:05:27.456767 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: BEGIN
[0m12:05:27.457453 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:05:27.459295 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_staging"
[0m12:05:27.459716 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: BEGIN
[0m12:05:27.460143 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:05:27.495480 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:05:27.495906 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_staging"
[0m12:05:27.496507 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh_marts_staging"} */
select
      'retail_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'retail_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'retail_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m12:05:27.497043 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:05:27.497506 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_marts"
[0m12:05:27.498018 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh_marts_marts"} */
select
      'retail_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'retail_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'retail_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m12:05:27.500281 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:05:27.502142 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: ROLLBACK
[0m12:05:27.502745 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m12:05:27.504361 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: ROLLBACK
[0m12:05:27.504956 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: Close
[0m12:05:27.509158 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: Close
[0m12:05:27.518870 [debug] [MainThread]: Using postgres connection "master"
[0m12:05:27.519266 [debug] [MainThread]: On master: BEGIN
[0m12:05:27.519663 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:05:27.534269 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:05:27.534783 [debug] [MainThread]: Using postgres connection "master"
[0m12:05:27.535169 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:05:27.571980 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m12:05:27.574840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2de82a1e-1549-4fa1-908f-b8cf48b384d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb3818ee40>]}
[0m12:05:27.575340 [debug] [MainThread]: On master: ROLLBACK
[0m12:05:27.577714 [debug] [MainThread]: Using postgres connection "master"
[0m12:05:27.578144 [debug] [MainThread]: On master: BEGIN
[0m12:05:27.579822 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:05:27.580264 [debug] [MainThread]: On master: COMMIT
[0m12:05:27.580557 [debug] [MainThread]: Using postgres connection "master"
[0m12:05:27.580834 [debug] [MainThread]: On master: COMMIT
[0m12:05:27.581905 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:05:27.582322 [debug] [MainThread]: On master: Close
[0m12:05:27.584240 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:05:27.585262 [info ] [MainThread]: 
[0m12:05:27.595336 [debug] [Thread-1 (]: Began running node model.retail_project.stg_customers
[0m12:05:27.596845 [debug] [Thread-2 (]: Began running node model.retail_project.stg_products
[0m12:05:27.597660 [info ] [Thread-1 (]: 1 of 8 START sql view model marts_staging.stg_customers ........................ [RUN]
[0m12:05:27.599383 [debug] [Thread-3 (]: Began running node model.retail_project.stg_sales_transaction
[0m12:05:27.600972 [info ] [Thread-2 (]: 2 of 8 START sql view model marts_staging.stg_products ......................... [RUN]
[0m12:05:27.602121 [debug] [Thread-4 (]: Began running node model.retail_project.stg_stores
[0m12:05:27.603589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail_dwh_marts_marts, now model.retail_project.stg_customers)
[0m12:05:27.610496 [debug] [Thread-1 (]: Began compiling node model.retail_project.stg_customers
[0m12:05:27.605146 [info ] [Thread-3 (]: 3 of 8 START sql view model marts_staging.stg_sales_transaction ................ [RUN]
[0m12:05:27.609088 [info ] [Thread-4 (]: 4 of 8 START sql view model marts_staging.stg_stores ........................... [RUN]
[0m12:05:27.607301 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_retail_dwh_marts_staging, now model.retail_project.stg_products)
[0m12:05:27.620142 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_project.stg_customers"
[0m12:05:27.622094 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.retail_project.stg_sales_transaction'
[0m12:05:27.624183 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.retail_project.stg_stores'
[0m12:05:27.628205 [debug] [Thread-4 (]: Began compiling node model.retail_project.stg_stores
[0m12:05:27.625464 [debug] [Thread-2 (]: Began compiling node model.retail_project.stg_products
[0m12:05:27.627115 [debug] [Thread-3 (]: Began compiling node model.retail_project.stg_sales_transaction
[0m12:05:27.631806 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_project.stg_stores"
[0m12:05:27.633149 [debug] [Thread-1 (]: Timing info for model.retail_project.stg_customers (compile): 12:05:27.611469 => 12:05:27.632865
[0m12:05:27.636834 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_project.stg_products"
[0m12:05:27.640490 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_project.stg_sales_transaction"
[0m12:05:27.642959 [debug] [Thread-1 (]: Began executing node model.retail_project.stg_customers
[0m12:05:27.645100 [debug] [Thread-4 (]: Timing info for model.retail_project.stg_stores (compile): 12:05:27.628958 => 12:05:27.644006
[0m12:05:27.672107 [debug] [Thread-4 (]: Began executing node model.retail_project.stg_stores
[0m12:05:27.674307 [debug] [Thread-3 (]: Timing info for model.retail_project.stg_sales_transaction (compile): 12:05:27.637601 => 12:05:27.673674
[0m12:05:27.686926 [debug] [Thread-3 (]: Began executing node model.retail_project.stg_sales_transaction
[0m12:05:27.703665 [debug] [Thread-2 (]: Timing info for model.retail_project.stg_products (compile): 12:05:27.633743 => 12:05:27.702913
[0m12:05:27.719006 [debug] [Thread-2 (]: Began executing node model.retail_project.stg_products
[0m12:05:27.731629 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_project.stg_products"
[0m12:05:27.734807 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_project.stg_stores"
[0m12:05:27.742081 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_project.stg_sales_transaction"
[0m12:05:27.748095 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_project.stg_customers"
[0m12:05:27.752884 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:05:27.754168 [debug] [Thread-2 (]: On model.retail_project.stg_products: BEGIN
[0m12:05:27.756021 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:05:27.759296 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:05:27.760974 [debug] [Thread-1 (]: On model.retail_project.stg_customers: BEGIN
[0m12:05:27.761990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:27.763418 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m12:05:27.764034 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: BEGIN
[0m12:05:27.764552 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:05:27.765637 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:05:27.766206 [debug] [Thread-4 (]: On model.retail_project.stg_stores: BEGIN
[0m12:05:27.766719 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:05:27.770837 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:05:27.771593 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:05:27.772170 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */

  create view "retail_dwh"."marts_staging"."stg_products__dbt_tmp"
    
    
  as (
    SELECT
    product_id,
    product_name,
    TRIM(category) AS product_category,
    TRIM(sub_category) AS product_sub_category,
    CAST(price AS NUMERIC) AS product_price
FROM
    "retail_dwh"."raw"."products_raw"
  );
[0m12:05:27.774061 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:05:27.775019 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:05:27.777339 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */

  create view "retail_dwh"."marts_staging"."stg_customers__dbt_tmp"
    
    
  as (
    SELECT
    customer_id,
    customer_name,
    UPPER(TRIM(gender)) AS customer_gender,
    TRIM(city) AS customer_city,
    CAST(signup_date AS DATE) AS customer_signup_date
FROM
    "retail_dwh"."raw"."customers_raw"
  );
[0m12:05:27.778996 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:05:27.789296 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:05:27.807769 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:05:27.810060 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
alter table "retail_dwh"."marts_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m12:05:27.812555 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:05:27.813977 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m12:05:27.816010 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:05:27.814907 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:05:27.816999 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:05:27.817928 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */

  create view "retail_dwh"."marts_staging"."stg_sales_transaction__dbt_tmp"
    
    
  as (
    with source as (
    select
        transaction_id,
        customer_id,
        product_id,
        store_id,
        transaction_date,
        quantity,
        unit_price,
        payment_method
    from "retail_dwh"."raw"."sales_transaction_raw"
),

typed as (
    select
        transaction_id,
        customer_id,
        product_id,
        store_id,
        transaction_date::date      as transaction_date,
        quantity::integer           as quantity,
        unit_price::numeric(18,2)   as unit_price,
        payment_method
    from source
)

select * from typed
  );
[0m12:05:27.818736 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:05:27.822675 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:05:27.824595 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
alter table "retail_dwh"."marts_staging"."stg_products" rename to "stg_products__dbt_backup"
[0m12:05:27.830274 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "unit_price" does not exist
LINE 15:         unit_price,
                 ^

[0m12:05:27.828728 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
alter table "retail_dwh"."marts_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m12:05:27.831629 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: ROLLBACK
[0m12:05:27.826935 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */

  create view "retail_dwh"."marts_staging"."stg_stores__dbt_tmp"
    
    
  as (
    with source as (
    select
        store_id,
        store_name,
        city,
        region
    from "retail_dwh"."raw"."stores_raw"
),

renamed as (
    select
        store_id,
        store_name,
        city,
        region as store_region
    from source
)

select * from renamed
  );
[0m12:05:27.834396 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:05:27.832863 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:05:27.843533 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:05:27.842156 [debug] [Thread-3 (]: Timing info for model.retail_project.stg_sales_transaction (execute): 12:05:27.687657 => 12:05:27.841808
[0m12:05:27.847984 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:05:27.863721 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:05:27.874087 [debug] [Thread-1 (]: On model.retail_project.stg_customers: COMMIT
[0m12:05:27.878275 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: Close
[0m12:05:27.879812 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
alter table "retail_dwh"."marts_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m12:05:27.880939 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
alter table "retail_dwh"."marts_staging"."stg_stores" rename to "stg_stores__dbt_backup"
[0m12:05:27.882104 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:05:27.889015 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:05:27.889942 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:05:27.891165 [debug] [Thread-1 (]: On model.retail_project.stg_customers: COMMIT
[0m12:05:27.895616 [debug] [Thread-2 (]: On model.retail_project.stg_products: COMMIT
[0m12:05:27.901729 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:05:27.908471 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
alter table "retail_dwh"."marts_staging"."stg_stores__dbt_tmp" rename to "stg_stores"
[0m12:05:27.906779 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:05:27.909936 [debug] [Thread-2 (]: On model.retail_project.stg_products: COMMIT
[0m12:05:27.904923 [debug] [Thread-3 (]: Database Error in model stg_sales_transaction (models/staging/stg_sales_transaction.sql)
  column "unit_price" does not exist
  LINE 15:         unit_price,
                   ^
  compiled Code at target/run/retail_project/models/staging/stg_sales_transaction.sql
[0m12:05:27.912513 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2de82a1e-1549-4fa1-908f-b8cf48b384d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb379fee70>]}
[0m12:05:27.914966 [error] [Thread-3 (]: 3 of 8 ERROR creating sql view model marts_staging.stg_sales_transaction ....... [[31mERROR[0m in 0.29s]
[0m12:05:27.917058 [debug] [Thread-3 (]: Finished running node model.retail_project.stg_sales_transaction
[0m12:05:27.917895 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:05:27.918446 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:05:27.931956 [debug] [Thread-2 (]: Applying DROP to: "retail_dwh"."marts_staging"."stg_products__dbt_backup"
[0m12:05:27.922856 [debug] [Thread-4 (]: On model.retail_project.stg_stores: COMMIT
[0m12:05:27.919208 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:05:27.940123 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:05:27.942346 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:05:27.946800 [debug] [Thread-1 (]: Applying DROP to: "retail_dwh"."marts_staging"."stg_customers__dbt_backup"
[0m12:05:27.949226 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
drop view if exists "retail_dwh"."marts_staging"."stg_products__dbt_backup" cascade
[0m12:05:27.950721 [debug] [Thread-4 (]: On model.retail_project.stg_stores: COMMIT
[0m12:05:27.952361 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:05:27.955068 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
drop view if exists "retail_dwh"."marts_staging"."stg_customers__dbt_backup" cascade
[0m12:05:27.957742 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m12:05:27.964522 [debug] [Thread-4 (]: Applying DROP to: "retail_dwh"."marts_staging"."stg_stores__dbt_backup"
[0m12:05:27.965695 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:05:27.967822 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:05:27.970596 [debug] [Thread-2 (]: Timing info for model.retail_project.stg_products (execute): 12:05:27.720129 => 12:05:27.970347
[0m12:05:27.972005 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:05:27.972975 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
drop view if exists "retail_dwh"."marts_staging"."stg_stores__dbt_backup" cascade
[0m12:05:27.974998 [debug] [Thread-2 (]: On model.retail_project.stg_products: Close
[0m12:05:27.977685 [debug] [Thread-1 (]: Timing info for model.retail_project.stg_customers (execute): 12:05:27.646396 => 12:05:27.977443
[0m12:05:27.982817 [debug] [Thread-1 (]: On model.retail_project.stg_customers: Close
[0m12:05:27.987164 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2de82a1e-1549-4fa1-908f-b8cf48b384d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb379fff80>]}
[0m12:05:27.988444 [info ] [Thread-2 (]: 2 of 8 OK created sql view model marts_staging.stg_products .................... [[32mCREATE VIEW[0m in 0.38s]
[0m12:05:27.992016 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2de82a1e-1549-4fa1-908f-b8cf48b384d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb379e41d0>]}
[0m12:05:27.995125 [info ] [Thread-1 (]: 1 of 8 OK created sql view model marts_staging.stg_customers ................... [[32mCREATE VIEW[0m in 0.39s]
[0m12:05:27.993805 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:05:27.992654 [debug] [Thread-2 (]: Finished running node model.retail_project.stg_products
[0m12:05:27.996568 [debug] [Thread-1 (]: Finished running node model.retail_project.stg_customers
[0m12:05:27.998929 [debug] [Thread-4 (]: Timing info for model.retail_project.stg_stores (execute): 12:05:27.675899 => 12:05:27.998697
[0m12:05:28.001016 [debug] [Thread-4 (]: On model.retail_project.stg_stores: Close
[0m12:05:28.002874 [debug] [Thread-3 (]: Began running node model.retail_project.dim_customer
[0m12:05:28.003827 [info ] [Thread-3 (]: 5 of 8 START sql view model marts_marts.dim_customer ........................... [RUN]
[0m12:05:28.006515 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_sales_transaction, now model.retail_project.dim_customer)
[0m12:05:28.007403 [debug] [Thread-3 (]: Began compiling node model.retail_project.dim_customer
[0m12:05:28.015156 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2de82a1e-1549-4fa1-908f-b8cf48b384d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb371714c0>]}
[0m12:05:28.016437 [debug] [Thread-2 (]: Began running node model.retail_project.dim_product
[0m12:05:28.018696 [info ] [Thread-4 (]: 4 of 8 OK created sql view model marts_staging.stg_stores ...................... [[32mCREATE VIEW[0m in 0.39s]
[0m12:05:28.020235 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_project.dim_customer"
[0m12:05:28.021138 [info ] [Thread-2 (]: 6 of 8 START sql view model marts_marts.dim_product ............................ [RUN]
[0m12:05:28.023849 [debug] [Thread-4 (]: Finished running node model.retail_project.stg_stores
[0m12:05:28.025365 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_products, now model.retail_project.dim_product)
[0m12:05:28.027956 [debug] [Thread-1 (]: Began running node model.retail_project.dim_store
[0m12:05:28.029317 [debug] [Thread-2 (]: Began compiling node model.retail_project.dim_product
[0m12:05:28.030962 [info ] [Thread-1 (]: 7 of 8 START sql view model marts_marts.dim_store .............................. [RUN]
[0m12:05:28.032316 [debug] [Thread-3 (]: Timing info for model.retail_project.dim_customer (compile): 12:05:28.007779 => 12:05:28.031912
[0m12:05:28.036345 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_project.dim_product"
[0m12:05:28.037491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_customers, now model.retail_project.dim_store)
[0m12:05:28.038676 [debug] [Thread-3 (]: Began executing node model.retail_project.dim_customer
[0m12:05:28.041268 [debug] [Thread-1 (]: Began compiling node model.retail_project.dim_store
[0m12:05:28.049590 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_project.dim_customer"
[0m12:05:28.050738 [debug] [Thread-2 (]: Timing info for model.retail_project.dim_product (compile): 12:05:28.032968 => 12:05:28.050471
[0m12:05:28.054522 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_project.dim_store"
[0m12:05:28.056655 [debug] [Thread-2 (]: Began executing node model.retail_project.dim_product
[0m12:05:28.058444 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:05:28.065544 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_project.dim_product"
[0m12:05:28.068776 [debug] [Thread-3 (]: On model.retail_project.dim_customer: BEGIN
[0m12:05:28.070083 [debug] [Thread-1 (]: Timing info for model.retail_project.dim_store (compile): 12:05:28.051458 => 12:05:28.069589
[0m12:05:28.074232 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:05:28.076144 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:05:28.078230 [debug] [Thread-1 (]: Began executing node model.retail_project.dim_store
[0m12:05:28.080055 [debug] [Thread-2 (]: On model.retail_project.dim_product: BEGIN
[0m12:05:28.089031 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_project.dim_store"
[0m12:05:28.091082 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:05:28.094900 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:05:28.095472 [debug] [Thread-1 (]: On model.retail_project.dim_store: BEGIN
[0m12:05:28.095859 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:28.104258 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:05:28.104790 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:05:28.105149 [debug] [Thread-3 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */

  create view "retail_dwh"."marts_marts"."dim_customer__dbt_tmp"
    
    
  as (
    SELECT
    customer_id,
    customer_name,
    customer_gender,
    customer_city,
    customer_signup_date
FROM
    "retail_dwh"."marts_staging"."stg_customers"
  );
[0m12:05:28.110059 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:05:28.113801 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:05:28.115295 [debug] [Thread-2 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */

  create view "retail_dwh"."marts_marts"."dim_product__dbt_tmp"
    
    
  as (
    SELECT
    product_id,
    product_name,
    product_category,
    product_sub_category,
    product_price
FROM
    "retail_dwh"."marts_staging"."stg_products"
  );
[0m12:05:28.117753 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:05:28.119248 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:05:28.120286 [debug] [Thread-1 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */

  create view "retail_dwh"."marts_marts"."dim_store__dbt_tmp"
    
    
  as (
    select
    store_id,
    store_name,
    city as store_city,
    store_region
from "retail_dwh"."marts_staging"."stg_stores"
  );
[0m12:05:28.120926 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:05:28.122059 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:05:28.127620 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:05:28.131881 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:05:28.134353 [debug] [Thread-2 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */
alter table "retail_dwh"."marts_marts"."dim_product__dbt_tmp" rename to "dim_product"
[0m12:05:28.133679 [debug] [Thread-3 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */
alter table "retail_dwh"."marts_marts"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m12:05:28.132571 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:05:28.143103 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:05:28.146363 [debug] [Thread-3 (]: On model.retail_project.dim_customer: COMMIT
[0m12:05:28.148776 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:05:28.149647 [debug] [Thread-3 (]: On model.retail_project.dim_customer: COMMIT
[0m12:05:28.150810 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:05:28.151742 [debug] [Thread-1 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */
alter table "retail_dwh"."marts_marts"."dim_store__dbt_tmp" rename to "dim_store"
[0m12:05:28.152975 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:05:28.155620 [debug] [Thread-2 (]: On model.retail_project.dim_product: COMMIT
[0m12:05:28.156873 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:05:28.158929 [debug] [Thread-2 (]: On model.retail_project.dim_product: COMMIT
[0m12:05:28.160238 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:05:28.163788 [debug] [Thread-1 (]: On model.retail_project.dim_store: COMMIT
[0m12:05:28.165189 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:05:28.166970 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m12:05:28.167915 [debug] [Thread-1 (]: On model.retail_project.dim_store: COMMIT
[0m12:05:28.169333 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:05:28.172841 [debug] [Thread-3 (]: Applying DROP to: "retail_dwh"."marts_marts"."dim_customer__dbt_backup"
[0m12:05:28.178586 [debug] [Thread-2 (]: Applying DROP to: "retail_dwh"."marts_marts"."dim_product__dbt_backup"
[0m12:05:28.181085 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:05:28.182156 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:05:28.184516 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:05:28.186051 [debug] [Thread-3 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */
drop view if exists "retail_dwh"."marts_marts"."dim_customer__dbt_backup" cascade
[0m12:05:28.191316 [debug] [Thread-1 (]: Applying DROP to: "retail_dwh"."marts_marts"."dim_store__dbt_backup"
[0m12:05:28.192812 [debug] [Thread-2 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */
drop view if exists "retail_dwh"."marts_marts"."dim_product__dbt_backup" cascade
[0m12:05:28.195621 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:05:28.196742 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:05:28.199012 [debug] [Thread-1 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */
drop view if exists "retail_dwh"."marts_marts"."dim_store__dbt_backup" cascade
[0m12:05:28.201549 [debug] [Thread-3 (]: Timing info for model.retail_project.dim_customer (execute): 12:05:28.043977 => 12:05:28.201311
[0m12:05:28.202650 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:05:28.204079 [debug] [Thread-3 (]: On model.retail_project.dim_customer: Close
[0m12:05:28.206890 [debug] [Thread-2 (]: Timing info for model.retail_project.dim_product (execute): 12:05:28.059554 => 12:05:28.206643
[0m12:05:28.208567 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:05:28.210702 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2de82a1e-1549-4fa1-908f-b8cf48b384d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb37588590>]}
[0m12:05:28.216367 [info ] [Thread-3 (]: 5 of 8 OK created sql view model marts_marts.dim_customer ...................... [[32mCREATE VIEW[0m in 0.20s]
[0m12:05:28.215207 [debug] [Thread-1 (]: Timing info for model.retail_project.dim_store (execute): 12:05:28.081969 => 12:05:28.214719
[0m12:05:28.212140 [debug] [Thread-2 (]: On model.retail_project.dim_product: Close
[0m12:05:28.218017 [debug] [Thread-3 (]: Finished running node model.retail_project.dim_customer
[0m12:05:28.219305 [debug] [Thread-1 (]: On model.retail_project.dim_store: Close
[0m12:05:28.220592 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2de82a1e-1549-4fa1-908f-b8cf48b384d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb3714b320>]}
[0m12:05:28.223465 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2de82a1e-1549-4fa1-908f-b8cf48b384d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb3714b920>]}
[0m12:05:28.226199 [info ] [Thread-2 (]: 6 of 8 OK created sql view model marts_marts.dim_product ....................... [[32mCREATE VIEW[0m in 0.20s]
[0m12:05:28.228377 [info ] [Thread-1 (]: 7 of 8 OK created sql view model marts_marts.dim_store ......................... [[32mCREATE VIEW[0m in 0.19s]
[0m12:05:28.230265 [debug] [Thread-2 (]: Finished running node model.retail_project.dim_product
[0m12:05:28.231416 [debug] [Thread-1 (]: Finished running node model.retail_project.dim_store
[0m12:05:28.233792 [debug] [Thread-4 (]: Began running node model.retail_project.fact_sales
[0m12:05:28.234452 [info ] [Thread-4 (]: 8 of 8 SKIP relation marts_marts.fact_sales .................................... [[33mSKIP[0m]
[0m12:05:28.236726 [debug] [Thread-4 (]: Finished running node model.retail_project.fact_sales
[0m12:05:28.243427 [debug] [MainThread]: Using postgres connection "master"
[0m12:05:28.243841 [debug] [MainThread]: On master: BEGIN
[0m12:05:28.244126 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:05:28.258485 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:05:28.259540 [debug] [MainThread]: On master: COMMIT
[0m12:05:28.259881 [debug] [MainThread]: Using postgres connection "master"
[0m12:05:28.260683 [debug] [MainThread]: On master: COMMIT
[0m12:05:28.261874 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:05:28.262261 [debug] [MainThread]: On master: Close
[0m12:05:28.263383 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:05:28.263728 [debug] [MainThread]: Connection 'model.retail_project.dim_store' was properly closed.
[0m12:05:28.264061 [debug] [MainThread]: Connection 'model.retail_project.dim_product' was properly closed.
[0m12:05:28.264332 [debug] [MainThread]: Connection 'model.retail_project.dim_customer' was properly closed.
[0m12:05:28.264584 [debug] [MainThread]: Connection 'model.retail_project.stg_stores' was properly closed.
[0m12:05:28.265785 [info ] [MainThread]: 
[0m12:05:28.266195 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m12:05:28.269236 [debug] [MainThread]: Command end result
[0m12:05:28.283014 [info ] [MainThread]: 
[0m12:05:28.284038 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:05:28.284458 [info ] [MainThread]: 
[0m12:05:28.285159 [error] [MainThread]:   Database Error in model stg_sales_transaction (models/staging/stg_sales_transaction.sql)
  column "unit_price" does not exist
  LINE 15:         unit_price,
                   ^
  compiled Code at target/run/retail_project/models/staging/stg_sales_transaction.sql
[0m12:05:28.285686 [info ] [MainThread]: 
[0m12:05:28.286231 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=1 TOTAL=8
[0m12:05:28.287496 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.667609, "process_user_time": 3.789853, "process_kernel_time": 0.782557, "process_mem_max_rss": "151452", "process_out_blocks": "2616", "command_success": false, "process_in_blocks": "0"}
[0m12:05:28.287962 [debug] [MainThread]: Command `dbt run` failed at 12:05:28.287836 after 1.67 seconds
[0m12:05:28.288358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb39547290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb3912fef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb391f1640>]}
[0m12:05:28.288747 [debug] [MainThread]: Flushing usage events
[0m12:06:53.757847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd298494c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd29bbbd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd2c016150>]}


============================== 12:06:53.761046 | 84d8a62e-722a-40bb-aed9-0bb7f5ed1ecd ==============================
[0m12:06:53.761046 [info ] [MainThread]: Running with dbt=1.7.0
[0m12:06:53.762191 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/dbt/retail_project/retail_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /root/.dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:06:54.027265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84d8a62e-722a-40bb-aed9-0bb7f5ed1ecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd29ab4ef0>]}
[0m12:06:54.167766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84d8a62e-722a-40bb-aed9-0bb7f5ed1ecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd298cf140>]}
[0m12:06:54.170238 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m12:06:54.187639 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m12:06:54.217653 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:06:54.218294 [debug] [MainThread]: Partial parsing: updated file: retail_project://models/staging/stg_sales_transaction.sql
[0m12:06:54.425217 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail_project.intermediate
[0m12:06:54.433449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84d8a62e-722a-40bb-aed9-0bb7f5ed1ecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd28983740>]}
[0m12:06:54.451014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84d8a62e-722a-40bb-aed9-0bb7f5ed1ecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd28510ad0>]}
[0m12:06:54.451610 [info ] [MainThread]: Found 8 models, 4 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:06:54.453086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84d8a62e-722a-40bb-aed9-0bb7f5ed1ecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd281cf020>]}
[0m12:06:54.455859 [info ] [MainThread]: 
[0m12:06:54.458102 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:06:54.460322 [debug] [ThreadPool]: Acquiring new postgres connection 'list_retail_dwh'
[0m12:06:54.471665 [debug] [ThreadPool]: Acquiring new postgres connection 'list_retail_dwh'
[0m12:06:54.487887 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh"
[0m12:06:54.495430 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh"
[0m12:06:54.496895 [debug] [ThreadPool]: On list_retail_dwh: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh"} */

    select distinct nspname from pg_namespace
  
[0m12:06:54.498373 [debug] [ThreadPool]: On list_retail_dwh: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh"} */

    select distinct nspname from pg_namespace
  
[0m12:06:54.499144 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:06:54.500366 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:06:54.519220 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m12:06:54.521803 [debug] [ThreadPool]: On list_retail_dwh: Close
[0m12:06:54.522510 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m12:06:54.526202 [debug] [ThreadPool]: On list_retail_dwh: Close
[0m12:06:54.531946 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_dwh, now list_retail_dwh_marts_staging)
[0m12:06:54.543407 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_staging"
[0m12:06:54.544608 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: BEGIN
[0m12:06:54.545245 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:06:54.547408 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_dwh, now list_retail_dwh_marts_marts)
[0m12:06:54.612815 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_marts"
[0m12:06:54.619943 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: BEGIN
[0m12:06:54.624186 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:06:54.625778 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:06:54.626352 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_staging"
[0m12:06:54.627372 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh_marts_staging"} */
select
      'retail_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'retail_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'retail_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m12:06:54.633724 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:06:54.635907 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: ROLLBACK
[0m12:06:54.638143 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: Close
[0m12:06:54.642844 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:06:54.643237 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_marts"
[0m12:06:54.643634 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh_marts_marts"} */
select
      'retail_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'retail_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'retail_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m12:06:54.648173 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m12:06:54.649905 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: ROLLBACK
[0m12:06:54.651998 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: Close
[0m12:06:54.661908 [debug] [MainThread]: Using postgres connection "master"
[0m12:06:54.662382 [debug] [MainThread]: On master: BEGIN
[0m12:06:54.662687 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:06:54.680982 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:06:54.681518 [debug] [MainThread]: Using postgres connection "master"
[0m12:06:54.681922 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:06:54.721531 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m12:06:54.724514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84d8a62e-722a-40bb-aed9-0bb7f5ed1ecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd2a83b0e0>]}
[0m12:06:54.725005 [debug] [MainThread]: On master: ROLLBACK
[0m12:06:54.727274 [debug] [MainThread]: Using postgres connection "master"
[0m12:06:54.727740 [debug] [MainThread]: On master: BEGIN
[0m12:06:54.729802 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:06:54.730319 [debug] [MainThread]: On master: COMMIT
[0m12:06:54.730666 [debug] [MainThread]: Using postgres connection "master"
[0m12:06:54.730971 [debug] [MainThread]: On master: COMMIT
[0m12:06:54.731908 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:06:54.732258 [debug] [MainThread]: On master: Close
[0m12:06:54.733897 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:06:54.734981 [info ] [MainThread]: 
[0m12:06:54.745115 [debug] [Thread-1 (]: Began running node model.retail_project.stg_customers
[0m12:06:54.746196 [debug] [Thread-2 (]: Began running node model.retail_project.stg_products
[0m12:06:54.747198 [info ] [Thread-1 (]: 1 of 8 START sql view model marts_staging.stg_customers ........................ [RUN]
[0m12:06:54.748849 [info ] [Thread-2 (]: 2 of 8 START sql view model marts_staging.stg_products ......................... [RUN]
[0m12:06:54.750744 [debug] [Thread-3 (]: Began running node model.retail_project.stg_sales_transaction
[0m12:06:54.752903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail_dwh_marts_marts, now model.retail_project.stg_customers)
[0m12:06:54.755129 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_retail_dwh_marts_staging, now model.retail_project.stg_products)
[0m12:06:54.754104 [debug] [Thread-4 (]: Began running node model.retail_project.stg_stores
[0m12:06:54.756758 [info ] [Thread-3 (]: 3 of 8 START sql view model marts_staging.stg_sales_transaction ................ [RUN]
[0m12:06:54.758105 [debug] [Thread-1 (]: Began compiling node model.retail_project.stg_customers
[0m12:06:54.759905 [info ] [Thread-4 (]: 4 of 8 START sql view model marts_staging.stg_stores ........................... [RUN]
[0m12:06:54.758923 [debug] [Thread-2 (]: Began compiling node model.retail_project.stg_products
[0m12:06:54.761493 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.retail_project.stg_sales_transaction'
[0m12:06:54.772114 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_project.stg_customers"
[0m12:06:54.773819 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.retail_project.stg_stores'
[0m12:06:54.777396 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_project.stg_products"
[0m12:06:54.779159 [debug] [Thread-3 (]: Began compiling node model.retail_project.stg_sales_transaction
[0m12:06:54.780961 [debug] [Thread-4 (]: Began compiling node model.retail_project.stg_stores
[0m12:06:54.782190 [debug] [Thread-1 (]: Timing info for model.retail_project.stg_customers (compile): 12:06:54.762570 => 12:06:54.781896
[0m12:06:54.786979 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_project.stg_sales_transaction"
[0m12:06:54.792370 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_project.stg_stores"
[0m12:06:54.793525 [debug] [Thread-2 (]: Timing info for model.retail_project.stg_products (compile): 12:06:54.774525 => 12:06:54.793239
[0m12:06:54.795892 [debug] [Thread-1 (]: Began executing node model.retail_project.stg_customers
[0m12:06:54.797900 [debug] [Thread-2 (]: Began executing node model.retail_project.stg_products
[0m12:06:54.825050 [debug] [Thread-3 (]: Timing info for model.retail_project.stg_sales_transaction (compile): 12:06:54.782957 => 12:06:54.824400
[0m12:06:54.846825 [debug] [Thread-3 (]: Began executing node model.retail_project.stg_sales_transaction
[0m12:06:54.881809 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_project.stg_products"
[0m12:06:54.883504 [debug] [Thread-4 (]: Timing info for model.retail_project.stg_stores (compile): 12:06:54.788899 => 12:06:54.883047
[0m12:06:54.889861 [debug] [Thread-4 (]: Began executing node model.retail_project.stg_stores
[0m12:06:54.895958 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_project.stg_stores"
[0m12:06:54.898777 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_project.stg_sales_transaction"
[0m12:06:54.901572 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_project.stg_customers"
[0m12:06:54.904964 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:06:54.907047 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:06:54.908169 [debug] [Thread-4 (]: On model.retail_project.stg_stores: BEGIN
[0m12:06:54.909868 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:06:54.911542 [debug] [Thread-2 (]: On model.retail_project.stg_products: BEGIN
[0m12:06:54.912217 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m12:06:54.913399 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:06:54.914422 [debug] [Thread-1 (]: On model.retail_project.stg_customers: BEGIN
[0m12:06:54.915833 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:06:54.916891 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: BEGIN
[0m12:06:54.919359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:06:54.921431 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:06:54.940735 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:06:54.941876 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:06:54.942832 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */

  create view "retail_dwh"."marts_staging"."stg_stores__dbt_tmp"
    
    
  as (
    with source as (
    select
        store_id,
        store_name,
        city,
        region
    from "retail_dwh"."raw"."stores_raw"
),

renamed as (
    select
        store_id,
        store_name,
        city,
        region as store_region
    from source
)

select * from renamed
  );
[0m12:06:54.945047 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:06:54.945788 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:06:54.946784 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */

  create view "retail_dwh"."marts_staging"."stg_customers__dbt_tmp"
    
    
  as (
    SELECT
    customer_id,
    customer_name,
    UPPER(TRIM(gender)) AS customer_gender,
    TRIM(city) AS customer_city,
    CAST(signup_date AS DATE) AS customer_signup_date
FROM
    "retail_dwh"."raw"."customers_raw"
  );
[0m12:06:54.951124 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:06:54.953398 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:06:54.976786 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:06:54.974566 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:06:54.979351 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:06:54.981500 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:06:54.983271 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
alter table "retail_dwh"."marts_staging"."stg_stores" rename to "stg_stores__dbt_backup"
[0m12:06:54.984904 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:06:54.986423 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */

  create view "retail_dwh"."marts_staging"."stg_products__dbt_tmp"
    
    
  as (
    SELECT
    product_id,
    product_name,
    TRIM(category) AS product_category,
    TRIM(sub_category) AS product_sub_category,
    CAST(price AS NUMERIC) AS product_price
FROM
    "retail_dwh"."raw"."products_raw"
  );
[0m12:06:54.987931 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
alter table "retail_dwh"."marts_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m12:06:54.990123 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m12:06:54.993257 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */

  create view "retail_dwh"."marts_staging"."stg_sales_transaction__dbt_tmp"
    
    
  as (
    with source as (
    select
        transaction_id,
        customer_id,
        product_id,
        store_id,
        transaction_date,
        quantity,
        unit_price,
        payment_method
    from "retail_dwh"."raw"."sales_transaction_raw"
),

typed as (
    select
        transaction_id,
        customer_id,
        product_id,
        store_id,
        transaction_date::date        as transaction_date,
        quantity::integer             as quantity,
        unit_price::numeric(18,2)     as unit_price,
        payment_method
    from source
)

select * from typed
  );
[0m12:06:54.994664 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:06:54.998721 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:06:55.000790 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
alter table "retail_dwh"."marts_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m12:06:55.003420 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "unit_price" does not exist
LINE 15:         unit_price,
                 ^

[0m12:06:55.005330 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: ROLLBACK
[0m12:06:55.007931 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:06:55.017013 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:06:55.019898 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:06:55.021489 [debug] [Thread-3 (]: Timing info for model.retail_project.stg_sales_transaction (execute): 12:06:54.866194 => 12:06:55.020900
[0m12:06:55.037878 [debug] [Thread-1 (]: On model.retail_project.stg_customers: COMMIT
[0m12:06:55.046284 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:06:55.052728 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:06:55.054223 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: Close
[0m12:06:55.055309 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:06:55.056349 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
alter table "retail_dwh"."marts_staging"."stg_products" rename to "stg_products__dbt_backup"
[0m12:06:55.057222 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
alter table "retail_dwh"."marts_staging"."stg_stores__dbt_tmp" rename to "stg_stores"
[0m12:06:55.061007 [debug] [Thread-1 (]: On model.retail_project.stg_customers: COMMIT
[0m12:06:55.063712 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:06:55.065706 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:06:55.073328 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:06:55.077574 [debug] [Thread-4 (]: On model.retail_project.stg_stores: COMMIT
[0m12:06:55.078813 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:06:55.081121 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
alter table "retail_dwh"."marts_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m12:06:55.082931 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:06:55.088261 [debug] [Thread-3 (]: Database Error in model stg_sales_transaction (models/staging/stg_sales_transaction.sql)
  column "unit_price" does not exist
  LINE 15:         unit_price,
                   ^
  compiled Code at target/run/retail_project/models/staging/stg_sales_transaction.sql
[0m12:06:55.096567 [debug] [Thread-4 (]: On model.retail_project.stg_stores: COMMIT
[0m12:06:55.097600 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:06:55.102566 [debug] [Thread-1 (]: Applying DROP to: "retail_dwh"."marts_staging"."stg_customers__dbt_backup"
[0m12:06:55.104104 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84d8a62e-722a-40bb-aed9-0bb7f5ed1ecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd2791f4a0>]}
[0m12:06:55.110106 [debug] [Thread-2 (]: On model.retail_project.stg_products: COMMIT
[0m12:06:55.110910 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m12:06:55.119680 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:06:55.121418 [error] [Thread-3 (]: 3 of 8 ERROR creating sql view model marts_staging.stg_sales_transaction ....... [[31mERROR[0m in 0.34s]
[0m12:06:55.124089 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:06:55.127395 [debug] [Thread-4 (]: Applying DROP to: "retail_dwh"."marts_staging"."stg_stores__dbt_backup"
[0m12:06:55.128336 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
drop view if exists "retail_dwh"."marts_staging"."stg_customers__dbt_backup" cascade
[0m12:06:55.130978 [debug] [Thread-3 (]: Finished running node model.retail_project.stg_sales_transaction
[0m12:06:55.132080 [debug] [Thread-2 (]: On model.retail_project.stg_products: COMMIT
[0m12:06:55.133721 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:06:55.140465 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
drop view if exists "retail_dwh"."marts_staging"."stg_stores__dbt_backup" cascade
[0m12:06:55.142737 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:06:55.146926 [debug] [Thread-1 (]: Timing info for model.retail_project.stg_customers (execute): 12:06:54.798857 => 12:06:55.146522
[0m12:06:55.148247 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:06:55.149155 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:06:55.150189 [debug] [Thread-1 (]: On model.retail_project.stg_customers: Close
[0m12:06:55.155055 [debug] [Thread-2 (]: Applying DROP to: "retail_dwh"."marts_staging"."stg_products__dbt_backup"
[0m12:06:55.158255 [debug] [Thread-4 (]: Timing info for model.retail_project.stg_stores (execute): 12:06:54.890931 => 12:06:55.158000
[0m12:06:55.160456 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:06:55.162890 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84d8a62e-722a-40bb-aed9-0bb7f5ed1ecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd2815c0b0>]}
[0m12:06:55.163995 [debug] [Thread-4 (]: On model.retail_project.stg_stores: Close
[0m12:06:55.165097 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
drop view if exists "retail_dwh"."marts_staging"."stg_products__dbt_backup" cascade
[0m12:06:55.166363 [info ] [Thread-1 (]: 1 of 8 OK created sql view model marts_staging.stg_customers ................... [[32mCREATE VIEW[0m in 0.41s]
[0m12:06:55.171361 [debug] [Thread-1 (]: Finished running node model.retail_project.stg_customers
[0m12:06:55.168491 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84d8a62e-722a-40bb-aed9-0bb7f5ed1ecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd27dcc890>]}
[0m12:06:55.174023 [debug] [Thread-3 (]: Began running node model.retail_project.dim_customer
[0m12:06:55.178328 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:06:55.179936 [info ] [Thread-4 (]: 4 of 8 OK created sql view model marts_staging.stg_stores ...................... [[32mCREATE VIEW[0m in 0.40s]
[0m12:06:55.181300 [info ] [Thread-3 (]: 5 of 8 START sql view model marts_marts.dim_customer ........................... [RUN]
[0m12:06:55.184420 [debug] [Thread-2 (]: Timing info for model.retail_project.stg_products (execute): 12:06:54.826850 => 12:06:55.184046
[0m12:06:55.191758 [debug] [Thread-2 (]: On model.retail_project.stg_products: Close
[0m12:06:55.190815 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_sales_transaction, now model.retail_project.dim_customer)
[0m12:06:55.188405 [debug] [Thread-4 (]: Finished running node model.retail_project.stg_stores
[0m12:06:55.192951 [debug] [Thread-3 (]: Began compiling node model.retail_project.dim_customer
[0m12:06:55.194428 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84d8a62e-722a-40bb-aed9-0bb7f5ed1ecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd29817740>]}
[0m12:06:55.201647 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_project.dim_customer"
[0m12:06:55.204140 [info ] [Thread-2 (]: 2 of 8 OK created sql view model marts_staging.stg_products .................... [[32mCREATE VIEW[0m in 0.44s]
[0m12:06:55.206923 [debug] [Thread-1 (]: Began running node model.retail_project.dim_store
[0m12:06:55.212434 [info ] [Thread-1 (]: 6 of 8 START sql view model marts_marts.dim_store .............................. [RUN]
[0m12:06:55.210806 [debug] [Thread-3 (]: Timing info for model.retail_project.dim_customer (compile): 12:06:55.195779 => 12:06:55.210498
[0m12:06:55.214413 [debug] [Thread-3 (]: Began executing node model.retail_project.dim_customer
[0m12:06:55.213654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_customers, now model.retail_project.dim_store)
[0m12:06:55.209946 [debug] [Thread-2 (]: Finished running node model.retail_project.stg_products
[0m12:06:55.221986 [debug] [Thread-1 (]: Began compiling node model.retail_project.dim_store
[0m12:06:55.224272 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_project.dim_customer"
[0m12:06:55.228462 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_project.dim_store"
[0m12:06:55.233164 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:06:55.235494 [debug] [Thread-4 (]: Began running node model.retail_project.dim_product
[0m12:06:55.238528 [debug] [Thread-3 (]: On model.retail_project.dim_customer: BEGIN
[0m12:06:55.240055 [info ] [Thread-4 (]: 7 of 8 START sql view model marts_marts.dim_product ............................ [RUN]
[0m12:06:55.241962 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:06:55.242896 [debug] [Thread-1 (]: Timing info for model.retail_project.dim_store (compile): 12:06:55.225380 => 12:06:55.242629
[0m12:06:55.244391 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_stores, now model.retail_project.dim_product)
[0m12:06:55.247283 [debug] [Thread-1 (]: Began executing node model.retail_project.dim_store
[0m12:06:55.249041 [debug] [Thread-4 (]: Began compiling node model.retail_project.dim_product
[0m12:06:55.255918 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_project.dim_store"
[0m12:06:55.260678 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_project.dim_product"
[0m12:06:55.265675 [debug] [Thread-4 (]: Timing info for model.retail_project.dim_product (compile): 12:06:55.257606 => 12:06:55.264194
[0m12:06:55.266770 [debug] [Thread-4 (]: Began executing node model.retail_project.dim_product
[0m12:06:55.273091 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_project.dim_product"
[0m12:06:55.274469 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:06:55.275041 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:06:55.276612 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:06:55.277992 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:06:55.279726 [debug] [Thread-1 (]: On model.retail_project.dim_store: BEGIN
[0m12:06:55.280792 [debug] [Thread-4 (]: On model.retail_project.dim_product: BEGIN
[0m12:06:55.281939 [debug] [Thread-3 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */

  create view "retail_dwh"."marts_marts"."dim_customer__dbt_tmp"
    
    
  as (
    SELECT
    customer_id,
    customer_name,
    customer_gender,
    customer_city,
    customer_signup_date
FROM
    "retail_dwh"."marts_staging"."stg_customers"
  );
[0m12:06:55.282998 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:06:55.284231 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:06:55.290020 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:06:55.296038 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:06:55.296675 [debug] [Thread-3 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */
alter table "retail_dwh"."marts_marts"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m12:06:55.300923 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:06:55.306050 [debug] [Thread-3 (]: On model.retail_project.dim_customer: COMMIT
[0m12:06:55.307888 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:06:55.309529 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:06:55.310922 [debug] [Thread-3 (]: On model.retail_project.dim_customer: COMMIT
[0m12:06:55.311882 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:06:55.312952 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:06:55.314649 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:06:55.316128 [debug] [Thread-4 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */

  create view "retail_dwh"."marts_marts"."dim_product__dbt_tmp"
    
    
  as (
    SELECT
    product_id,
    product_name,
    product_category,
    product_sub_category,
    product_price
FROM
    "retail_dwh"."marts_staging"."stg_products"
  );
[0m12:06:55.317381 [debug] [Thread-1 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */

  create view "retail_dwh"."marts_marts"."dim_store__dbt_tmp"
    
    
  as (
    select
    store_id,
    store_name,
    city as store_city,
    store_region
from "retail_dwh"."marts_staging"."stg_stores"
  );
[0m12:06:55.319580 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m12:06:55.325317 [debug] [Thread-3 (]: Applying DROP to: "retail_dwh"."marts_marts"."dim_customer__dbt_backup"
[0m12:06:55.328258 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:06:55.329569 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:06:55.330681 [debug] [Thread-3 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */
drop view if exists "retail_dwh"."marts_marts"."dim_customer__dbt_backup" cascade
[0m12:06:55.331906 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:06:55.336759 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:06:55.342678 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:06:55.344239 [debug] [Thread-1 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */
alter table "retail_dwh"."marts_marts"."dim_store__dbt_tmp" rename to "dim_store"
[0m12:06:55.345251 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:06:55.346940 [debug] [Thread-4 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */
alter table "retail_dwh"."marts_marts"."dim_product__dbt_tmp" rename to "dim_product"
[0m12:06:55.349889 [debug] [Thread-3 (]: Timing info for model.retail_project.dim_customer (execute): 12:06:55.214802 => 12:06:55.349645
[0m12:06:55.353807 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:06:55.355319 [debug] [Thread-3 (]: On model.retail_project.dim_customer: Close
[0m12:06:55.356355 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:06:55.359463 [debug] [Thread-1 (]: On model.retail_project.dim_store: COMMIT
[0m12:06:55.368595 [debug] [Thread-4 (]: On model.retail_project.dim_product: COMMIT
[0m12:06:55.364673 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84d8a62e-722a-40bb-aed9-0bb7f5ed1ecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd27da5310>]}
[0m12:06:55.370808 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:06:55.371974 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:06:55.373357 [info ] [Thread-3 (]: 5 of 8 OK created sql view model marts_marts.dim_customer ...................... [[32mCREATE VIEW[0m in 0.17s]
[0m12:06:55.374879 [debug] [Thread-1 (]: On model.retail_project.dim_store: COMMIT
[0m12:06:55.375935 [debug] [Thread-4 (]: On model.retail_project.dim_product: COMMIT
[0m12:06:55.377527 [debug] [Thread-3 (]: Finished running node model.retail_project.dim_customer
[0m12:06:55.382327 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m12:06:55.386373 [debug] [Thread-4 (]: Applying DROP to: "retail_dwh"."marts_marts"."dim_product__dbt_backup"
[0m12:06:55.388023 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:06:55.389198 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:06:55.390734 [debug] [Thread-4 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */
drop view if exists "retail_dwh"."marts_marts"."dim_product__dbt_backup" cascade
[0m12:06:55.394587 [debug] [Thread-1 (]: Applying DROP to: "retail_dwh"."marts_marts"."dim_store__dbt_backup"
[0m12:06:55.397154 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:06:55.398356 [debug] [Thread-1 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */
drop view if exists "retail_dwh"."marts_marts"."dim_store__dbt_backup" cascade
[0m12:06:55.399568 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:06:55.404073 [debug] [Thread-4 (]: Timing info for model.retail_project.dim_product (execute): 12:06:55.267168 => 12:06:55.403805
[0m12:06:55.405894 [debug] [Thread-4 (]: On model.retail_project.dim_product: Close
[0m12:06:55.406853 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84d8a62e-722a-40bb-aed9-0bb7f5ed1ecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd285ac950>]}
[0m12:06:55.405088 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:06:55.407480 [info ] [Thread-4 (]: 7 of 8 OK created sql view model marts_marts.dim_product ....................... [[32mCREATE VIEW[0m in 0.16s]
[0m12:06:55.412154 [debug] [Thread-1 (]: Timing info for model.retail_project.dim_store (execute): 12:06:55.250312 => 12:06:55.411708
[0m12:06:55.414096 [debug] [Thread-4 (]: Finished running node model.retail_project.dim_product
[0m12:06:55.415179 [debug] [Thread-1 (]: On model.retail_project.dim_store: Close
[0m12:06:55.417354 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84d8a62e-722a-40bb-aed9-0bb7f5ed1ecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd279fce60>]}
[0m12:06:55.419588 [info ] [Thread-1 (]: 6 of 8 OK created sql view model marts_marts.dim_store ......................... [[32mCREATE VIEW[0m in 0.20s]
[0m12:06:55.421431 [debug] [Thread-1 (]: Finished running node model.retail_project.dim_store
[0m12:06:55.425977 [debug] [Thread-2 (]: Began running node model.retail_project.fact_sales
[0m12:06:55.427207 [info ] [Thread-2 (]: 8 of 8 SKIP relation marts_marts.fact_sales .................................... [[33mSKIP[0m]
[0m12:06:55.428870 [debug] [Thread-2 (]: Finished running node model.retail_project.fact_sales
[0m12:06:55.439654 [debug] [MainThread]: Using postgres connection "master"
[0m12:06:55.440318 [debug] [MainThread]: On master: BEGIN
[0m12:06:55.440811 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:06:55.457220 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:06:55.457800 [debug] [MainThread]: On master: COMMIT
[0m12:06:55.458230 [debug] [MainThread]: Using postgres connection "master"
[0m12:06:55.458669 [debug] [MainThread]: On master: COMMIT
[0m12:06:55.459626 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:06:55.460081 [debug] [MainThread]: On master: Close
[0m12:06:55.461183 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:06:55.461583 [debug] [MainThread]: Connection 'model.retail_project.stg_products' was properly closed.
[0m12:06:55.461856 [debug] [MainThread]: Connection 'model.retail_project.dim_store' was properly closed.
[0m12:06:55.462144 [debug] [MainThread]: Connection 'model.retail_project.dim_customer' was properly closed.
[0m12:06:55.462408 [debug] [MainThread]: Connection 'model.retail_project.dim_product' was properly closed.
[0m12:06:55.463014 [info ] [MainThread]: 
[0m12:06:55.463496 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 1.01 seconds (1.01s).
[0m12:06:55.465238 [debug] [MainThread]: Command end result
[0m12:06:55.479364 [info ] [MainThread]: 
[0m12:06:55.480046 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:06:55.480562 [info ] [MainThread]: 
[0m12:06:55.481249 [error] [MainThread]:   Database Error in model stg_sales_transaction (models/staging/stg_sales_transaction.sql)
  column "unit_price" does not exist
  LINE 15:         unit_price,
                   ^
  compiled Code at target/run/retail_project/models/staging/stg_sales_transaction.sql
[0m12:06:55.481919 [info ] [MainThread]: 
[0m12:06:55.482492 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=1 TOTAL=8
[0m12:06:55.483810 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.7832869, "process_user_time": 3.411561, "process_kernel_time": 0.857857, "process_mem_max_rss": "151468", "process_out_blocks": "2616", "command_success": false, "process_in_blocks": "0"}
[0m12:06:55.484568 [debug] [MainThread]: Command `dbt run` failed at 12:06:55.484217 after 1.78 seconds
[0m12:06:55.485380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd299492b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd2e7867e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd29ab62d0>]}
[0m12:06:55.485818 [debug] [MainThread]: Flushing usage events
[0m12:08:19.964008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f1cc2cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f21c3770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f21e8320>]}


============================== 12:08:19.972644 | 0a73c07e-cdde-4f68-a96b-e9b64282d06e ==============================
[0m12:08:19.972644 [info ] [MainThread]: Running with dbt=1.7.0
[0m12:08:19.974205 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/dbt/retail_project/retail_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /root/.dbt', 'send_anonymous_usage_stats': 'True'}
[0m12:08:20.295587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a73c07e-cdde-4f68-a96b-e9b64282d06e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f20d62d0>]}
[0m12:08:20.444675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a73c07e-cdde-4f68-a96b-e9b64282d06e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f1cf21e0>]}
[0m12:08:20.445680 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m12:08:20.458058 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m12:08:20.497441 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:08:20.498406 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:08:20.499718 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail_project.intermediate
[0m12:08:20.518183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a73c07e-cdde-4f68-a96b-e9b64282d06e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f13e2570>]}
[0m12:08:20.549985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a73c07e-cdde-4f68-a96b-e9b64282d06e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f0fc8260>]}
[0m12:08:20.550836 [info ] [MainThread]: Found 8 models, 4 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:08:20.551983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a73c07e-cdde-4f68-a96b-e9b64282d06e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f0fc8d40>]}
[0m12:08:20.554911 [info ] [MainThread]: 
[0m12:08:20.559304 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:08:20.563749 [debug] [ThreadPool]: Acquiring new postgres connection 'list_retail_dwh'
[0m12:08:20.581860 [debug] [ThreadPool]: Acquiring new postgres connection 'list_retail_dwh'
[0m12:08:20.602673 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh"
[0m12:08:20.605843 [debug] [ThreadPool]: On list_retail_dwh: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh"} */

    select distinct nspname from pg_namespace
  
[0m12:08:20.607211 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:08:20.610799 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh"
[0m12:08:20.611924 [debug] [ThreadPool]: On list_retail_dwh: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh"} */

    select distinct nspname from pg_namespace
  
[0m12:08:20.612528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:08:20.633881 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m12:08:20.636072 [debug] [ThreadPool]: On list_retail_dwh: Close
[0m12:08:20.637873 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m12:08:20.644433 [debug] [ThreadPool]: On list_retail_dwh: Close
[0m12:08:20.653451 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_dwh, now list_retail_dwh_marts_staging)
[0m12:08:20.665487 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_dwh, now list_retail_dwh_marts_marts)
[0m12:08:20.672309 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_staging"
[0m12:08:20.676553 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_marts"
[0m12:08:20.678738 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: BEGIN
[0m12:08:20.680334 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: BEGIN
[0m12:08:20.682847 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:08:20.684895 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:08:20.704880 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:08:20.705523 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_marts"
[0m12:08:20.706545 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh_marts_marts"} */
select
      'retail_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'retail_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'retail_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m12:08:20.707580 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:08:20.708475 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_staging"
[0m12:08:20.709461 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh_marts_staging"} */
select
      'retail_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'retail_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'retail_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m12:08:20.714553 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m12:08:20.719673 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: ROLLBACK
[0m12:08:20.721036 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:08:20.725379 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: ROLLBACK
[0m12:08:20.726353 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: Close
[0m12:08:20.728071 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: Close
[0m12:08:20.747618 [debug] [MainThread]: Using postgres connection "master"
[0m12:08:20.748783 [debug] [MainThread]: On master: BEGIN
[0m12:08:20.749496 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:08:20.770213 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:08:20.770777 [debug] [MainThread]: Using postgres connection "master"
[0m12:08:20.772253 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:08:20.812040 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m12:08:20.818982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a73c07e-cdde-4f68-a96b-e9b64282d06e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f2c8f230>]}
[0m12:08:20.819812 [debug] [MainThread]: On master: ROLLBACK
[0m12:08:20.821278 [debug] [MainThread]: Using postgres connection "master"
[0m12:08:20.822098 [debug] [MainThread]: On master: BEGIN
[0m12:08:20.824808 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:08:20.825383 [debug] [MainThread]: On master: COMMIT
[0m12:08:20.825752 [debug] [MainThread]: Using postgres connection "master"
[0m12:08:20.826176 [debug] [MainThread]: On master: COMMIT
[0m12:08:20.827408 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:08:20.827811 [debug] [MainThread]: On master: Close
[0m12:08:20.829924 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:08:20.831938 [info ] [MainThread]: 
[0m12:08:20.846998 [debug] [Thread-1 (]: Began running node model.retail_project.stg_customers
[0m12:08:20.849413 [info ] [Thread-1 (]: 1 of 8 START sql view model marts_staging.stg_customers ........................ [RUN]
[0m12:08:20.851685 [debug] [Thread-2 (]: Began running node model.retail_project.stg_products
[0m12:08:20.853846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail_dwh_marts_marts, now model.retail_project.stg_customers)
[0m12:08:20.855348 [debug] [Thread-3 (]: Began running node model.retail_project.stg_sales_transaction
[0m12:08:20.857850 [info ] [Thread-2 (]: 2 of 8 START sql view model marts_staging.stg_products ......................... [RUN]
[0m12:08:20.859806 [debug] [Thread-1 (]: Began compiling node model.retail_project.stg_customers
[0m12:08:20.862277 [info ] [Thread-3 (]: 3 of 8 START sql view model marts_staging.stg_sales_transaction ................ [RUN]
[0m12:08:20.865327 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_retail_dwh_marts_staging, now model.retail_project.stg_products)
[0m12:08:20.867451 [debug] [Thread-4 (]: Began running node model.retail_project.stg_stores
[0m12:08:20.879420 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_project.stg_customers"
[0m12:08:20.882982 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.retail_project.stg_sales_transaction'
[0m12:08:20.885587 [debug] [Thread-2 (]: Began compiling node model.retail_project.stg_products
[0m12:08:20.887313 [info ] [Thread-4 (]: 4 of 8 START sql view model marts_staging.stg_stores ........................... [RUN]
[0m12:08:20.890165 [debug] [Thread-3 (]: Began compiling node model.retail_project.stg_sales_transaction
[0m12:08:20.891358 [debug] [Thread-1 (]: Timing info for model.retail_project.stg_customers (compile): 12:08:20.868220 => 12:08:20.891043
[0m12:08:20.896292 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_project.stg_products"
[0m12:08:20.899843 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.retail_project.stg_stores'
[0m12:08:20.905499 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_project.stg_sales_transaction"
[0m12:08:20.907522 [debug] [Thread-1 (]: Began executing node model.retail_project.stg_customers
[0m12:08:20.910183 [debug] [Thread-4 (]: Began compiling node model.retail_project.stg_stores
[0m12:08:20.914292 [debug] [Thread-2 (]: Timing info for model.retail_project.stg_products (compile): 12:08:20.892692 => 12:08:20.913089
[0m12:08:20.954172 [debug] [Thread-2 (]: Began executing node model.retail_project.stg_products
[0m12:08:20.952337 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_project.stg_stores"
[0m12:08:20.937596 [debug] [Thread-3 (]: Timing info for model.retail_project.stg_sales_transaction (compile): 12:08:20.900674 => 12:08:20.936543
[0m12:08:20.988147 [debug] [Thread-3 (]: Began executing node model.retail_project.stg_sales_transaction
[0m12:08:21.078120 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_project.stg_products"
[0m12:08:21.083999 [debug] [Thread-4 (]: Timing info for model.retail_project.stg_stores (compile): 12:08:20.939150 => 12:08:21.082351
[0m12:08:21.091198 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_project.stg_sales_transaction"
[0m12:08:21.094252 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_project.stg_customers"
[0m12:08:21.097987 [debug] [Thread-4 (]: Began executing node model.retail_project.stg_stores
[0m12:08:21.099856 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:08:21.102406 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m12:08:21.103970 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:08:21.116592 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_project.stg_stores"
[0m12:08:21.117863 [debug] [Thread-2 (]: On model.retail_project.stg_products: BEGIN
[0m12:08:21.119781 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: BEGIN
[0m12:08:21.120979 [debug] [Thread-1 (]: On model.retail_project.stg_customers: BEGIN
[0m12:08:21.123147 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:08:21.124755 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:08:21.125675 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:08:21.127427 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:21.131352 [debug] [Thread-4 (]: On model.retail_project.stg_stores: BEGIN
[0m12:08:21.137873 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:08:21.145988 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:08:21.148644 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:08:21.150847 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */

  create view "retail_dwh"."marts_staging"."stg_products__dbt_tmp"
    
    
  as (
    SELECT
    product_id,
    product_name,
    TRIM(category) AS product_category,
    TRIM(sub_category) AS product_sub_category,
    CAST(price AS NUMERIC) AS product_price
FROM
    "retail_dwh"."raw"."products_raw"
  );
[0m12:08:21.154108 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:08:21.155632 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m12:08:21.157572 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:08:21.158902 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */

  create view "retail_dwh"."marts_staging"."stg_sales_transaction__dbt_tmp"
    
    
  as (
    with source as (
    select
        transaction_id,
        customer_id,
        product_id,
        store_id,
        transaction_date,
        quantity,
        unit_price,
        payment_method
    from "retail_dwh"."raw"."sales_transaction_raw"
),

typed as (
    select
        transaction_id,
        customer_id,
        product_id,
        store_id,
        transaction_date::date        as transaction_date,
        quantity::integer             as quantity,
        unit_price::numeric(18,2)     as unit_price,
        payment_method
    from source
)

select * from typed
  );
[0m12:08:21.179619 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:08:21.181989 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:08:21.187995 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
alter table "retail_dwh"."marts_staging"."stg_products" rename to "stg_products__dbt_backup"
[0m12:08:21.189055 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:08:21.190868 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:08:21.192374 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "unit_price" does not exist
LINE 15:         unit_price,
                 ^

[0m12:08:21.194973 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:08:21.195928 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:08:21.198326 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */

  create view "retail_dwh"."marts_staging"."stg_customers__dbt_tmp"
    
    
  as (
    SELECT
    customer_id,
    customer_name,
    UPPER(TRIM(gender)) AS customer_gender,
    TRIM(city) AS customer_city,
    CAST(signup_date AS DATE) AS customer_signup_date
FROM
    "retail_dwh"."raw"."customers_raw"
  );
[0m12:08:21.200986 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: ROLLBACK
[0m12:08:21.210543 [debug] [Thread-3 (]: Timing info for model.retail_project.stg_sales_transaction (execute): 12:08:20.989859 => 12:08:21.210133
[0m12:08:21.207388 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:08:21.202946 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */

  create view "retail_dwh"."marts_staging"."stg_stores__dbt_tmp"
    
    
  as (
    with source as (
    select
        store_id,
        store_name,
        city,
        region
    from "retail_dwh"."raw"."stores_raw"
),

renamed as (
    select
        store_id,
        store_name,
        city,
        region as store_region
    from source
)

select * from renamed
  );
[0m12:08:21.211745 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: Close
[0m12:08:21.213280 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
alter table "retail_dwh"."marts_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m12:08:21.214883 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:08:21.284960 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:08:21.287102 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:08:21.310142 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:08:21.312697 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
alter table "retail_dwh"."marts_staging"."stg_stores" rename to "stg_stores__dbt_backup"
[0m12:08:21.294974 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:08:21.326400 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
alter table "retail_dwh"."marts_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m12:08:21.328549 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:08:21.338462 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:08:21.341747 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:08:21.362376 [debug] [Thread-2 (]: On model.retail_project.stg_products: COMMIT
[0m12:08:21.365169 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
alter table "retail_dwh"."marts_staging"."stg_stores__dbt_tmp" rename to "stg_stores"
[0m12:08:21.372149 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:08:21.377041 [debug] [Thread-3 (]: Database Error in model stg_sales_transaction (models/staging/stg_sales_transaction.sql)
  column "unit_price" does not exist
  LINE 15:         unit_price,
                   ^
  compiled Code at target/run/retail_project/models/staging/stg_sales_transaction.sql
[0m12:08:21.378669 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:08:21.382069 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
alter table "retail_dwh"."marts_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m12:08:21.383367 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a73c07e-cdde-4f68-a96b-e9b64282d06e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f072ae70>]}
[0m12:08:21.385076 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:08:21.387086 [debug] [Thread-2 (]: On model.retail_project.stg_products: COMMIT
[0m12:08:21.398498 [debug] [Thread-4 (]: On model.retail_project.stg_stores: COMMIT
[0m12:08:21.389647 [error] [Thread-3 (]: 3 of 8 ERROR creating sql view model marts_staging.stg_sales_transaction ....... [[31mERROR[0m in 0.50s]
[0m12:08:21.401494 [debug] [Thread-3 (]: Finished running node model.retail_project.stg_sales_transaction
[0m12:08:21.399937 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:08:21.403766 [debug] [Thread-4 (]: On model.retail_project.stg_stores: COMMIT
[0m12:08:21.391621 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:08:21.407724 [debug] [Thread-1 (]: On model.retail_project.stg_customers: COMMIT
[0m12:08:21.408304 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:08:21.408719 [debug] [Thread-1 (]: On model.retail_project.stg_customers: COMMIT
[0m12:08:21.427345 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m12:08:21.428341 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:08:21.436861 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:08:21.468194 [debug] [Thread-4 (]: Applying DROP to: "retail_dwh"."marts_staging"."stg_stores__dbt_backup"
[0m12:08:21.472295 [debug] [Thread-2 (]: Applying DROP to: "retail_dwh"."marts_staging"."stg_products__dbt_backup"
[0m12:08:21.474597 [debug] [Thread-1 (]: Applying DROP to: "retail_dwh"."marts_staging"."stg_customers__dbt_backup"
[0m12:08:21.490338 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:08:21.492374 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:08:21.495300 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:08:21.497560 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
drop view if exists "retail_dwh"."marts_staging"."stg_stores__dbt_backup" cascade
[0m12:08:21.500235 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
drop view if exists "retail_dwh"."marts_staging"."stg_products__dbt_backup" cascade
[0m12:08:21.501933 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
drop view if exists "retail_dwh"."marts_staging"."stg_customers__dbt_backup" cascade
[0m12:08:21.511029 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:08:21.514655 [debug] [Thread-1 (]: Timing info for model.retail_project.stg_customers (execute): 12:08:20.916884 => 12:08:21.513591
[0m12:08:21.516722 [debug] [Thread-1 (]: On model.retail_project.stg_customers: Close
[0m12:08:21.520766 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a73c07e-cdde-4f68-a96b-e9b64282d06e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f0bb1b80>]}
[0m12:08:21.523186 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:08:21.524998 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:08:21.529924 [debug] [Thread-4 (]: Timing info for model.retail_project.stg_stores (execute): 12:08:21.105081 => 12:08:21.528818
[0m12:08:21.521975 [info ] [Thread-1 (]: 1 of 8 OK created sql view model marts_staging.stg_customers ................... [[32mCREATE VIEW[0m in 0.67s]
[0m12:08:21.534737 [debug] [Thread-2 (]: Timing info for model.retail_project.stg_products (execute): 12:08:20.955208 => 12:08:21.534437
[0m12:08:21.536064 [debug] [Thread-4 (]: On model.retail_project.stg_stores: Close
[0m12:08:21.538191 [debug] [Thread-1 (]: Finished running node model.retail_project.stg_customers
[0m12:08:21.541071 [debug] [Thread-2 (]: On model.retail_project.stg_products: Close
[0m12:08:21.544079 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a73c07e-cdde-4f68-a96b-e9b64282d06e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f0bfac60>]}
[0m12:08:21.549012 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a73c07e-cdde-4f68-a96b-e9b64282d06e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f075a480>]}
[0m12:08:21.551614 [debug] [Thread-3 (]: Began running node model.retail_project.dim_customer
[0m12:08:21.553970 [info ] [Thread-4 (]: 4 of 8 OK created sql view model marts_staging.stg_stores ...................... [[32mCREATE VIEW[0m in 0.65s]
[0m12:08:21.557085 [info ] [Thread-2 (]: 2 of 8 OK created sql view model marts_staging.stg_products .................... [[32mCREATE VIEW[0m in 0.69s]
[0m12:08:21.560488 [debug] [Thread-4 (]: Finished running node model.retail_project.stg_stores
[0m12:08:21.559149 [info ] [Thread-3 (]: 5 of 8 START sql view model marts_marts.dim_customer ........................... [RUN]
[0m12:08:21.563778 [debug] [Thread-2 (]: Finished running node model.retail_project.stg_products
[0m12:08:21.567252 [debug] [Thread-1 (]: Began running node model.retail_project.dim_store
[0m12:08:21.569327 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_sales_transaction, now model.retail_project.dim_customer)
[0m12:08:21.572186 [info ] [Thread-1 (]: 6 of 8 START sql view model marts_marts.dim_store .............................. [RUN]
[0m12:08:21.576148 [debug] [Thread-3 (]: Began compiling node model.retail_project.dim_customer
[0m12:08:21.577244 [debug] [Thread-4 (]: Began running node model.retail_project.dim_product
[0m12:08:21.586459 [info ] [Thread-4 (]: 7 of 8 START sql view model marts_marts.dim_product ............................ [RUN]
[0m12:08:21.578709 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_customers, now model.retail_project.dim_store)
[0m12:08:21.584896 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_project.dim_customer"
[0m12:08:21.589110 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_stores, now model.retail_project.dim_product)
[0m12:08:21.590977 [debug] [Thread-1 (]: Began compiling node model.retail_project.dim_store
[0m12:08:21.592737 [debug] [Thread-4 (]: Began compiling node model.retail_project.dim_product
[0m12:08:21.598142 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_project.dim_store"
[0m12:08:21.605956 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_project.dim_product"
[0m12:08:21.609037 [debug] [Thread-3 (]: Timing info for model.retail_project.dim_customer (compile): 12:08:21.581261 => 12:08:21.608259
[0m12:08:21.613225 [debug] [Thread-3 (]: Began executing node model.retail_project.dim_customer
[0m12:08:21.615187 [debug] [Thread-1 (]: Timing info for model.retail_project.dim_store (compile): 12:08:21.594154 => 12:08:21.614062
[0m12:08:21.624592 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_project.dim_customer"
[0m12:08:21.625980 [debug] [Thread-4 (]: Timing info for model.retail_project.dim_product (compile): 12:08:21.600274 => 12:08:21.625620
[0m12:08:21.627413 [debug] [Thread-1 (]: Began executing node model.retail_project.dim_store
[0m12:08:21.630075 [debug] [Thread-4 (]: Began executing node model.retail_project.dim_product
[0m12:08:21.638420 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_project.dim_store"
[0m12:08:21.640002 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:08:21.646991 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_project.dim_product"
[0m12:08:21.651341 [debug] [Thread-3 (]: On model.retail_project.dim_customer: BEGIN
[0m12:08:21.652622 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:08:21.654666 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:08:21.655598 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:08:21.656857 [debug] [Thread-1 (]: On model.retail_project.dim_store: BEGIN
[0m12:08:21.660129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:21.659039 [debug] [Thread-4 (]: On model.retail_project.dim_product: BEGIN
[0m12:08:21.661433 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:08:21.679268 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:08:21.680106 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:08:21.682269 [debug] [Thread-3 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */

  create view "retail_dwh"."marts_marts"."dim_customer__dbt_tmp"
    
    
  as (
    SELECT
    customer_id,
    customer_name,
    customer_gender,
    customer_city,
    customer_signup_date
FROM
    "retail_dwh"."marts_staging"."stg_customers"
  );
[0m12:08:21.685955 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:08:21.686575 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:08:21.687076 [debug] [Thread-1 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */

  create view "retail_dwh"."marts_marts"."dim_store__dbt_tmp"
    
    
  as (
    select
    store_id,
    store_name,
    city as store_city,
    store_region
from "retail_dwh"."marts_staging"."stg_stores"
  );
[0m12:08:21.689815 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:08:21.697409 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:08:21.702602 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:08:21.695994 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:08:21.705729 [debug] [Thread-1 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */
alter table "retail_dwh"."marts_marts"."dim_store__dbt_tmp" rename to "dim_store"
[0m12:08:21.707290 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:08:21.709030 [debug] [Thread-3 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */
alter table "retail_dwh"."marts_marts"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m12:08:21.711152 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:08:21.713446 [debug] [Thread-4 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */

  create view "retail_dwh"."marts_marts"."dim_product__dbt_tmp"
    
    
  as (
    SELECT
    product_id,
    product_name,
    product_category,
    product_sub_category,
    product_price
FROM
    "retail_dwh"."marts_staging"."stg_products"
  );
[0m12:08:21.715163 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:08:21.717284 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:08:21.721505 [debug] [Thread-1 (]: On model.retail_project.dim_store: COMMIT
[0m12:08:21.725582 [debug] [Thread-3 (]: On model.retail_project.dim_customer: COMMIT
[0m12:08:21.727412 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:08:21.729120 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:08:21.731317 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:08:21.736984 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:08:21.738794 [debug] [Thread-1 (]: On model.retail_project.dim_store: COMMIT
[0m12:08:21.740309 [debug] [Thread-3 (]: On model.retail_project.dim_customer: COMMIT
[0m12:08:21.741842 [debug] [Thread-4 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */
alter table "retail_dwh"."marts_marts"."dim_product__dbt_tmp" rename to "dim_product"
[0m12:08:21.746487 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:08:21.749925 [debug] [Thread-4 (]: On model.retail_project.dim_product: COMMIT
[0m12:08:21.750506 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:08:21.750922 [debug] [Thread-4 (]: On model.retail_project.dim_product: COMMIT
[0m12:08:21.753961 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m12:08:21.760475 [debug] [Thread-3 (]: Applying DROP to: "retail_dwh"."marts_marts"."dim_customer__dbt_backup"
[0m12:08:21.763848 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:08:21.766222 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m12:08:21.768250 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:08:21.769996 [debug] [Thread-3 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */
drop view if exists "retail_dwh"."marts_marts"."dim_customer__dbt_backup" cascade
[0m12:08:21.774470 [debug] [Thread-4 (]: Applying DROP to: "retail_dwh"."marts_marts"."dim_product__dbt_backup"
[0m12:08:21.782504 [debug] [Thread-1 (]: Applying DROP to: "retail_dwh"."marts_marts"."dim_store__dbt_backup"
[0m12:08:21.787253 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:08:21.790258 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:08:21.791202 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:08:21.792619 [debug] [Thread-4 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */
drop view if exists "retail_dwh"."marts_marts"."dim_product__dbt_backup" cascade
[0m12:08:21.794174 [debug] [Thread-1 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */
drop view if exists "retail_dwh"."marts_marts"."dim_store__dbt_backup" cascade
[0m12:08:21.799360 [debug] [Thread-3 (]: Timing info for model.retail_project.dim_customer (execute): 12:08:21.616811 => 12:08:21.798984
[0m12:08:21.801879 [debug] [Thread-3 (]: On model.retail_project.dim_customer: Close
[0m12:08:21.803921 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:08:21.807689 [debug] [Thread-1 (]: Timing info for model.retail_project.dim_store (execute): 12:08:21.632193 => 12:08:21.807409
[0m12:08:21.808985 [debug] [Thread-1 (]: On model.retail_project.dim_store: Close
[0m12:08:21.811268 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a73c07e-cdde-4f68-a96b-e9b64282d06e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f03423c0>]}
[0m12:08:21.815197 [info ] [Thread-3 (]: 5 of 8 OK created sql view model marts_marts.dim_customer ...................... [[32mCREATE VIEW[0m in 0.24s]
[0m12:08:21.818005 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:08:21.819493 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a73c07e-cdde-4f68-a96b-e9b64282d06e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f139c1d0>]}
[0m12:08:21.821174 [debug] [Thread-3 (]: Finished running node model.retail_project.dim_customer
[0m12:08:21.825955 [debug] [Thread-4 (]: Timing info for model.retail_project.dim_product (execute): 12:08:21.640820 => 12:08:21.824307
[0m12:08:21.828002 [info ] [Thread-1 (]: 6 of 8 OK created sql view model marts_marts.dim_store ......................... [[32mCREATE VIEW[0m in 0.24s]
[0m12:08:21.829956 [debug] [Thread-4 (]: On model.retail_project.dim_product: Close
[0m12:08:21.833324 [debug] [Thread-1 (]: Finished running node model.retail_project.dim_store
[0m12:08:21.836386 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a73c07e-cdde-4f68-a96b-e9b64282d06e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f0f30680>]}
[0m12:08:21.837323 [info ] [Thread-4 (]: 7 of 8 OK created sql view model marts_marts.dim_product ....................... [[32mCREATE VIEW[0m in 0.25s]
[0m12:08:21.838777 [debug] [Thread-4 (]: Finished running node model.retail_project.dim_product
[0m12:08:21.843005 [debug] [Thread-2 (]: Began running node model.retail_project.fact_sales
[0m12:08:21.843818 [info ] [Thread-2 (]: 8 of 8 SKIP relation marts_marts.fact_sales .................................... [[33mSKIP[0m]
[0m12:08:21.844853 [debug] [Thread-2 (]: Finished running node model.retail_project.fact_sales
[0m12:08:21.856219 [debug] [MainThread]: Using postgres connection "master"
[0m12:08:21.856706 [debug] [MainThread]: On master: BEGIN
[0m12:08:21.857133 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:08:21.876106 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:08:21.876702 [debug] [MainThread]: On master: COMMIT
[0m12:08:21.877115 [debug] [MainThread]: Using postgres connection "master"
[0m12:08:21.877508 [debug] [MainThread]: On master: COMMIT
[0m12:08:21.879066 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:08:21.879636 [debug] [MainThread]: On master: Close
[0m12:08:21.882330 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:08:21.882922 [debug] [MainThread]: Connection 'model.retail_project.stg_products' was properly closed.
[0m12:08:21.883276 [debug] [MainThread]: Connection 'model.retail_project.dim_store' was properly closed.
[0m12:08:21.883592 [debug] [MainThread]: Connection 'model.retail_project.dim_customer' was properly closed.
[0m12:08:21.884150 [debug] [MainThread]: Connection 'model.retail_project.dim_product' was properly closed.
[0m12:08:21.884691 [info ] [MainThread]: 
[0m12:08:21.887003 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 1.33 seconds (1.33s).
[0m12:08:21.890460 [debug] [MainThread]: Command end result
[0m12:08:21.915524 [info ] [MainThread]: 
[0m12:08:21.917221 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:08:21.918139 [info ] [MainThread]: 
[0m12:08:21.918862 [error] [MainThread]:   Database Error in model stg_sales_transaction (models/staging/stg_sales_transaction.sql)
  column "unit_price" does not exist
  LINE 15:         unit_price,
                   ^
  compiled Code at target/run/retail_project/models/staging/stg_sales_transaction.sql
[0m12:08:21.919379 [info ] [MainThread]: 
[0m12:08:21.919822 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=1 TOTAL=8
[0m12:08:21.920971 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.1293352, "process_user_time": 4.661422, "process_kernel_time": 1.148375, "process_mem_max_rss": "151392", "process_out_blocks": "1832", "command_success": false, "process_in_blocks": "0"}
[0m12:08:21.921539 [debug] [MainThread]: Command `dbt run` failed at 12:08:21.921388 after 2.13 seconds
[0m12:08:21.922005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f21e8320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f1cc17f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f2c7aae0>]}
[0m12:08:21.922464 [debug] [MainThread]: Flushing usage events
[0m12:08:52.503840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f446a019bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f446a01a450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f446a019b50>]}


============================== 12:08:52.509440 | 0095f0c1-e17c-40b7-9333-f7a5e4abe943 ==============================
[0m12:08:52.509440 [info ] [MainThread]: Running with dbt=1.7.0
[0m12:08:52.510285 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/opt/dbt/retail_project/retail_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps --profiles-dir /root/.dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:08:52.633878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0095f0c1-e17c-40b7-9333-f7a5e4abe943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f446a29b740>]}
[0m12:08:52.634648 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:08:52.635752 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:08:52.638556 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.20493977, "process_user_time": 2.859016, "process_kernel_time": 0.371686, "process_mem_max_rss": "151516", "process_out_blocks": "16", "process_in_blocks": "0"}
[0m12:08:52.639487 [debug] [MainThread]: Command `dbt deps` succeeded at 12:08:52.639279 after 0.21 seconds
[0m12:08:52.639841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f446a116000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f446a29b740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f446ef86810>]}
[0m12:08:52.640194 [debug] [MainThread]: Flushing usage events
[0m12:08:58.773303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32d5d25850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32d63a1f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32d5dbf470>]}


============================== 12:08:58.778257 | e7303cf8-227c-4c14-bace-ddafa4bff980 ==============================
[0m12:08:58.778257 [info ] [MainThread]: Running with dbt=1.7.0
[0m12:08:58.787938 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/dbt/retail_project/retail_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /root/.dbt', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:08:59.370928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7303cf8-227c-4c14-bace-ddafa4bff980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32d56b6bd0>]}
[0m12:08:59.568931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7303cf8-227c-4c14-bace-ddafa4bff980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32d5dbd340>]}
[0m12:08:59.570129 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m12:08:59.584754 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m12:08:59.633537 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:08:59.634294 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:08:59.635582 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail_project.intermediate
[0m12:08:59.644890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7303cf8-227c-4c14-bace-ddafa4bff980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32d5bf3b90>]}
[0m12:08:59.669248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7303cf8-227c-4c14-bace-ddafa4bff980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32d53780b0>]}
[0m12:08:59.670816 [info ] [MainThread]: Found 8 models, 4 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:08:59.671831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7303cf8-227c-4c14-bace-ddafa4bff980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32d567ca70>]}
[0m12:08:59.675457 [info ] [MainThread]: 
[0m12:08:59.677057 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:08:59.679955 [debug] [ThreadPool]: Acquiring new postgres connection 'list_retail_dwh'
[0m12:08:59.700858 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh"
[0m12:08:59.701972 [debug] [ThreadPool]: On list_retail_dwh: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh"} */

    select distinct nspname from pg_namespace
  
[0m12:08:59.702955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:08:59.706722 [debug] [ThreadPool]: Acquiring new postgres connection 'list_retail_dwh'
[0m12:08:59.711717 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh"
[0m12:08:59.712875 [debug] [ThreadPool]: On list_retail_dwh: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh"} */

    select distinct nspname from pg_namespace
  
[0m12:08:59.713791 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:08:59.737001 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m12:08:59.742993 [debug] [ThreadPool]: On list_retail_dwh: Close
[0m12:08:59.750808 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m12:08:59.753873 [debug] [ThreadPool]: On list_retail_dwh: Close
[0m12:08:59.762355 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_dwh, now list_retail_dwh_marts_staging)
[0m12:08:59.777210 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_staging"
[0m12:08:59.778207 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: BEGIN
[0m12:08:59.778816 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:08:59.782879 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_dwh, now list_retail_dwh_marts_marts)
[0m12:08:59.789096 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_marts"
[0m12:08:59.789718 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: BEGIN
[0m12:08:59.790170 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:08:59.797337 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:08:59.798231 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_staging"
[0m12:08:59.799140 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh_marts_staging"} */
select
      'retail_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'retail_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'retail_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m12:08:59.806513 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:08:59.809932 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: ROLLBACK
[0m12:08:59.811640 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: Close
[0m12:08:59.820055 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:08:59.820921 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_marts"
[0m12:08:59.821736 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh_marts_marts"} */
select
      'retail_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'retail_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'retail_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m12:08:59.826954 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m12:08:59.829175 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: ROLLBACK
[0m12:08:59.830117 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: Close
[0m12:08:59.844802 [debug] [MainThread]: Using postgres connection "master"
[0m12:08:59.845641 [debug] [MainThread]: On master: BEGIN
[0m12:08:59.846283 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:08:59.863423 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:08:59.864260 [debug] [MainThread]: Using postgres connection "master"
[0m12:08:59.865298 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:09:00.083600 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m12:09:00.089270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7303cf8-227c-4c14-bace-ddafa4bff980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32d4fc5190>]}
[0m12:09:00.094327 [debug] [MainThread]: On master: ROLLBACK
[0m12:09:00.095775 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:00.096339 [debug] [MainThread]: On master: BEGIN
[0m12:09:00.098779 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:09:00.100311 [debug] [MainThread]: On master: COMMIT
[0m12:09:00.100862 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:00.101824 [debug] [MainThread]: On master: COMMIT
[0m12:09:00.104102 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:09:00.105261 [debug] [MainThread]: On master: Close
[0m12:09:00.113191 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:09:00.114291 [info ] [MainThread]: 
[0m12:09:00.150068 [debug] [Thread-2 (]: Began running node model.retail_project.stg_products
[0m12:09:00.155240 [debug] [Thread-3 (]: Began running node model.retail_project.stg_sales_transaction
[0m12:09:00.145875 [debug] [Thread-1 (]: Began running node model.retail_project.stg_customers
[0m12:09:00.156979 [info ] [Thread-2 (]: 2 of 8 START sql view model marts_staging.stg_products ......................... [RUN]
[0m12:09:00.161479 [debug] [Thread-4 (]: Began running node model.retail_project.stg_stores
[0m12:09:00.168118 [info ] [Thread-4 (]: 4 of 8 START sql view model marts_staging.stg_stores ........................... [RUN]
[0m12:09:00.158274 [info ] [Thread-3 (]: 3 of 8 START sql view model marts_staging.stg_sales_transaction ................ [RUN]
[0m12:09:00.174910 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.retail_project.stg_sales_transaction'
[0m12:09:00.160009 [info ] [Thread-1 (]: 1 of 8 START sql view model marts_staging.stg_customers ........................ [RUN]
[0m12:09:00.170629 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.retail_project.stg_stores'
[0m12:09:00.165556 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_retail_dwh_marts_staging, now model.retail_project.stg_products)
[0m12:09:00.189127 [debug] [Thread-2 (]: Began compiling node model.retail_project.stg_products
[0m12:09:00.175831 [debug] [Thread-3 (]: Began compiling node model.retail_project.stg_sales_transaction
[0m12:09:00.183824 [debug] [Thread-4 (]: Began compiling node model.retail_project.stg_stores
[0m12:09:00.216374 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_project.stg_stores"
[0m12:09:00.180402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail_dwh_marts_marts, now model.retail_project.stg_customers)
[0m12:09:00.229553 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_project.stg_products"
[0m12:09:00.234397 [debug] [Thread-4 (]: Timing info for model.retail_project.stg_stores (compile): 12:09:00.210119 => 12:09:00.231150
[0m12:09:00.246813 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_project.stg_sales_transaction"
[0m12:09:00.246085 [debug] [Thread-1 (]: Began compiling node model.retail_project.stg_customers
[0m12:09:00.249573 [debug] [Thread-4 (]: Began executing node model.retail_project.stg_stores
[0m12:09:00.252652 [debug] [Thread-2 (]: Timing info for model.retail_project.stg_products (compile): 12:09:00.189870 => 12:09:00.251742
[0m12:09:00.295129 [debug] [Thread-2 (]: Began executing node model.retail_project.stg_products
[0m12:09:00.255833 [debug] [Thread-3 (]: Timing info for model.retail_project.stg_sales_transaction (compile): 12:09:00.200445 => 12:09:00.254567
[0m12:09:00.302639 [debug] [Thread-3 (]: Began executing node model.retail_project.stg_sales_transaction
[0m12:09:00.260783 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_project.stg_customers"
[0m12:09:00.443112 [debug] [Thread-1 (]: Timing info for model.retail_project.stg_customers (compile): 12:09:00.256632 => 12:09:00.441953
[0m12:09:00.452783 [debug] [Thread-1 (]: Began executing node model.retail_project.stg_customers
[0m12:09:00.579400 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_project.stg_products"
[0m12:09:00.590331 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_project.stg_sales_transaction"
[0m12:09:00.601936 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_project.stg_customers"
[0m12:09:00.606718 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_project.stg_stores"
[0m12:09:00.612201 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:09:00.615232 [debug] [Thread-2 (]: On model.retail_project.stg_products: BEGIN
[0m12:09:00.617510 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:09:00.622501 [debug] [Thread-1 (]: On model.retail_project.stg_customers: BEGIN
[0m12:09:00.619976 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:09:00.621267 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m12:09:00.618764 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:09:00.623142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:00.625416 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: BEGIN
[0m12:09:00.627720 [debug] [Thread-4 (]: On model.retail_project.stg_stores: BEGIN
[0m12:09:00.630272 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:09:00.634136 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:09:00.655279 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:09:00.656432 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:09:00.657675 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */

  create view "retail_dwh"."marts_staging"."stg_products__dbt_tmp"
    
    
  as (
    SELECT
    product_id,
    product_name,
    TRIM(category) AS product_category,
    TRIM(sub_category) AS product_sub_category,
    CAST(price AS NUMERIC) AS product_price
FROM
    "retail_dwh"."raw"."products_raw"
  );
[0m12:09:00.659674 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:09:00.661101 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:09:00.664438 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:09:00.667656 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */

  create view "retail_dwh"."marts_staging"."stg_customers__dbt_tmp"
    
    
  as (
    SELECT
    customer_id,
    customer_name,
    UPPER(TRIM(gender)) AS customer_gender,
    TRIM(city) AS customer_city,
    CAST(signup_date AS DATE) AS customer_signup_date
FROM
    "retail_dwh"."raw"."customers_raw"
  );
[0m12:09:00.693744 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:09:00.695693 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
alter table "retail_dwh"."marts_staging"."stg_products" rename to "stg_products__dbt_backup"
[0m12:09:00.698244 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:09:00.701593 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m12:09:00.704198 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */

  create view "retail_dwh"."marts_staging"."stg_sales_transaction__dbt_tmp"
    
    
  as (
    with source as (
    select
        transaction_id,
        customer_id,
        product_id,
        store_id,
        transaction_date,
        quantity,
        unit_price,
        payment_method
    from "retail_dwh"."raw"."sales_transaction_raw"
),

typed as (
    select
        transaction_id,
        customer_id,
        product_id,
        store_id,
        transaction_date::date        as transaction_date,
        quantity::integer             as quantity,
        unit_price::numeric(18,2)     as unit_price,
        payment_method
    from source
)

select * from typed
  );
[0m12:09:00.706166 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:09:00.708908 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:09:00.822406 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "unit_price" does not exist
LINE 15:         unit_price,
                 ^

[0m12:09:00.829780 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:09:00.833650 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:09:00.835422 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:09:00.837417 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: ROLLBACK
[0m12:09:00.839092 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
alter table "retail_dwh"."marts_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m12:09:00.845919 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:09:00.851838 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */

  create view "retail_dwh"."marts_staging"."stg_stores__dbt_tmp"
    
    
  as (
    with source as (
    select
        store_id,
        store_name,
        city,
        region
    from "retail_dwh"."raw"."stores_raw"
),

renamed as (
    select
        store_id,
        store_name,
        city,
        region as store_region
    from source
)

select * from renamed
  );
[0m12:09:00.861130 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
alter table "retail_dwh"."marts_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m12:09:00.863152 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:09:00.866344 [debug] [Thread-3 (]: Timing info for model.retail_project.stg_sales_transaction (execute): 12:09:00.303265 => 12:09:00.864147
[0m12:09:00.888306 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:09:00.890792 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: Close
[0m12:09:00.894713 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:09:00.906382 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:09:00.923272 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:09:00.926005 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
alter table "retail_dwh"."marts_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m12:09:00.934421 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
alter table "retail_dwh"."marts_staging"."stg_stores" rename to "stg_stores__dbt_backup"
[0m12:09:00.954238 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:09:00.975178 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:09:01.003732 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:09:01.029363 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
alter table "retail_dwh"."marts_staging"."stg_stores__dbt_tmp" rename to "stg_stores"
[0m12:09:01.074652 [debug] [Thread-2 (]: On model.retail_project.stg_products: COMMIT
[0m12:09:01.079429 [debug] [Thread-1 (]: On model.retail_project.stg_customers: COMMIT
[0m12:09:01.087252 [debug] [Thread-3 (]: Database Error in model stg_sales_transaction (models/staging/stg_sales_transaction.sql)
  column "unit_price" does not exist
  LINE 15:         unit_price,
                   ^
  compiled Code at target/run/retail_project/models/staging/stg_sales_transaction.sql
[0m12:09:01.089820 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:09:01.091137 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:09:01.093523 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:09:01.095403 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7303cf8-227c-4c14-bace-ddafa4bff980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32d571a3f0>]}
[0m12:09:01.097304 [debug] [Thread-2 (]: On model.retail_project.stg_products: COMMIT
[0m12:09:01.108020 [error] [Thread-3 (]: 3 of 8 ERROR creating sql view model marts_staging.stg_sales_transaction ....... [[31mERROR[0m in 0.92s]
[0m12:09:01.105464 [debug] [Thread-1 (]: On model.retail_project.stg_customers: COMMIT
[0m12:09:01.103859 [debug] [Thread-4 (]: On model.retail_project.stg_stores: COMMIT
[0m12:09:01.113392 [debug] [Thread-3 (]: Finished running node model.retail_project.stg_sales_transaction
[0m12:09:01.116569 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:09:01.119753 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:09:01.138952 [debug] [Thread-4 (]: On model.retail_project.stg_stores: COMMIT
[0m12:09:01.153381 [debug] [Thread-2 (]: Applying DROP to: "retail_dwh"."marts_staging"."stg_products__dbt_backup"
[0m12:09:01.155211 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:09:01.166700 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m12:09:01.176360 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:09:01.189770 [debug] [Thread-4 (]: Applying DROP to: "retail_dwh"."marts_staging"."stg_stores__dbt_backup"
[0m12:09:01.197364 [debug] [Thread-1 (]: Applying DROP to: "retail_dwh"."marts_staging"."stg_customers__dbt_backup"
[0m12:09:01.200312 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
drop view if exists "retail_dwh"."marts_staging"."stg_products__dbt_backup" cascade
[0m12:09:01.205225 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:09:01.208028 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:09:01.215415 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
drop view if exists "retail_dwh"."marts_staging"."stg_stores__dbt_backup" cascade
[0m12:09:01.218268 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
drop view if exists "retail_dwh"."marts_staging"."stg_customers__dbt_backup" cascade
[0m12:09:01.223990 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:09:01.228997 [debug] [Thread-2 (]: Timing info for model.retail_project.stg_products (execute): 12:09:00.296300 => 12:09:01.228395
[0m12:09:01.233273 [debug] [Thread-2 (]: On model.retail_project.stg_products: Close
[0m12:09:01.236147 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:09:01.241157 [debug] [Thread-4 (]: Timing info for model.retail_project.stg_stores (execute): 12:09:00.262556 => 12:09:01.240708
[0m12:09:01.242659 [debug] [Thread-4 (]: On model.retail_project.stg_stores: Close
[0m12:09:01.246327 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7303cf8-227c-4c14-bace-ddafa4bff980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32d4b06450>]}
[0m12:09:01.253369 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7303cf8-227c-4c14-bace-ddafa4bff980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32d4b058b0>]}
[0m12:09:01.254787 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:09:01.250044 [info ] [Thread-4 (]: 4 of 8 OK created sql view model marts_staging.stg_stores ...................... [[32mCREATE VIEW[0m in 1.08s]
[0m12:09:01.257525 [info ] [Thread-2 (]: 2 of 8 OK created sql view model marts_staging.stg_products .................... [[32mCREATE VIEW[0m in 1.09s]
[0m12:09:01.262432 [debug] [Thread-1 (]: Timing info for model.retail_project.stg_customers (execute): 12:09:00.455006 => 12:09:01.262106
[0m12:09:01.265234 [debug] [Thread-4 (]: Finished running node model.retail_project.stg_stores
[0m12:09:01.267517 [debug] [Thread-2 (]: Finished running node model.retail_project.stg_products
[0m12:09:01.270409 [debug] [Thread-1 (]: On model.retail_project.stg_customers: Close
[0m12:09:01.274203 [debug] [Thread-3 (]: Began running node model.retail_project.dim_store
[0m12:09:01.279563 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7303cf8-227c-4c14-bace-ddafa4bff980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32d4b066f0>]}
[0m12:09:01.283029 [info ] [Thread-3 (]: 5 of 8 START sql view model marts_marts.dim_store .............................. [RUN]
[0m12:09:01.287201 [info ] [Thread-1 (]: 1 of 8 OK created sql view model marts_staging.stg_customers ................... [[32mCREATE VIEW[0m in 1.10s]
[0m12:09:01.289842 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_sales_transaction, now model.retail_project.dim_store)
[0m12:09:01.292438 [debug] [Thread-2 (]: Began running node model.retail_project.dim_product
[0m12:09:01.295008 [debug] [Thread-1 (]: Finished running node model.retail_project.stg_customers
[0m12:09:01.297272 [debug] [Thread-3 (]: Began compiling node model.retail_project.dim_store
[0m12:09:01.299991 [info ] [Thread-2 (]: 6 of 8 START sql view model marts_marts.dim_product ............................ [RUN]
[0m12:09:01.310617 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_products, now model.retail_project.dim_product)
[0m12:09:01.313226 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_project.dim_store"
[0m12:09:01.317199 [debug] [Thread-2 (]: Began compiling node model.retail_project.dim_product
[0m12:09:01.321248 [debug] [Thread-4 (]: Began running node model.retail_project.dim_customer
[0m12:09:01.329588 [info ] [Thread-4 (]: 7 of 8 START sql view model marts_marts.dim_customer ........................... [RUN]
[0m12:09:01.331569 [debug] [Thread-3 (]: Timing info for model.retail_project.dim_store (compile): 12:09:01.302535 => 12:09:01.330366
[0m12:09:01.328338 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_project.dim_product"
[0m12:09:01.336474 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_stores, now model.retail_project.dim_customer)
[0m12:09:01.338766 [debug] [Thread-3 (]: Began executing node model.retail_project.dim_store
[0m12:09:01.341947 [debug] [Thread-4 (]: Began compiling node model.retail_project.dim_customer
[0m12:09:01.343969 [debug] [Thread-2 (]: Timing info for model.retail_project.dim_product (compile): 12:09:01.322215 => 12:09:01.343184
[0m12:09:01.357193 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_project.dim_store"
[0m12:09:01.365379 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_project.dim_customer"
[0m12:09:01.366676 [debug] [Thread-2 (]: Began executing node model.retail_project.dim_product
[0m12:09:01.382211 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_project.dim_product"
[0m12:09:01.384548 [debug] [Thread-4 (]: Timing info for model.retail_project.dim_customer (compile): 12:09:01.358543 => 12:09:01.383845
[0m12:09:01.386152 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:09:01.389428 [debug] [Thread-4 (]: Began executing node model.retail_project.dim_customer
[0m12:09:01.392640 [debug] [Thread-3 (]: On model.retail_project.dim_store: BEGIN
[0m12:09:01.394086 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:09:01.404504 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:09:01.409829 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_project.dim_customer"
[0m12:09:01.412647 [debug] [Thread-2 (]: On model.retail_project.dim_product: BEGIN
[0m12:09:01.416237 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:09:01.420543 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:09:01.421156 [debug] [Thread-4 (]: On model.retail_project.dim_customer: BEGIN
[0m12:09:01.421722 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:09:01.434110 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:09:01.434857 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:09:01.435412 [debug] [Thread-3 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */

  create view "retail_dwh"."marts_marts"."dim_store__dbt_tmp"
    
    
  as (
    select
    store_id,
    store_name,
    city as store_city,
    store_region
from "retail_dwh"."marts_staging"."stg_stores"
  );
[0m12:09:01.440061 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:09:01.440795 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:09:01.444071 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:09:01.446157 [debug] [Thread-2 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */

  create view "retail_dwh"."marts_marts"."dim_product__dbt_tmp"
    
    
  as (
    SELECT
    product_id,
    product_name,
    product_category,
    product_sub_category,
    product_price
FROM
    "retail_dwh"."marts_staging"."stg_products"
  );
[0m12:09:01.450063 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:09:01.461094 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:09:01.462039 [debug] [Thread-4 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */

  create view "retail_dwh"."marts_marts"."dim_customer__dbt_tmp"
    
    
  as (
    SELECT
    customer_id,
    customer_name,
    customer_gender,
    customer_city,
    customer_signup_date
FROM
    "retail_dwh"."marts_staging"."stg_customers"
  );
[0m12:09:01.458015 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:09:01.464222 [debug] [Thread-3 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */
alter table "retail_dwh"."marts_marts"."dim_store__dbt_tmp" rename to "dim_store"
[0m12:09:01.467777 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:09:01.473584 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:09:01.475769 [debug] [Thread-2 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */
alter table "retail_dwh"."marts_marts"."dim_product__dbt_tmp" rename to "dim_product"
[0m12:09:01.479038 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:09:01.486366 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:09:01.488785 [debug] [Thread-4 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */
alter table "retail_dwh"."marts_marts"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m12:09:01.491154 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:09:01.495719 [debug] [Thread-3 (]: On model.retail_project.dim_store: COMMIT
[0m12:09:01.497107 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:09:01.499083 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:09:01.500927 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:09:01.504784 [debug] [Thread-2 (]: On model.retail_project.dim_product: COMMIT
[0m12:09:01.506388 [debug] [Thread-3 (]: On model.retail_project.dim_store: COMMIT
[0m12:09:01.511651 [debug] [Thread-4 (]: On model.retail_project.dim_customer: COMMIT
[0m12:09:01.513150 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:09:01.519096 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:09:01.522357 [debug] [Thread-2 (]: On model.retail_project.dim_product: COMMIT
[0m12:09:01.524800 [debug] [Thread-4 (]: On model.retail_project.dim_customer: COMMIT
[0m12:09:01.526769 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m12:09:01.536611 [debug] [Thread-3 (]: Applying DROP to: "retail_dwh"."marts_marts"."dim_store__dbt_backup"
[0m12:09:01.540565 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:09:01.544388 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m12:09:01.545969 [debug] [Thread-3 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */
drop view if exists "retail_dwh"."marts_marts"."dim_store__dbt_backup" cascade
[0m12:09:01.547389 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:09:01.553597 [debug] [Thread-4 (]: Applying DROP to: "retail_dwh"."marts_marts"."dim_customer__dbt_backup"
[0m12:09:01.559303 [debug] [Thread-2 (]: Applying DROP to: "retail_dwh"."marts_marts"."dim_product__dbt_backup"
[0m12:09:01.561991 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:09:01.565630 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:09:01.568624 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:09:01.572199 [debug] [Thread-3 (]: Timing info for model.retail_project.dim_store (execute): 12:09:01.345254 => 12:09:01.571891
[0m12:09:01.573794 [debug] [Thread-4 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */
drop view if exists "retail_dwh"."marts_marts"."dim_customer__dbt_backup" cascade
[0m12:09:01.576134 [debug] [Thread-2 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */
drop view if exists "retail_dwh"."marts_marts"."dim_product__dbt_backup" cascade
[0m12:09:01.578574 [debug] [Thread-3 (]: On model.retail_project.dim_store: Close
[0m12:09:01.585466 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7303cf8-227c-4c14-bace-ddafa4bff980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32d4757050>]}
[0m12:09:01.587335 [info ] [Thread-3 (]: 5 of 8 OK created sql view model marts_marts.dim_store ......................... [[32mCREATE VIEW[0m in 0.30s]
[0m12:09:01.589791 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:09:01.592147 [debug] [Thread-3 (]: Finished running node model.retail_project.dim_store
[0m12:09:01.594095 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:09:01.599493 [debug] [Thread-2 (]: Timing info for model.retail_project.dim_product (execute): 12:09:01.372164 => 12:09:01.599039
[0m12:09:01.605132 [debug] [Thread-4 (]: Timing info for model.retail_project.dim_customer (execute): 12:09:01.394876 => 12:09:01.604825
[0m12:09:01.607632 [debug] [Thread-2 (]: On model.retail_project.dim_product: Close
[0m12:09:01.611983 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7303cf8-227c-4c14-bace-ddafa4bff980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32d4b82570>]}
[0m12:09:01.609837 [debug] [Thread-4 (]: On model.retail_project.dim_customer: Close
[0m12:09:01.613347 [info ] [Thread-2 (]: 6 of 8 OK created sql view model marts_marts.dim_product ....................... [[32mCREATE VIEW[0m in 0.30s]
[0m12:09:01.617363 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7303cf8-227c-4c14-bace-ddafa4bff980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32d4757fb0>]}
[0m12:09:01.620376 [debug] [Thread-2 (]: Finished running node model.retail_project.dim_product
[0m12:09:01.623259 [info ] [Thread-4 (]: 7 of 8 OK created sql view model marts_marts.dim_customer ...................... [[32mCREATE VIEW[0m in 0.28s]
[0m12:09:01.626790 [debug] [Thread-4 (]: Finished running node model.retail_project.dim_customer
[0m12:09:01.632166 [debug] [Thread-1 (]: Began running node model.retail_project.fact_sales
[0m12:09:01.632920 [info ] [Thread-1 (]: 8 of 8 SKIP relation marts_marts.fact_sales .................................... [[33mSKIP[0m]
[0m12:09:01.633540 [debug] [Thread-1 (]: Finished running node model.retail_project.fact_sales
[0m12:09:01.641038 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:01.642104 [debug] [MainThread]: On master: BEGIN
[0m12:09:01.642551 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:09:01.662409 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:09:01.663209 [debug] [MainThread]: On master: COMMIT
[0m12:09:01.665406 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:01.666455 [debug] [MainThread]: On master: COMMIT
[0m12:09:01.668325 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:09:01.669255 [debug] [MainThread]: On master: Close
[0m12:09:01.670912 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:09:01.671373 [debug] [MainThread]: Connection 'model.retail_project.stg_customers' was properly closed.
[0m12:09:01.671727 [debug] [MainThread]: Connection 'model.retail_project.dim_product' was properly closed.
[0m12:09:01.672071 [debug] [MainThread]: Connection 'model.retail_project.dim_customer' was properly closed.
[0m12:09:01.673161 [debug] [MainThread]: Connection 'model.retail_project.dim_store' was properly closed.
[0m12:09:01.674190 [info ] [MainThread]: 
[0m12:09:01.674992 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 2.00 seconds (2.00s).
[0m12:09:01.678527 [debug] [MainThread]: Command end result
[0m12:09:01.701764 [info ] [MainThread]: 
[0m12:09:01.702564 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:09:01.703370 [info ] [MainThread]: 
[0m12:09:01.704164 [error] [MainThread]:   Database Error in model stg_sales_transaction (models/staging/stg_sales_transaction.sql)
  column "unit_price" does not exist
  LINE 15:         unit_price,
                   ^
  compiled Code at target/run/retail_project/models/staging/stg_sales_transaction.sql
[0m12:09:01.704952 [info ] [MainThread]: 
[0m12:09:01.705666 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=1 TOTAL=8
[0m12:09:01.707202 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.248455, "process_user_time": 4.362211, "process_kernel_time": 0.987083, "process_mem_max_rss": "151348", "process_out_blocks": "1824", "command_success": false, "process_in_blocks": "0"}
[0m12:09:01.707855 [debug] [MainThread]: Command `dbt run` failed at 12:09:01.707669 after 3.25 seconds
[0m12:09:01.708312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32d63a1f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32d53cd460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32dac0e7e0>]}
[0m12:09:01.708745 [debug] [MainThread]: Flushing usage events
[0m12:14:08.606105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6b8e19a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6b8f09f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6b8ee4fe0>]}


============================== 12:14:08.617206 | b9b3e063-55ea-4d94-9094-33a92f810cd8 ==============================
[0m12:14:08.617206 [info ] [MainThread]: Running with dbt=1.7.0
[0m12:14:08.619335 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/dbt/retail_project/retail_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /root/.dbt', 'send_anonymous_usage_stats': 'True'}
[0m12:14:09.000918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9b3e063-55ea-4d94-9094-33a92f810cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6b8536f60>]}
[0m12:14:09.220341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9b3e063-55ea-4d94-9094-33a92f810cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6b8c82960>]}
[0m12:14:09.221630 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m12:14:09.244992 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m12:14:09.312079 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:14:09.312919 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:14:09.314217 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail_project.intermediate
[0m12:14:09.331526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9b3e063-55ea-4d94-9094-33a92f810cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6b8537ad0>]}
[0m12:14:09.354666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9b3e063-55ea-4d94-9094-33a92f810cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6b819c920>]}
[0m12:14:09.355252 [info ] [MainThread]: Found 8 models, 4 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:14:09.357812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9b3e063-55ea-4d94-9094-33a92f810cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6b8d393a0>]}
[0m12:14:09.363591 [info ] [MainThread]: 
[0m12:14:09.365709 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:14:09.368297 [debug] [ThreadPool]: Acquiring new postgres connection 'list_retail_dwh'
[0m12:14:09.380781 [debug] [ThreadPool]: Acquiring new postgres connection 'list_retail_dwh'
[0m12:14:09.391936 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh"
[0m12:14:09.392879 [debug] [ThreadPool]: On list_retail_dwh: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh"} */

    select distinct nspname from pg_namespace
  
[0m12:14:09.393479 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:14:09.396953 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh"
[0m12:14:09.397953 [debug] [ThreadPool]: On list_retail_dwh: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh"} */

    select distinct nspname from pg_namespace
  
[0m12:14:09.398699 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:14:09.412767 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m12:14:09.417335 [debug] [ThreadPool]: On list_retail_dwh: Close
[0m12:14:09.420265 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m12:14:09.421904 [debug] [ThreadPool]: On list_retail_dwh: Close
[0m12:14:09.429950 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_dwh, now list_retail_dwh_marts_staging)
[0m12:14:09.439306 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_dwh, now list_retail_dwh_marts_marts)
[0m12:14:09.446130 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_marts"
[0m12:14:09.447836 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: BEGIN
[0m12:14:09.449528 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:14:09.453899 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_staging"
[0m12:14:09.454320 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: BEGIN
[0m12:14:09.454957 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:14:09.464103 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:14:09.464670 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_marts"
[0m12:14:09.465033 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh_marts_marts"} */
select
      'retail_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'retail_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'retail_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m12:14:09.467781 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:14:09.468921 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_staging"
[0m12:14:09.469468 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh_marts_staging"} */
select
      'retail_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'retail_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'retail_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m12:14:09.472990 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m12:14:09.475500 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: ROLLBACK
[0m12:14:09.478169 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:14:09.480898 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: ROLLBACK
[0m12:14:09.482355 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: Close
[0m12:14:09.483369 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: Close
[0m12:14:09.496698 [debug] [MainThread]: Using postgres connection "master"
[0m12:14:09.497149 [debug] [MainThread]: On master: BEGIN
[0m12:14:09.497446 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:14:09.510921 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:14:09.511495 [debug] [MainThread]: Using postgres connection "master"
[0m12:14:09.511890 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:14:09.546106 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m12:14:09.551961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9b3e063-55ea-4d94-9094-33a92f810cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6b8f09b20>]}
[0m12:14:09.554145 [debug] [MainThread]: On master: ROLLBACK
[0m12:14:09.556604 [debug] [MainThread]: Using postgres connection "master"
[0m12:14:09.557379 [debug] [MainThread]: On master: BEGIN
[0m12:14:09.559645 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:14:09.561214 [debug] [MainThread]: On master: COMMIT
[0m12:14:09.561564 [debug] [MainThread]: Using postgres connection "master"
[0m12:14:09.562909 [debug] [MainThread]: On master: COMMIT
[0m12:14:09.564810 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:14:09.565259 [debug] [MainThread]: On master: Close
[0m12:14:09.566115 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:14:09.566954 [info ] [MainThread]: 
[0m12:14:09.578571 [debug] [Thread-1 (]: Began running node model.retail_project.stg_customers
[0m12:14:09.579315 [info ] [Thread-1 (]: 1 of 8 START sql view model marts_staging.stg_customers ........................ [RUN]
[0m12:14:09.580195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail_dwh_marts_staging, now model.retail_project.stg_customers)
[0m12:14:09.581190 [debug] [Thread-1 (]: Began compiling node model.retail_project.stg_customers
[0m12:14:09.592374 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_project.stg_customers"
[0m12:14:09.596723 [debug] [Thread-2 (]: Began running node model.retail_project.stg_products
[0m12:14:09.598930 [info ] [Thread-2 (]: 2 of 8 START sql view model marts_staging.stg_products ......................... [RUN]
[0m12:14:09.601598 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_retail_dwh_marts_marts, now model.retail_project.stg_products)
[0m12:14:09.603053 [debug] [Thread-3 (]: Began running node model.retail_project.stg_sales_transaction
[0m12:14:09.605245 [debug] [Thread-2 (]: Began compiling node model.retail_project.stg_products
[0m12:14:09.607455 [debug] [Thread-4 (]: Began running node model.retail_project.stg_stores
[0m12:14:09.608424 [debug] [Thread-1 (]: Timing info for model.retail_project.stg_customers (compile): 12:14:09.581769 => 12:14:09.608086
[0m12:14:09.610360 [info ] [Thread-3 (]: 3 of 8 START sql view model marts_staging.stg_sales_transaction ................ [RUN]
[0m12:14:09.620244 [info ] [Thread-4 (]: 4 of 8 START sql view model marts_staging.stg_stores ........................... [RUN]
[0m12:14:09.629349 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.retail_project.stg_stores'
[0m12:14:09.624422 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_project.stg_products"
[0m12:14:09.627401 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.retail_project.stg_sales_transaction'
[0m12:14:09.622510 [debug] [Thread-1 (]: Began executing node model.retail_project.stg_customers
[0m12:14:09.630644 [debug] [Thread-4 (]: Began compiling node model.retail_project.stg_stores
[0m12:14:09.632216 [debug] [Thread-3 (]: Began compiling node model.retail_project.stg_sales_transaction
[0m12:14:09.645504 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_project.stg_stores"
[0m12:14:09.647409 [debug] [Thread-2 (]: Timing info for model.retail_project.stg_products (compile): 12:14:09.613076 => 12:14:09.646414
[0m12:14:09.696196 [debug] [Thread-2 (]: Began executing node model.retail_project.stg_products
[0m12:14:09.686945 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_project.stg_sales_transaction"
[0m12:14:09.723661 [debug] [Thread-4 (]: Timing info for model.retail_project.stg_stores (compile): 12:14:09.641711 => 12:14:09.721651
[0m12:14:09.724970 [debug] [Thread-4 (]: Began executing node model.retail_project.stg_stores
[0m12:14:09.737711 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_project.stg_products"
[0m12:14:09.742673 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_project.stg_customers"
[0m12:14:09.751182 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_project.stg_stores"
[0m12:14:09.753844 [debug] [Thread-3 (]: Timing info for model.retail_project.stg_sales_transaction (compile): 12:14:09.681516 => 12:14:09.753371
[0m12:14:09.755826 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:14:09.761668 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:14:09.763133 [debug] [Thread-3 (]: Began executing node model.retail_project.stg_sales_transaction
[0m12:14:09.764201 [debug] [Thread-2 (]: On model.retail_project.stg_products: BEGIN
[0m12:14:09.765535 [debug] [Thread-1 (]: On model.retail_project.stg_customers: BEGIN
[0m12:14:09.773079 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:14:09.781139 [debug] [Thread-4 (]: On model.retail_project.stg_stores: BEGIN
[0m12:14:09.778891 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_project.stg_sales_transaction"
[0m12:14:09.780158 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:14:09.782070 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:14:09.774500 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:14:09.785297 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m12:14:09.788141 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: BEGIN
[0m12:14:09.789016 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:14:09.811185 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:14:09.812669 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:14:09.814079 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */

  create view "retail_dwh"."marts_staging"."stg_customers__dbt_tmp"
    
    
  as (
    SELECT
    customer_id,
    customer_name,
    UPPER(TRIM(gender)) AS customer_gender,
    TRIM(city) AS customer_city,
    CAST(signup_date AS DATE) AS customer_signup_date
FROM
    "retail_dwh"."raw"."customers_raw"
  );
[0m12:14:09.816522 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:14:09.817355 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:14:09.818153 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */

  create view "retail_dwh"."marts_staging"."stg_products__dbt_tmp"
    
    
  as (
    SELECT
    product_id,
    product_name,
    TRIM(category) AS product_category,
    TRIM(sub_category) AS product_sub_category,
    CAST(price AS NUMERIC) AS product_price
FROM
    "retail_dwh"."raw"."products_raw"
  );
[0m12:14:09.820339 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:14:09.830320 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:14:09.845718 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:14:09.846951 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:14:09.849246 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
alter table "retail_dwh"."marts_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m12:14:09.853480 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:14:09.855997 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:14:09.857024 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:14:09.863795 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m12:14:09.862077 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */

  create view "retail_dwh"."marts_staging"."stg_stores__dbt_tmp"
    
    
  as (
    with source as (
    select
        store_id,
        store_name,
        city,
        region
    from "retail_dwh"."raw"."stores_raw"
),

renamed as (
    select
        store_id,
        store_name,
        city,
        region as store_region
    from source
)

select * from renamed
  );
[0m12:14:09.863163 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:14:09.859266 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
alter table "retail_dwh"."marts_staging"."stg_products" rename to "stg_products__dbt_backup"
[0m12:14:09.865823 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */

  create view "retail_dwh"."marts_staging"."stg_sales_transaction__dbt_tmp"
    
    
  as (
    with source as (
    select
        transaction_id,
        customer_id,
        product_id,
        store_id,
        transaction_date,
        quantity,
        unit_price,
        payment_method
    from "retail_dwh"."raw"."sales_transaction_raw"
),

typed as (
    select
        transaction_id,
        customer_id,
        product_id,
        store_id,
        transaction_date::date        as transaction_date,
        quantity::integer             as quantity,
        unit_price::numeric(18,2)     as unit_price,
        payment_method
    from source
)

select * from typed
  );
[0m12:14:09.870180 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:14:09.983880 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:14:09.984995 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:14:10.004379 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:14:09.996937 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
alter table "retail_dwh"."marts_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m12:14:09.998752 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "unit_price" does not exist
LINE 15:         unit_price,
                 ^

[0m12:14:09.994749 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:14:10.009270 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: ROLLBACK
[0m12:14:10.010884 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
alter table "retail_dwh"."marts_staging"."stg_stores" rename to "stg_stores__dbt_backup"
[0m12:14:10.006794 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
alter table "retail_dwh"."marts_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m12:14:10.012183 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:14:10.028225 [debug] [Thread-3 (]: Timing info for model.retail_project.stg_sales_transaction (execute): 12:14:09.766359 => 12:14:10.027665
[0m12:14:10.031289 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: Close
[0m12:14:10.029097 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:14:10.029941 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:14:10.080569 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:14:10.106486 [debug] [Thread-2 (]: On model.retail_project.stg_products: COMMIT
[0m12:14:10.109035 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
alter table "retail_dwh"."marts_staging"."stg_stores__dbt_tmp" rename to "stg_stores"
[0m12:14:10.108056 [debug] [Thread-1 (]: On model.retail_project.stg_customers: COMMIT
[0m12:14:10.111913 [debug] [Thread-3 (]: Database Error in model stg_sales_transaction (models/staging/stg_sales_transaction.sql)
  column "unit_price" does not exist
  LINE 15:         unit_price,
                   ^
  compiled Code at target/run/retail_project/models/staging/stg_sales_transaction.sql
[0m12:14:10.112646 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:14:10.113760 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:14:10.118976 [debug] [Thread-2 (]: On model.retail_project.stg_products: COMMIT
[0m12:14:10.117531 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9b3e063-55ea-4d94-9094-33a92f810cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6b8110da0>]}
[0m12:14:10.121090 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:14:10.134838 [debug] [Thread-4 (]: On model.retail_project.stg_stores: COMMIT
[0m12:14:10.129120 [error] [Thread-3 (]: 3 of 8 ERROR creating sql view model marts_staging.stg_sales_transaction ....... [[31mERROR[0m in 0.49s]
[0m12:14:10.138317 [debug] [Thread-3 (]: Finished running node model.retail_project.stg_sales_transaction
[0m12:14:10.122465 [debug] [Thread-1 (]: On model.retail_project.stg_customers: COMMIT
[0m12:14:10.135561 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:14:10.132046 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:14:10.142532 [debug] [Thread-4 (]: On model.retail_project.stg_stores: COMMIT
[0m12:14:10.160133 [debug] [Thread-2 (]: Applying DROP to: "retail_dwh"."marts_staging"."stg_products__dbt_backup"
[0m12:14:10.170461 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:14:10.171288 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
drop view if exists "retail_dwh"."marts_staging"."stg_products__dbt_backup" cascade
[0m12:14:10.171989 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m12:14:10.179865 [debug] [Thread-4 (]: Applying DROP to: "retail_dwh"."marts_staging"."stg_stores__dbt_backup"
[0m12:14:10.180655 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:14:10.185310 [debug] [Thread-1 (]: Applying DROP to: "retail_dwh"."marts_staging"."stg_customers__dbt_backup"
[0m12:14:10.181961 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:14:10.186848 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:14:10.187590 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:14:10.191770 [debug] [Thread-2 (]: Timing info for model.retail_project.stg_products (execute): 12:14:09.696759 => 12:14:10.191485
[0m12:14:10.189235 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
drop view if exists "retail_dwh"."marts_staging"."stg_customers__dbt_backup" cascade
[0m12:14:10.188304 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
drop view if exists "retail_dwh"."marts_staging"."stg_stores__dbt_backup" cascade
[0m12:14:10.192812 [debug] [Thread-2 (]: On model.retail_project.stg_products: Close
[0m12:14:10.201827 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9b3e063-55ea-4d94-9094-33a92f810cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6b7981cd0>]}
[0m12:14:10.202606 [info ] [Thread-2 (]: 2 of 8 OK created sql view model marts_staging.stg_products .................... [[32mCREATE VIEW[0m in 0.60s]
[0m12:14:10.205198 [debug] [Thread-2 (]: Finished running node model.retail_project.stg_products
[0m12:14:10.206995 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:14:10.211343 [debug] [Thread-1 (]: Timing info for model.retail_project.stg_customers (execute): 12:14:09.633169 => 12:14:10.211076
[0m12:14:10.211922 [debug] [Thread-1 (]: On model.retail_project.stg_customers: Close
[0m12:14:10.208420 [debug] [Thread-3 (]: Began running node model.retail_project.dim_product
[0m12:14:10.215773 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:14:10.218963 [info ] [Thread-3 (]: 5 of 8 START sql view model marts_marts.dim_product ............................ [RUN]
[0m12:14:10.223919 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_sales_transaction, now model.retail_project.dim_product)
[0m12:14:10.222861 [debug] [Thread-4 (]: Timing info for model.retail_project.stg_stores (execute): 12:14:09.743920 => 12:14:10.222602
[0m12:14:10.224610 [debug] [Thread-3 (]: Began compiling node model.retail_project.dim_product
[0m12:14:10.220477 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9b3e063-55ea-4d94-9094-33a92f810cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6b792e600>]}
[0m12:14:10.225535 [debug] [Thread-4 (]: On model.retail_project.stg_stores: Close
[0m12:14:10.232484 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9b3e063-55ea-4d94-9094-33a92f810cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6b790c890>]}
[0m12:14:10.230263 [info ] [Thread-1 (]: 1 of 8 OK created sql view model marts_staging.stg_customers ................... [[32mCREATE VIEW[0m in 0.64s]
[0m12:14:10.229256 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_project.dim_product"
[0m12:14:10.234919 [debug] [Thread-1 (]: Finished running node model.retail_project.stg_customers
[0m12:14:10.241090 [debug] [Thread-3 (]: Timing info for model.retail_project.dim_product (compile): 12:14:10.226178 => 12:14:10.240469
[0m12:14:10.241769 [debug] [Thread-3 (]: Began executing node model.retail_project.dim_product
[0m12:14:10.247456 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_project.dim_product"
[0m12:14:10.233669 [info ] [Thread-4 (]: 4 of 8 OK created sql view model marts_staging.stg_stores ...................... [[32mCREATE VIEW[0m in 0.60s]
[0m12:14:10.249511 [debug] [Thread-4 (]: Finished running node model.retail_project.stg_stores
[0m12:14:10.248493 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:14:10.251561 [debug] [Thread-3 (]: On model.retail_project.dim_product: BEGIN
[0m12:14:10.253377 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:14:10.254976 [debug] [Thread-2 (]: Began running node model.retail_project.dim_customer
[0m12:14:10.259567 [debug] [Thread-1 (]: Began running node model.retail_project.dim_store
[0m12:14:10.258193 [info ] [Thread-2 (]: 6 of 8 START sql view model marts_marts.dim_customer ........................... [RUN]
[0m12:14:10.267725 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_products, now model.retail_project.dim_customer)
[0m12:14:10.269015 [debug] [Thread-2 (]: Began compiling node model.retail_project.dim_customer
[0m12:14:10.261312 [info ] [Thread-1 (]: 7 of 8 START sql view model marts_marts.dim_store .............................. [RUN]
[0m12:14:10.276548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_customers, now model.retail_project.dim_store)
[0m12:14:10.272662 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_project.dim_customer"
[0m12:14:10.278684 [debug] [Thread-1 (]: Began compiling node model.retail_project.dim_store
[0m12:14:10.285963 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_project.dim_store"
[0m12:14:10.288821 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:14:10.289754 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:14:10.290759 [debug] [Thread-3 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */

  create view "retail_dwh"."marts_marts"."dim_product__dbt_tmp"
    
    
  as (
    SELECT
    product_id,
    product_name,
    product_category,
    product_sub_category,
    product_price
FROM
    "retail_dwh"."marts_staging"."stg_products"
  );
[0m12:14:10.292531 [debug] [Thread-1 (]: Timing info for model.retail_project.dim_store (compile): 12:14:10.281697 => 12:14:10.291734
[0m12:14:10.293726 [debug] [Thread-1 (]: Began executing node model.retail_project.dim_store
[0m12:14:10.302685 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_project.dim_store"
[0m12:14:10.303591 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:14:10.307709 [debug] [Thread-2 (]: Timing info for model.retail_project.dim_customer (compile): 12:14:10.269615 => 12:14:10.305991
[0m12:14:10.309266 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:14:10.317157 [debug] [Thread-2 (]: Began executing node model.retail_project.dim_customer
[0m12:14:10.318685 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:14:10.331515 [debug] [Thread-3 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */
alter table "retail_dwh"."marts_marts"."dim_product__dbt_tmp" rename to "dim_product"
[0m12:14:10.330190 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_project.dim_customer"
[0m12:14:10.319632 [debug] [Thread-1 (]: On model.retail_project.dim_store: BEGIN
[0m12:14:10.337859 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:14:10.336468 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:14:10.334804 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:14:10.339137 [debug] [Thread-2 (]: On model.retail_project.dim_customer: BEGIN
[0m12:14:10.344249 [debug] [Thread-3 (]: On model.retail_project.dim_product: COMMIT
[0m12:14:10.346654 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:14:10.347322 [debug] [Thread-3 (]: On model.retail_project.dim_product: COMMIT
[0m12:14:10.345601 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:14:10.357341 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m12:14:10.368285 [debug] [Thread-3 (]: Applying DROP to: "retail_dwh"."marts_marts"."dim_product__dbt_backup"
[0m12:14:10.373175 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:14:10.375585 [debug] [Thread-3 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */
drop view if exists "retail_dwh"."marts_marts"."dim_product__dbt_backup" cascade
[0m12:14:10.376535 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:14:10.377741 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:14:10.378467 [debug] [Thread-1 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */

  create view "retail_dwh"."marts_marts"."dim_store__dbt_tmp"
    
    
  as (
    select
    store_id,
    store_name,
    city as store_city,
    store_region
from "retail_dwh"."marts_staging"."stg_stores"
  );
[0m12:14:10.381428 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:14:10.382220 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:14:10.383428 [debug] [Thread-2 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */

  create view "retail_dwh"."marts_marts"."dim_customer__dbt_tmp"
    
    
  as (
    SELECT
    customer_id,
    customer_name,
    customer_gender,
    customer_city,
    customer_signup_date
FROM
    "retail_dwh"."marts_staging"."stg_customers"
  );
[0m12:14:10.384819 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:14:10.387640 [debug] [Thread-3 (]: Timing info for model.retail_project.dim_product (execute): 12:14:10.242307 => 12:14:10.387256
[0m12:14:10.388382 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:14:10.391561 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:14:10.401592 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:14:10.395050 [debug] [Thread-3 (]: On model.retail_project.dim_product: Close
[0m12:14:10.413068 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:14:10.414792 [debug] [Thread-2 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */
alter table "retail_dwh"."marts_marts"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m12:14:10.411086 [debug] [Thread-1 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */
alter table "retail_dwh"."marts_marts"."dim_store__dbt_tmp" rename to "dim_store"
[0m12:14:10.419172 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9b3e063-55ea-4d94-9094-33a92f810cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6b757f650>]}
[0m12:14:10.420269 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:14:10.422318 [info ] [Thread-3 (]: 5 of 8 OK created sql view model marts_marts.dim_product ....................... [[32mCREATE VIEW[0m in 0.20s]
[0m12:14:10.428844 [debug] [Thread-2 (]: On model.retail_project.dim_customer: COMMIT
[0m12:14:10.432433 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:14:10.442800 [debug] [Thread-1 (]: On model.retail_project.dim_store: COMMIT
[0m12:14:10.436874 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:14:10.435755 [debug] [Thread-3 (]: Finished running node model.retail_project.dim_product
[0m12:14:10.443631 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:14:10.447144 [debug] [Thread-2 (]: On model.retail_project.dim_customer: COMMIT
[0m12:14:10.455918 [debug] [Thread-1 (]: On model.retail_project.dim_store: COMMIT
[0m12:14:10.462595 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:14:10.471523 [debug] [Thread-2 (]: Applying DROP to: "retail_dwh"."marts_marts"."dim_customer__dbt_backup"
[0m12:14:10.474016 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:14:10.474926 [debug] [Thread-2 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */
drop view if exists "retail_dwh"."marts_marts"."dim_customer__dbt_backup" cascade
[0m12:14:10.476862 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:14:10.483002 [debug] [Thread-1 (]: Applying DROP to: "retail_dwh"."marts_marts"."dim_store__dbt_backup"
[0m12:14:10.484873 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:14:10.490679 [debug] [Thread-2 (]: Timing info for model.retail_project.dim_customer (execute): 12:14:10.320399 => 12:14:10.490388
[0m12:14:10.491087 [debug] [Thread-2 (]: On model.retail_project.dim_customer: Close
[0m12:14:10.488552 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:14:10.494103 [debug] [Thread-1 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */
drop view if exists "retail_dwh"."marts_marts"."dim_store__dbt_backup" cascade
[0m12:14:10.495140 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:14:10.497558 [debug] [Thread-1 (]: Timing info for model.retail_project.dim_store (execute): 12:14:10.295758 => 12:14:10.497319
[0m12:14:10.498016 [debug] [Thread-1 (]: On model.retail_project.dim_store: Close
[0m12:14:10.500684 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9b3e063-55ea-4d94-9094-33a92f810cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6b850ccb0>]}
[0m12:14:10.501436 [info ] [Thread-2 (]: 6 of 8 OK created sql view model marts_marts.dim_customer ...................... [[32mCREATE VIEW[0m in 0.23s]
[0m12:14:10.505953 [debug] [Thread-2 (]: Finished running node model.retail_project.dim_customer
[0m12:14:10.507626 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9b3e063-55ea-4d94-9094-33a92f810cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6b7567380>]}
[0m12:14:10.508809 [info ] [Thread-1 (]: 7 of 8 OK created sql view model marts_marts.dim_store ......................... [[32mCREATE VIEW[0m in 0.23s]
[0m12:14:10.510357 [debug] [Thread-1 (]: Finished running node model.retail_project.dim_store
[0m12:14:10.512739 [debug] [Thread-4 (]: Began running node model.retail_project.fact_sales
[0m12:14:10.513340 [info ] [Thread-4 (]: 8 of 8 SKIP relation marts_marts.fact_sales .................................... [[33mSKIP[0m]
[0m12:14:10.514028 [debug] [Thread-4 (]: Finished running node model.retail_project.fact_sales
[0m12:14:10.518842 [debug] [MainThread]: Using postgres connection "master"
[0m12:14:10.519534 [debug] [MainThread]: On master: BEGIN
[0m12:14:10.519892 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:14:10.543761 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:14:10.545012 [debug] [MainThread]: On master: COMMIT
[0m12:14:10.545432 [debug] [MainThread]: Using postgres connection "master"
[0m12:14:10.545768 [debug] [MainThread]: On master: COMMIT
[0m12:14:10.547314 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:14:10.548003 [debug] [MainThread]: On master: Close
[0m12:14:10.549463 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:14:10.550131 [debug] [MainThread]: Connection 'model.retail_project.dim_store' was properly closed.
[0m12:14:10.550631 [debug] [MainThread]: Connection 'model.retail_project.dim_customer' was properly closed.
[0m12:14:10.551197 [debug] [MainThread]: Connection 'model.retail_project.dim_product' was properly closed.
[0m12:14:10.551680 [debug] [MainThread]: Connection 'model.retail_project.stg_stores' was properly closed.
[0m12:14:10.552403 [info ] [MainThread]: 
[0m12:14:10.553657 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 1.19 seconds (1.19s).
[0m12:14:10.557231 [debug] [MainThread]: Command end result
[0m12:14:10.572055 [info ] [MainThread]: 
[0m12:14:10.573222 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:14:10.573958 [info ] [MainThread]: 
[0m12:14:10.577355 [error] [MainThread]:   Database Error in model stg_sales_transaction (models/staging/stg_sales_transaction.sql)
  column "unit_price" does not exist
  LINE 15:         unit_price,
                   ^
  compiled Code at target/run/retail_project/models/staging/stg_sales_transaction.sql
[0m12:14:10.578808 [info ] [MainThread]: 
[0m12:14:10.580922 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=1 TOTAL=8
[0m12:14:10.582823 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.108502, "process_user_time": 4.132504, "process_kernel_time": 0.709857, "process_mem_max_rss": "151344", "process_out_blocks": "1832", "command_success": false, "process_in_blocks": "0"}
[0m12:14:10.583641 [debug] [MainThread]: Command `dbt run` failed at 12:14:10.583240 after 2.11 seconds
[0m12:14:10.584338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6b8f09f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6b75442f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6b8e9c140>]}
[0m12:14:10.585697 [debug] [MainThread]: Flushing usage events
[0m12:14:26.527802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8677535760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8677535640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86775352b0>]}


============================== 12:14:26.531547 | de2e78e8-cab0-46b5-a8fd-ca1437ca0e13 ==============================
[0m12:14:26.531547 [info ] [MainThread]: Running with dbt=1.7.0
[0m12:14:26.534715 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/dbt/retail_project/retail_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /root/.dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:14:26.784840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de2e78e8-cab0-46b5-a8fd-ca1437ca0e13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8676d2e990>]}
[0m12:14:26.905007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de2e78e8-cab0-46b5-a8fd-ca1437ca0e13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8677ea3470>]}
[0m12:14:26.905898 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m12:14:26.917385 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m12:14:26.950071 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:14:26.951035 [debug] [MainThread]: Partial parsing: updated file: retail_project://models/staging/stg_sales_transaction.sql
[0m12:14:27.164217 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail_project.intermediate
[0m12:14:27.171826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de2e78e8-cab0-46b5-a8fd-ca1437ca0e13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f867869aea0>]}
[0m12:14:27.194034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de2e78e8-cab0-46b5-a8fd-ca1437ca0e13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f867656d040>]}
[0m12:14:27.194628 [info ] [MainThread]: Found 8 models, 4 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:14:27.199522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de2e78e8-cab0-46b5-a8fd-ca1437ca0e13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8676ddcb00>]}
[0m12:14:27.202834 [info ] [MainThread]: 
[0m12:14:27.205605 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:14:27.208510 [debug] [ThreadPool]: Acquiring new postgres connection 'list_retail_dwh'
[0m12:14:27.222283 [debug] [ThreadPool]: Acquiring new postgres connection 'list_retail_dwh'
[0m12:14:27.230141 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh"
[0m12:14:27.234461 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh"
[0m12:14:27.236141 [debug] [ThreadPool]: On list_retail_dwh: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh"} */

    select distinct nspname from pg_namespace
  
[0m12:14:27.237845 [debug] [ThreadPool]: On list_retail_dwh: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh"} */

    select distinct nspname from pg_namespace
  
[0m12:14:27.238927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:14:27.240077 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:14:27.264055 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m12:14:27.266015 [debug] [ThreadPool]: On list_retail_dwh: Close
[0m12:14:27.267060 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m12:14:27.271966 [debug] [ThreadPool]: On list_retail_dwh: Close
[0m12:14:27.278603 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_dwh, now list_retail_dwh_marts_marts)
[0m12:14:27.286593 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_dwh, now list_retail_dwh_marts_staging)
[0m12:14:27.361564 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_staging"
[0m12:14:27.364519 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_marts"
[0m12:14:27.367145 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: BEGIN
[0m12:14:27.368549 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: BEGIN
[0m12:14:27.369780 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:14:27.371195 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:14:27.388294 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:14:27.388965 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_marts"
[0m12:14:27.391842 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:14:27.393271 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh_marts_marts"} */
select
      'retail_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'retail_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'retail_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m12:14:27.395145 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_staging"
[0m12:14:27.396835 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh_marts_staging"} */
select
      'retail_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'retail_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'retail_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m12:14:27.401897 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m12:14:27.404143 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: ROLLBACK
[0m12:14:27.404960 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:14:27.409119 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: Close
[0m12:14:27.414388 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: ROLLBACK
[0m12:14:27.419420 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: Close
[0m12:14:27.436478 [debug] [MainThread]: Using postgres connection "master"
[0m12:14:27.437394 [debug] [MainThread]: On master: BEGIN
[0m12:14:27.437822 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:14:27.458287 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:14:27.458770 [debug] [MainThread]: Using postgres connection "master"
[0m12:14:27.459841 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:14:27.506951 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m12:14:27.511713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de2e78e8-cab0-46b5-a8fd-ca1437ca0e13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8675d48620>]}
[0m12:14:27.512736 [debug] [MainThread]: On master: ROLLBACK
[0m12:14:27.514814 [debug] [MainThread]: Using postgres connection "master"
[0m12:14:27.515341 [debug] [MainThread]: On master: BEGIN
[0m12:14:27.518075 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:14:27.518577 [debug] [MainThread]: On master: COMMIT
[0m12:14:27.518926 [debug] [MainThread]: Using postgres connection "master"
[0m12:14:27.519251 [debug] [MainThread]: On master: COMMIT
[0m12:14:27.520645 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:14:27.521033 [debug] [MainThread]: On master: Close
[0m12:14:27.523003 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:14:27.523649 [info ] [MainThread]: 
[0m12:14:27.535272 [debug] [Thread-1 (]: Began running node model.retail_project.stg_customers
[0m12:14:27.536799 [debug] [Thread-2 (]: Began running node model.retail_project.stg_products
[0m12:14:27.538073 [info ] [Thread-1 (]: 1 of 8 START sql view model marts_staging.stg_customers ........................ [RUN]
[0m12:14:27.539452 [debug] [Thread-3 (]: Began running node model.retail_project.stg_sales_transaction
[0m12:14:27.544909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail_dwh_marts_staging, now model.retail_project.stg_customers)
[0m12:14:27.546990 [debug] [Thread-4 (]: Began running node model.retail_project.stg_stores
[0m12:14:27.543163 [info ] [Thread-2 (]: 2 of 8 START sql view model marts_staging.stg_products ......................... [RUN]
[0m12:14:27.548951 [info ] [Thread-3 (]: 3 of 8 START sql view model marts_staging.stg_sales_transaction ................ [RUN]
[0m12:14:27.551116 [debug] [Thread-1 (]: Began compiling node model.retail_project.stg_customers
[0m12:14:27.552808 [info ] [Thread-4 (]: 4 of 8 START sql view model marts_staging.stg_stores ........................... [RUN]
[0m12:14:27.554704 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_retail_dwh_marts_marts, now model.retail_project.stg_products)
[0m12:14:27.557673 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.retail_project.stg_sales_transaction'
[0m12:14:27.568404 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_project.stg_customers"
[0m12:14:27.571455 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.retail_project.stg_stores'
[0m12:14:27.572925 [debug] [Thread-2 (]: Began compiling node model.retail_project.stg_products
[0m12:14:27.583496 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_project.stg_products"
[0m12:14:27.576059 [debug] [Thread-4 (]: Began compiling node model.retail_project.stg_stores
[0m12:14:27.574110 [debug] [Thread-3 (]: Began compiling node model.retail_project.stg_sales_transaction
[0m12:14:27.578923 [debug] [Thread-1 (]: Timing info for model.retail_project.stg_customers (compile): 12:14:27.559048 => 12:14:27.577466
[0m12:14:27.588021 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_project.stg_stores"
[0m12:14:27.593514 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_project.stg_sales_transaction"
[0m12:14:27.598842 [debug] [Thread-2 (]: Timing info for model.retail_project.stg_products (compile): 12:14:27.580379 => 12:14:27.598464
[0m12:14:27.597203 [debug] [Thread-1 (]: Began executing node model.retail_project.stg_customers
[0m12:14:27.602033 [debug] [Thread-2 (]: Began executing node model.retail_project.stg_products
[0m12:14:27.643779 [debug] [Thread-4 (]: Timing info for model.retail_project.stg_stores (compile): 12:14:27.584820 => 12:14:27.642889
[0m12:14:27.645594 [debug] [Thread-3 (]: Timing info for model.retail_project.stg_sales_transaction (compile): 12:14:27.589103 => 12:14:27.644270
[0m12:14:27.689543 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_project.stg_products"
[0m12:14:27.700251 [debug] [Thread-4 (]: Began executing node model.retail_project.stg_stores
[0m12:14:27.703699 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_project.stg_customers"
[0m12:14:27.705754 [debug] [Thread-3 (]: Began executing node model.retail_project.stg_sales_transaction
[0m12:14:27.717232 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_project.stg_stores"
[0m12:14:27.722996 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:14:27.731349 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_project.stg_sales_transaction"
[0m12:14:27.735001 [debug] [Thread-1 (]: On model.retail_project.stg_customers: BEGIN
[0m12:14:27.736331 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:14:27.739334 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:14:27.742059 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:14:27.743303 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m12:14:27.744865 [debug] [Thread-2 (]: On model.retail_project.stg_products: BEGIN
[0m12:14:27.747081 [debug] [Thread-4 (]: On model.retail_project.stg_stores: BEGIN
[0m12:14:27.748557 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: BEGIN
[0m12:14:27.750755 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:14:27.752145 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:14:27.753712 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:14:27.764103 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:14:27.765220 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:14:27.766783 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */

  create view "retail_dwh"."marts_staging"."stg_customers__dbt_tmp"
    
    
  as (
    SELECT
    customer_id,
    customer_name,
    UPPER(TRIM(gender)) AS customer_gender,
    TRIM(city) AS customer_city,
    CAST(signup_date AS DATE) AS customer_signup_date
FROM
    "retail_dwh"."raw"."customers_raw"
  );
[0m12:14:27.769451 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:14:27.786995 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:14:27.788400 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m12:14:27.794839 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:14:27.797108 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */

  create view "retail_dwh"."marts_staging"."stg_sales_transaction__dbt_tmp"
    
    
  as (
    with source as (
    select
        transaction_id,
        transaction_date,
        customer_id,
        product_id,
        store_id,
        quantity,
        total_price
    from "retail_dwh"."raw"."sales_transaction_raw"
),

typed as (
    select
        transaction_id,
        customer_id,
        product_id,
        store_id,
        transaction_date::date        as transaction_date,
        quantity::integer             as quantity,
        total_price::numeric(18,2)    as total_price,
        case
            when quantity::numeric <> 0
                then total_price::numeric(18,2) / quantity::numeric
            else null
        end                           as unit_price
    from source
)

select * from typed
  );
[0m12:14:27.798767 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:14:27.800147 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
alter table "retail_dwh"."marts_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m12:14:27.802346 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:14:27.804546 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:14:27.806629 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */

  create view "retail_dwh"."marts_staging"."stg_products__dbt_tmp"
    
    
  as (
    SELECT
    product_id,
    product_name,
    TRIM(category) AS product_category,
    TRIM(sub_category) AS product_sub_category,
    CAST(price AS NUMERIC) AS product_price
FROM
    "retail_dwh"."raw"."products_raw"
  );
[0m12:14:27.807702 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:14:27.808951 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:14:27.809974 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:14:27.817416 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m12:14:27.820460 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:14:27.830529 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */

  create view "retail_dwh"."marts_staging"."stg_stores__dbt_tmp"
    
    
  as (
    with source as (
    select
        store_id,
        store_name,
        city,
        region
    from "retail_dwh"."raw"."stores_raw"
),

renamed as (
    select
        store_id,
        store_name,
        city,
        region as store_region
    from source
)

select * from renamed
  );
[0m12:14:27.834467 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:14:27.835685 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */
alter table "retail_dwh"."marts_staging"."stg_sales_transaction" rename to "stg_sales_transaction__dbt_backup"
[0m12:14:27.841582 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:14:27.844418 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
alter table "retail_dwh"."marts_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m12:14:27.847532 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
alter table "retail_dwh"."marts_staging"."stg_products" rename to "stg_products__dbt_backup"
[0m12:14:27.849042 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:14:27.850838 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:14:27.860063 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:14:27.865944 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m12:14:27.867351 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:14:27.875455 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:14:27.884838 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */
alter table "retail_dwh"."marts_staging"."stg_sales_transaction__dbt_tmp" rename to "stg_sales_transaction"
[0m12:14:27.889101 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:14:27.899122 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
alter table "retail_dwh"."marts_staging"."stg_stores" rename to "stg_stores__dbt_backup"
[0m12:14:27.919686 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
alter table "retail_dwh"."marts_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m12:14:27.939007 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:14:27.942360 [debug] [Thread-1 (]: On model.retail_project.stg_customers: COMMIT
[0m12:14:27.947780 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:14:27.954298 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: COMMIT
[0m12:14:27.955625 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:14:27.957809 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:14:27.962942 [debug] [Thread-2 (]: On model.retail_project.stg_products: COMMIT
[0m12:14:27.964854 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m12:14:27.966281 [debug] [Thread-1 (]: On model.retail_project.stg_customers: COMMIT
[0m12:14:27.972075 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:14:27.973986 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:14:27.975114 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: COMMIT
[0m12:14:27.978025 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
alter table "retail_dwh"."marts_staging"."stg_stores__dbt_tmp" rename to "stg_stores"
[0m12:14:27.980183 [debug] [Thread-2 (]: On model.retail_project.stg_products: COMMIT
[0m12:14:27.982244 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:14:27.985995 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m12:14:27.987966 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:14:27.999574 [debug] [Thread-1 (]: Applying DROP to: "retail_dwh"."marts_staging"."stg_customers__dbt_backup"
[0m12:14:28.007522 [debug] [Thread-3 (]: Applying DROP to: "retail_dwh"."marts_staging"."stg_sales_transaction__dbt_backup"
[0m12:14:28.009846 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:14:28.014610 [debug] [Thread-4 (]: On model.retail_project.stg_stores: COMMIT
[0m12:14:28.025982 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:14:28.029164 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m12:14:28.036122 [debug] [Thread-2 (]: Applying DROP to: "retail_dwh"."marts_staging"."stg_products__dbt_backup"
[0m12:14:28.038708 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:14:28.041120 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
drop view if exists "retail_dwh"."marts_staging"."stg_customers__dbt_backup" cascade
[0m12:14:28.042326 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */
drop view if exists "retail_dwh"."marts_staging"."stg_sales_transaction__dbt_backup" cascade
[0m12:14:28.046302 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:14:28.049043 [debug] [Thread-4 (]: On model.retail_project.stg_stores: COMMIT
[0m12:14:28.052210 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
drop view if exists "retail_dwh"."marts_staging"."stg_products__dbt_backup" cascade
[0m12:14:28.057426 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:14:28.064117 [debug] [Thread-3 (]: Timing info for model.retail_project.stg_sales_transaction (execute): 12:14:27.723948 => 12:14:28.063425
[0m12:14:28.065768 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m12:14:28.067000 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:14:28.069086 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: Close
[0m12:14:28.073654 [debug] [Thread-4 (]: Applying DROP to: "retail_dwh"."marts_staging"."stg_stores__dbt_backup"
[0m12:14:28.075067 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:14:28.079070 [debug] [Thread-2 (]: Timing info for model.retail_project.stg_products (execute): 12:14:27.614931 => 12:14:28.078770
[0m12:14:28.082341 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de2e78e8-cab0-46b5-a8fd-ca1437ca0e13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86769aeea0>]}
[0m12:14:28.085208 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:14:28.093582 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
drop view if exists "retail_dwh"."marts_staging"."stg_stores__dbt_backup" cascade
[0m12:14:28.090154 [debug] [Thread-2 (]: On model.retail_project.stg_products: Close
[0m12:14:28.092233 [info ] [Thread-3 (]: 3 of 8 OK created sql view model marts_staging.stg_sales_transaction ........... [[32mCREATE VIEW[0m in 0.53s]
[0m12:14:28.089062 [debug] [Thread-1 (]: Timing info for model.retail_project.stg_customers (execute): 12:14:27.603259 => 12:14:28.088537
[0m12:14:28.097589 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de2e78e8-cab0-46b5-a8fd-ca1437ca0e13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86759461b0>]}
[0m12:14:28.101234 [debug] [Thread-3 (]: Finished running node model.retail_project.stg_sales_transaction
[0m12:14:28.104382 [debug] [Thread-1 (]: On model.retail_project.stg_customers: Close
[0m12:14:28.106130 [info ] [Thread-2 (]: 2 of 8 OK created sql view model marts_staging.stg_products .................... [[32mCREATE VIEW[0m in 0.54s]
[0m12:14:28.107485 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:14:28.111117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de2e78e8-cab0-46b5-a8fd-ca1437ca0e13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8675d9e0c0>]}
[0m12:14:28.116154 [debug] [Thread-2 (]: Finished running node model.retail_project.stg_products
[0m12:14:28.121524 [debug] [Thread-4 (]: Timing info for model.retail_project.stg_stores (execute): 12:14:27.707363 => 12:14:28.121206
[0m12:14:28.124134 [info ] [Thread-1 (]: 1 of 8 OK created sql view model marts_staging.stg_customers ................... [[32mCREATE VIEW[0m in 0.57s]
[0m12:14:28.126162 [debug] [Thread-4 (]: On model.retail_project.stg_stores: Close
[0m12:14:28.129342 [debug] [Thread-1 (]: Finished running node model.retail_project.stg_customers
[0m12:14:28.131958 [debug] [Thread-3 (]: Began running node model.retail_project.dim_product
[0m12:14:28.135579 [info ] [Thread-3 (]: 5 of 8 START sql view model marts_marts.dim_product ............................ [RUN]
[0m12:14:28.138316 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_sales_transaction, now model.retail_project.dim_product)
[0m12:14:28.141090 [debug] [Thread-3 (]: Began compiling node model.retail_project.dim_product
[0m12:14:28.147069 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_project.dim_product"
[0m12:14:28.149994 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de2e78e8-cab0-46b5-a8fd-ca1437ca0e13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8675dd5a60>]}
[0m12:14:28.152863 [info ] [Thread-4 (]: 4 of 8 OK created sql view model marts_staging.stg_stores ...................... [[32mCREATE VIEW[0m in 0.58s]
[0m12:14:28.154552 [debug] [Thread-4 (]: Finished running node model.retail_project.stg_stores
[0m12:14:28.156945 [debug] [Thread-3 (]: Timing info for model.retail_project.dim_product (compile): 12:14:28.141624 => 12:14:28.156101
[0m12:14:28.157441 [debug] [Thread-3 (]: Began executing node model.retail_project.dim_product
[0m12:14:28.166262 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_project.dim_product"
[0m12:14:28.168591 [debug] [Thread-2 (]: Began running node model.retail_project.dim_customer
[0m12:14:28.171271 [info ] [Thread-2 (]: 6 of 8 START sql view model marts_marts.dim_customer ........................... [RUN]
[0m12:14:28.174546 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_products, now model.retail_project.dim_customer)
[0m12:14:28.176959 [debug] [Thread-2 (]: Began compiling node model.retail_project.dim_customer
[0m12:14:28.183465 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_project.dim_customer"
[0m12:14:28.185479 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:14:28.188028 [debug] [Thread-1 (]: Began running node model.retail_project.dim_store
[0m12:14:28.190758 [debug] [Thread-3 (]: On model.retail_project.dim_product: BEGIN
[0m12:14:28.193154 [info ] [Thread-1 (]: 7 of 8 START sql view model marts_marts.dim_store .............................. [RUN]
[0m12:14:28.196087 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:14:28.197445 [debug] [Thread-2 (]: Timing info for model.retail_project.dim_customer (compile): 12:14:28.178316 => 12:14:28.196854
[0m12:14:28.199723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_customers, now model.retail_project.dim_store)
[0m12:14:28.203016 [debug] [Thread-2 (]: Began executing node model.retail_project.dim_customer
[0m12:14:28.205036 [debug] [Thread-1 (]: Began compiling node model.retail_project.dim_store
[0m12:14:28.219385 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_project.dim_store"
[0m12:14:28.223841 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_project.dim_customer"
[0m12:14:28.226479 [debug] [Thread-1 (]: Timing info for model.retail_project.dim_store (compile): 12:14:28.214738 => 12:14:28.225125
[0m12:14:28.229488 [debug] [Thread-1 (]: Began executing node model.retail_project.dim_store
[0m12:14:28.231049 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:14:28.232402 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:14:28.239817 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_project.dim_store"
[0m12:14:28.242537 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:14:28.245056 [debug] [Thread-2 (]: On model.retail_project.dim_customer: BEGIN
[0m12:14:28.248170 [debug] [Thread-3 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */

  create view "retail_dwh"."marts_marts"."dim_product__dbt_tmp"
    
    
  as (
    SELECT
    product_id,
    product_name,
    product_category,
    product_sub_category,
    product_price
FROM
    "retail_dwh"."marts_staging"."stg_products"
  );
[0m12:14:28.250391 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:14:28.251349 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:14:28.253595 [debug] [Thread-1 (]: On model.retail_project.dim_store: BEGIN
[0m12:14:28.255102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:14:28.257249 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:14:28.266551 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:14:28.267112 [debug] [Thread-3 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */
alter table "retail_dwh"."marts_marts"."dim_product__dbt_tmp" rename to "dim_product"
[0m12:14:28.268046 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:14:28.270479 [debug] [Thread-3 (]: On model.retail_project.dim_product: COMMIT
[0m12:14:28.273029 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:14:28.274722 [debug] [Thread-3 (]: On model.retail_project.dim_product: COMMIT
[0m12:14:28.278018 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:14:28.280054 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:14:28.282129 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:14:28.284084 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m12:14:28.286026 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:14:28.288375 [debug] [Thread-2 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */

  create view "retail_dwh"."marts_marts"."dim_customer__dbt_tmp"
    
    
  as (
    SELECT
    customer_id,
    customer_name,
    customer_gender,
    customer_city,
    customer_signup_date
FROM
    "retail_dwh"."marts_staging"."stg_customers"
  );
[0m12:14:28.293316 [debug] [Thread-3 (]: Applying DROP to: "retail_dwh"."marts_marts"."dim_product__dbt_backup"
[0m12:14:28.296071 [debug] [Thread-1 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */

  create view "retail_dwh"."marts_marts"."dim_store__dbt_tmp"
    
    
  as (
    select
    store_id,
    store_name,
    city as store_city,
    store_region
from "retail_dwh"."marts_staging"."stg_stores"
  );
[0m12:14:28.300753 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:14:28.301819 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:14:28.303552 [debug] [Thread-3 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */
drop view if exists "retail_dwh"."marts_marts"."dim_product__dbt_backup" cascade
[0m12:14:28.309144 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:14:28.313077 [debug] [Thread-2 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */
alter table "retail_dwh"."marts_marts"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m12:14:28.314420 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:14:28.315901 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:14:28.320452 [debug] [Thread-3 (]: Timing info for model.retail_project.dim_product (execute): 12:14:28.159313 => 12:14:28.320061
[0m12:14:28.330832 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:14:28.331852 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:14:28.333562 [debug] [Thread-3 (]: On model.retail_project.dim_product: Close
[0m12:14:28.337015 [debug] [Thread-2 (]: On model.retail_project.dim_customer: COMMIT
[0m12:14:28.339170 [debug] [Thread-1 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */
alter table "retail_dwh"."marts_marts"."dim_store__dbt_tmp" rename to "dim_store"
[0m12:14:28.341311 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de2e78e8-cab0-46b5-a8fd-ca1437ca0e13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86759af860>]}
[0m12:14:28.345241 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:14:28.352217 [debug] [Thread-2 (]: On model.retail_project.dim_customer: COMMIT
[0m12:14:28.348356 [info ] [Thread-3 (]: 5 of 8 OK created sql view model marts_marts.dim_product ....................... [[32mCREATE VIEW[0m in 0.20s]
[0m12:14:28.354480 [debug] [Thread-3 (]: Finished running node model.retail_project.dim_product
[0m12:14:28.357431 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:14:28.361928 [debug] [Thread-1 (]: On model.retail_project.dim_store: COMMIT
[0m12:14:28.363848 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:14:28.365924 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:14:28.370061 [debug] [Thread-2 (]: Applying DROP to: "retail_dwh"."marts_marts"."dim_customer__dbt_backup"
[0m12:14:28.371838 [debug] [Thread-1 (]: On model.retail_project.dim_store: COMMIT
[0m12:14:28.374733 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:14:28.377163 [debug] [Thread-2 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */
drop view if exists "retail_dwh"."marts_marts"."dim_customer__dbt_backup" cascade
[0m12:14:28.381688 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:14:28.385817 [debug] [Thread-1 (]: Applying DROP to: "retail_dwh"."marts_marts"."dim_store__dbt_backup"
[0m12:14:28.387016 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:14:28.389500 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:14:28.392648 [debug] [Thread-2 (]: Timing info for model.retail_project.dim_customer (execute): 12:14:28.206234 => 12:14:28.392366
[0m12:14:28.394988 [debug] [Thread-1 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */
drop view if exists "retail_dwh"."marts_marts"."dim_store__dbt_backup" cascade
[0m12:14:28.397062 [debug] [Thread-2 (]: On model.retail_project.dim_customer: Close
[0m12:14:28.399834 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de2e78e8-cab0-46b5-a8fd-ca1437ca0e13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8675932f60>]}
[0m12:14:28.401133 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:14:28.406945 [debug] [Thread-1 (]: Timing info for model.retail_project.dim_store (execute): 12:14:28.234244 => 12:14:28.406667
[0m12:14:28.408161 [debug] [Thread-1 (]: On model.retail_project.dim_store: Close
[0m12:14:28.403391 [info ] [Thread-2 (]: 6 of 8 OK created sql view model marts_marts.dim_customer ...................... [[32mCREATE VIEW[0m in 0.23s]
[0m12:14:28.410994 [debug] [Thread-2 (]: Finished running node model.retail_project.dim_customer
[0m12:14:28.413247 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de2e78e8-cab0-46b5-a8fd-ca1437ca0e13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86759a5040>]}
[0m12:14:28.416270 [info ] [Thread-1 (]: 7 of 8 OK created sql view model marts_marts.dim_store ......................... [[32mCREATE VIEW[0m in 0.21s]
[0m12:14:28.417534 [debug] [Thread-1 (]: Finished running node model.retail_project.dim_store
[0m12:14:28.419949 [debug] [Thread-4 (]: Began running node model.retail_project.fact_sales
[0m12:14:28.420610 [info ] [Thread-4 (]: 8 of 8 START sql view model marts_marts.fact_sales ............................. [RUN]
[0m12:14:28.422216 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_stores, now model.retail_project.fact_sales)
[0m12:14:28.423276 [debug] [Thread-4 (]: Began compiling node model.retail_project.fact_sales
[0m12:14:28.429896 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_project.fact_sales"
[0m12:14:28.431980 [debug] [Thread-4 (]: Timing info for model.retail_project.fact_sales (compile): 12:14:28.423762 => 12:14:28.431596
[0m12:14:28.434735 [debug] [Thread-4 (]: Began executing node model.retail_project.fact_sales
[0m12:14:28.440553 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_project.fact_sales"
[0m12:14:28.441611 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.fact_sales"
[0m12:14:28.442333 [debug] [Thread-4 (]: On model.retail_project.fact_sales: BEGIN
[0m12:14:28.442820 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:14:28.464819 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:14:28.466378 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.fact_sales"
[0m12:14:28.466889 [debug] [Thread-4 (]: On model.retail_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.fact_sales"} */

  create view "retail_dwh"."marts_marts"."fact_sales__dbt_tmp"
    
    
  as (
    with sales as (
    select
        transaction_id,
        transaction_date,
        customer_id,
        product_id,
        store_id,
        quantity,
        unit_price,
        quantity * unit_price as gross_sales
    from "retail_dwh"."marts_staging"."stg_sales_transaction"
),

joined as (
    select
        s.transaction_id,
        s.transaction_date,
        s.customer_id,
        s.product_id,
        s.store_id,
        s.quantity,
        s.unit_price,
        s.gross_sales,

        c.customer_name,
        p.product_name,
        p.category,
        st.store_name,
        st.store_city,
        st.store_region
    from sales s
    left join "retail_dwh"."marts_marts"."dim_customer" c
        on s.customer_id = c.customer_id
    left join "retail_dwh"."marts_marts"."dim_product" p
        on s.product_id = p.product_id
    left join "retail_dwh"."marts_marts"."dim_store" st
        on s.store_id = st.store_id
)

select * from joined
  );
[0m12:14:28.470404 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column p.category does not exist
LINE 33:         p.category,
                 ^

[0m12:14:28.471528 [debug] [Thread-4 (]: On model.retail_project.fact_sales: ROLLBACK
[0m12:14:28.473452 [debug] [Thread-4 (]: Timing info for model.retail_project.fact_sales (execute): 12:14:28.435277 => 12:14:28.472902
[0m12:14:28.474536 [debug] [Thread-4 (]: On model.retail_project.fact_sales: Close
[0m12:14:28.481535 [debug] [Thread-4 (]: Database Error in model fact_sales (models/marts/facts/fact_sales.sql)
  column p.category does not exist
  LINE 33:         p.category,
                   ^
  compiled Code at target/run/retail_project/models/marts/facts/fact_sales.sql
[0m12:14:28.482179 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de2e78e8-cab0-46b5-a8fd-ca1437ca0e13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8676ddc830>]}
[0m12:14:28.482922 [error] [Thread-4 (]: 8 of 8 ERROR creating sql view model marts_marts.fact_sales .................... [[31mERROR[0m in 0.06s]
[0m12:14:28.484163 [debug] [Thread-4 (]: Finished running node model.retail_project.fact_sales
[0m12:14:28.495537 [debug] [MainThread]: Using postgres connection "master"
[0m12:14:28.496810 [debug] [MainThread]: On master: BEGIN
[0m12:14:28.497326 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:14:28.521840 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:14:28.523110 [debug] [MainThread]: On master: COMMIT
[0m12:14:28.524663 [debug] [MainThread]: Using postgres connection "master"
[0m12:14:28.525881 [debug] [MainThread]: On master: COMMIT
[0m12:14:28.528196 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:14:28.529638 [debug] [MainThread]: On master: Close
[0m12:14:28.532799 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:14:28.534173 [debug] [MainThread]: Connection 'model.retail_project.dim_customer' was properly closed.
[0m12:14:28.537090 [debug] [MainThread]: Connection 'model.retail_project.dim_store' was properly closed.
[0m12:14:28.538247 [debug] [MainThread]: Connection 'model.retail_project.dim_product' was properly closed.
[0m12:14:28.539114 [debug] [MainThread]: Connection 'model.retail_project.fact_sales' was properly closed.
[0m12:14:28.540211 [info ] [MainThread]: 
[0m12:14:28.541394 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 1.34 seconds (1.34s).
[0m12:14:28.548120 [debug] [MainThread]: Command end result
[0m12:14:28.575724 [info ] [MainThread]: 
[0m12:14:28.577277 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:14:28.579334 [info ] [MainThread]: 
[0m12:14:28.581289 [error] [MainThread]:   Database Error in model fact_sales (models/marts/facts/fact_sales.sql)
  column p.category does not exist
  LINE 33:         p.category,
                   ^
  compiled Code at target/run/retail_project/models/marts/facts/fact_sales.sql
[0m12:14:28.582961 [info ] [MainThread]: 
[0m12:14:28.583853 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m12:14:28.586203 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.117156, "process_user_time": 3.678059, "process_kernel_time": 1.055252, "process_mem_max_rss": "151392", "process_out_blocks": "2648", "command_success": false, "process_in_blocks": "0"}
[0m12:14:28.588448 [debug] [MainThread]: Command `dbt run` failed at 12:14:28.588182 after 2.12 seconds
[0m12:14:28.589214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8677ea3380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86761d3e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8677638e30>]}
[0m12:14:28.589931 [debug] [MainThread]: Flushing usage events
[0m12:19:33.960501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2a73ead80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2a7563aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2a78ef860>]}


============================== 12:19:33.965063 | f6801ff6-0d4b-486c-bd06-176e186dc33b ==============================
[0m12:19:33.965063 [info ] [MainThread]: Running with dbt=1.7.0
[0m12:19:33.984886 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/dbt/retail_project/retail_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /root/.dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:19:34.226391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6801ff6-0d4b-486c-bd06-176e186dc33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2a670a120>]}
[0m12:19:34.331478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6801ff6-0d4b-486c-bd06-176e186dc33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2a7914200>]}
[0m12:19:34.332387 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m12:19:34.343990 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m12:19:34.376796 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:19:34.377464 [debug] [MainThread]: Partial parsing: updated file: retail_project://models/marts/facts/fact_sales.sql
[0m12:19:34.566650 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail_project.intermediate
[0m12:19:34.572283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6801ff6-0d4b-486c-bd06-176e186dc33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2a6312240>]}
[0m12:19:34.591768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6801ff6-0d4b-486c-bd06-176e186dc33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2a63a03b0>]}
[0m12:19:34.593531 [info ] [MainThread]: Found 8 models, 4 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:19:34.594746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6801ff6-0d4b-486c-bd06-176e186dc33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2a8e063c0>]}
[0m12:19:34.597890 [info ] [MainThread]: 
[0m12:19:34.599641 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:19:34.602445 [debug] [ThreadPool]: Acquiring new postgres connection 'list_retail_dwh'
[0m12:19:34.615134 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh"
[0m12:19:34.615832 [debug] [ThreadPool]: On list_retail_dwh: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh"} */

    select distinct nspname from pg_namespace
  
[0m12:19:34.616348 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:19:34.621047 [debug] [ThreadPool]: Acquiring new postgres connection 'list_retail_dwh'
[0m12:19:34.625233 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh"
[0m12:19:34.625903 [debug] [ThreadPool]: On list_retail_dwh: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh"} */

    select distinct nspname from pg_namespace
  
[0m12:19:34.626341 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:19:34.636440 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m12:19:34.639287 [debug] [ThreadPool]: On list_retail_dwh: Close
[0m12:19:34.645374 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m12:19:34.647147 [debug] [ThreadPool]: On list_retail_dwh: Close
[0m12:19:34.652629 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_dwh, now list_retail_dwh_marts_staging)
[0m12:19:34.660296 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_dwh, now list_retail_dwh_marts_marts)
[0m12:19:34.738787 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_staging"
[0m12:19:34.741168 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: BEGIN
[0m12:19:34.744673 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_marts"
[0m12:19:34.745488 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:19:34.746478 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: BEGIN
[0m12:19:34.748446 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:19:34.761842 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:19:34.763325 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:19:34.764420 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_staging"
[0m12:19:34.765291 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_marts"
[0m12:19:34.766412 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh_marts_staging"} */
select
      'retail_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'retail_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'retail_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m12:19:34.767726 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh_marts_marts"} */
select
      'retail_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'retail_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'retail_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m12:19:34.774747 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:19:34.775462 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m12:19:34.778132 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: ROLLBACK
[0m12:19:34.781815 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: ROLLBACK
[0m12:19:34.783652 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: Close
[0m12:19:34.784091 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: Close
[0m12:19:34.797833 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:34.798270 [debug] [MainThread]: On master: BEGIN
[0m12:19:34.798554 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:19:34.810651 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:19:34.811530 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:34.811966 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:19:34.843483 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m12:19:34.846160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6801ff6-0d4b-486c-bd06-176e186dc33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2a5b58440>]}
[0m12:19:34.846616 [debug] [MainThread]: On master: ROLLBACK
[0m12:19:34.847560 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:34.847897 [debug] [MainThread]: On master: BEGIN
[0m12:19:34.849279 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:19:34.849632 [debug] [MainThread]: On master: COMMIT
[0m12:19:34.849960 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:34.850248 [debug] [MainThread]: On master: COMMIT
[0m12:19:34.851063 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:19:34.851420 [debug] [MainThread]: On master: Close
[0m12:19:34.852589 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:19:34.855724 [info ] [MainThread]: 
[0m12:19:34.871902 [debug] [Thread-1 (]: Began running node model.retail_project.stg_customers
[0m12:19:34.872915 [debug] [Thread-2 (]: Began running node model.retail_project.stg_products
[0m12:19:34.874337 [info ] [Thread-1 (]: 1 of 8 START sql view model marts_staging.stg_customers ........................ [RUN]
[0m12:19:34.876177 [info ] [Thread-2 (]: 2 of 8 START sql view model marts_staging.stg_products ......................... [RUN]
[0m12:19:34.877588 [debug] [Thread-3 (]: Began running node model.retail_project.stg_sales_transaction
[0m12:19:34.879423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail_dwh_marts_marts, now model.retail_project.stg_customers)
[0m12:19:34.880151 [debug] [Thread-4 (]: Began running node model.retail_project.stg_stores
[0m12:19:34.881317 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_retail_dwh_marts_staging, now model.retail_project.stg_products)
[0m12:19:34.882784 [info ] [Thread-3 (]: 3 of 8 START sql view model marts_staging.stg_sales_transaction ................ [RUN]
[0m12:19:34.888567 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.retail_project.stg_sales_transaction'
[0m12:19:34.885130 [info ] [Thread-4 (]: 4 of 8 START sql view model marts_staging.stg_stores ........................... [RUN]
[0m12:19:34.886889 [debug] [Thread-2 (]: Began compiling node model.retail_project.stg_products
[0m12:19:34.883579 [debug] [Thread-1 (]: Began compiling node model.retail_project.stg_customers
[0m12:19:34.889468 [debug] [Thread-3 (]: Began compiling node model.retail_project.stg_sales_transaction
[0m12:19:34.891579 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.retail_project.stg_stores'
[0m12:19:34.905005 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_project.stg_customers"
[0m12:19:34.907546 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_project.stg_products"
[0m12:19:34.912092 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_project.stg_sales_transaction"
[0m12:19:34.913995 [debug] [Thread-4 (]: Began compiling node model.retail_project.stg_stores
[0m12:19:34.915996 [debug] [Thread-1 (]: Timing info for model.retail_project.stg_customers (compile): 12:19:34.901920 => 12:19:34.915689
[0m12:19:34.922969 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_project.stg_stores"
[0m12:19:34.924060 [debug] [Thread-2 (]: Timing info for model.retail_project.stg_products (compile): 12:19:34.892596 => 12:19:34.923716
[0m12:19:34.925277 [debug] [Thread-3 (]: Timing info for model.retail_project.stg_sales_transaction (compile): 12:19:34.908915 => 12:19:34.924871
[0m12:19:34.929585 [debug] [Thread-3 (]: Began executing node model.retail_project.stg_sales_transaction
[0m12:19:34.926882 [debug] [Thread-1 (]: Began executing node model.retail_project.stg_customers
[0m12:19:34.928256 [debug] [Thread-2 (]: Began executing node model.retail_project.stg_products
[0m12:19:34.969876 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_project.stg_sales_transaction"
[0m12:19:34.980740 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_project.stg_customers"
[0m12:19:34.982019 [debug] [Thread-4 (]: Timing info for model.retail_project.stg_stores (compile): 12:19:34.918446 => 12:19:34.981300
[0m12:19:34.996962 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_project.stg_products"
[0m12:19:34.999305 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m12:19:35.001922 [debug] [Thread-4 (]: Began executing node model.retail_project.stg_stores
[0m12:19:35.002642 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:19:35.004326 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:19:35.006061 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: BEGIN
[0m12:19:35.018539 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:19:35.015591 [debug] [Thread-1 (]: On model.retail_project.stg_customers: BEGIN
[0m12:19:35.017863 [debug] [Thread-2 (]: On model.retail_project.stg_products: BEGIN
[0m12:19:35.013923 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_project.stg_stores"
[0m12:19:35.020924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:19:35.022436 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:19:35.024526 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:19:35.027343 [debug] [Thread-4 (]: On model.retail_project.stg_stores: BEGIN
[0m12:19:35.027894 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:19:35.048792 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:19:35.051908 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m12:19:35.052755 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */

  create view "retail_dwh"."marts_staging"."stg_sales_transaction__dbt_tmp"
    
    
  as (
    with source as (
    select
        transaction_id,
        transaction_date,
        customer_id,
        product_id,
        store_id,
        quantity,
        total_price
    from "retail_dwh"."raw"."sales_transaction_raw"
),

typed as (
    select
        transaction_id,
        customer_id,
        product_id,
        store_id,
        transaction_date::date        as transaction_date,
        quantity::integer             as quantity,
        total_price::numeric(18,2)    as total_price,
        case
            when quantity::numeric <> 0
                then total_price::numeric(18,2) / quantity::numeric
            else null
        end                           as unit_price
    from source
)

select * from typed
  );
[0m12:19:35.056601 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:19:35.058169 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:19:35.059963 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */

  create view "retail_dwh"."marts_staging"."stg_customers__dbt_tmp"
    
    
  as (
    SELECT
    customer_id,
    customer_name,
    UPPER(TRIM(gender)) AS customer_gender,
    TRIM(city) AS customer_city,
    CAST(signup_date AS DATE) AS customer_signup_date
FROM
    "retail_dwh"."raw"."customers_raw"
  );
[0m12:19:35.061620 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:19:35.062346 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:19:35.063094 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */

  create view "retail_dwh"."marts_staging"."stg_products__dbt_tmp"
    
    
  as (
    SELECT
    product_id,
    product_name,
    TRIM(category) AS product_category,
    TRIM(sub_category) AS product_sub_category,
    CAST(price AS NUMERIC) AS product_price
FROM
    "retail_dwh"."raw"."products_raw"
  );
[0m12:19:35.064818 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:19:35.065817 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:19:35.067159 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:19:35.077777 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:19:35.079458 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:19:35.087135 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:19:35.088854 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m12:19:35.090103 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
alter table "retail_dwh"."marts_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m12:19:35.094697 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:19:35.099909 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
alter table "retail_dwh"."marts_staging"."stg_products" rename to "stg_products__dbt_backup"
[0m12:19:35.096381 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */

  create view "retail_dwh"."marts_staging"."stg_stores__dbt_tmp"
    
    
  as (
    with source as (
    select
        store_id,
        store_name,
        city,
        region
    from "retail_dwh"."raw"."stores_raw"
),

renamed as (
    select
        store_id,
        store_name,
        city,
        region as store_region
    from source
)

select * from renamed
  );
[0m12:19:35.098282 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */
alter table "retail_dwh"."marts_staging"."stg_sales_transaction" rename to "stg_sales_transaction__dbt_backup"
[0m12:19:35.102137 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:19:35.106885 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:19:35.108798 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:19:35.109997 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
alter table "retail_dwh"."marts_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m12:19:35.110870 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:19:35.111431 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:19:35.115784 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m12:19:35.121626 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:19:35.126852 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:19:35.128725 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:19:35.130009 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */
alter table "retail_dwh"."marts_staging"."stg_sales_transaction__dbt_tmp" rename to "stg_sales_transaction"
[0m12:19:35.130912 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
alter table "retail_dwh"."marts_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m12:19:35.132373 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
alter table "retail_dwh"."marts_staging"."stg_stores" rename to "stg_stores__dbt_backup"
[0m12:19:35.157122 [debug] [Thread-2 (]: On model.retail_project.stg_products: COMMIT
[0m12:19:35.158170 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:19:35.159815 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:19:35.161774 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:19:35.164824 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: COMMIT
[0m12:19:35.168100 [debug] [Thread-1 (]: On model.retail_project.stg_customers: COMMIT
[0m12:19:35.169085 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:19:35.170134 [debug] [Thread-2 (]: On model.retail_project.stg_products: COMMIT
[0m12:19:35.171193 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m12:19:35.175837 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:19:35.171881 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:19:35.177627 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: COMMIT
[0m12:19:35.179527 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
alter table "retail_dwh"."marts_staging"."stg_stores__dbt_tmp" rename to "stg_stores"
[0m12:19:35.182159 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:19:35.183133 [debug] [Thread-1 (]: On model.retail_project.stg_customers: COMMIT
[0m12:19:35.194334 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:19:35.195342 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m12:19:35.199027 [debug] [Thread-2 (]: Applying DROP to: "retail_dwh"."marts_staging"."stg_products__dbt_backup"
[0m12:19:35.205791 [debug] [Thread-4 (]: On model.retail_project.stg_stores: COMMIT
[0m12:19:35.211228 [debug] [Thread-3 (]: Applying DROP to: "retail_dwh"."marts_staging"."stg_sales_transaction__dbt_backup"
[0m12:19:35.218971 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:19:35.222299 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:19:35.223114 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:19:35.227066 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m12:19:35.230900 [debug] [Thread-1 (]: Applying DROP to: "retail_dwh"."marts_staging"."stg_customers__dbt_backup"
[0m12:19:35.231844 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
drop view if exists "retail_dwh"."marts_staging"."stg_products__dbt_backup" cascade
[0m12:19:35.232614 [debug] [Thread-4 (]: On model.retail_project.stg_stores: COMMIT
[0m12:19:35.234726 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */
drop view if exists "retail_dwh"."marts_staging"."stg_sales_transaction__dbt_backup" cascade
[0m12:19:35.236683 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:19:35.240598 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
drop view if exists "retail_dwh"."marts_staging"."stg_customers__dbt_backup" cascade
[0m12:19:35.242609 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m12:19:35.249398 [debug] [Thread-4 (]: Applying DROP to: "retail_dwh"."marts_staging"."stg_stores__dbt_backup"
[0m12:19:35.250808 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:19:35.252581 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:19:35.253886 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:19:35.254880 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:19:35.257899 [debug] [Thread-3 (]: Timing info for model.retail_project.stg_sales_transaction (execute): 12:19:34.930237 => 12:19:35.257014
[0m12:19:35.259146 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
drop view if exists "retail_dwh"."marts_staging"."stg_stores__dbt_backup" cascade
[0m12:19:35.261367 [debug] [Thread-2 (]: Timing info for model.retail_project.stg_products (execute): 12:19:34.982685 => 12:19:35.261095
[0m12:19:35.264092 [debug] [Thread-1 (]: Timing info for model.retail_project.stg_customers (execute): 12:19:34.974852 => 12:19:35.263825
[0m12:19:35.265659 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: Close
[0m12:19:35.266969 [debug] [Thread-2 (]: On model.retail_project.stg_products: Close
[0m12:19:35.268345 [debug] [Thread-1 (]: On model.retail_project.stg_customers: Close
[0m12:19:35.271641 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6801ff6-0d4b-486c-bd06-176e186dc33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2a5b5b920>]}
[0m12:19:35.274056 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6801ff6-0d4b-486c-bd06-176e186dc33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2a577b140>]}
[0m12:19:35.276867 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:19:35.276162 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6801ff6-0d4b-486c-bd06-176e186dc33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2a531b170>]}
[0m12:19:35.278174 [info ] [Thread-3 (]: 3 of 8 OK created sql view model marts_staging.stg_sales_transaction ........... [[32mCREATE VIEW[0m in 0.38s]
[0m12:19:35.280100 [info ] [Thread-2 (]: 2 of 8 OK created sql view model marts_staging.stg_products .................... [[32mCREATE VIEW[0m in 0.39s]
[0m12:19:35.284019 [debug] [Thread-4 (]: Timing info for model.retail_project.stg_stores (execute): 12:19:35.006907 => 12:19:35.283480
[0m12:19:35.286042 [info ] [Thread-1 (]: 1 of 8 OK created sql view model marts_staging.stg_customers ................... [[32mCREATE VIEW[0m in 0.40s]
[0m12:19:35.287242 [debug] [Thread-3 (]: Finished running node model.retail_project.stg_sales_transaction
[0m12:19:35.288750 [debug] [Thread-2 (]: Finished running node model.retail_project.stg_products
[0m12:19:35.290027 [debug] [Thread-4 (]: On model.retail_project.stg_stores: Close
[0m12:19:35.291183 [debug] [Thread-1 (]: Finished running node model.retail_project.stg_customers
[0m12:19:35.294698 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6801ff6-0d4b-486c-bd06-176e186dc33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2a577b710>]}
[0m12:19:35.297963 [info ] [Thread-4 (]: 4 of 8 OK created sql view model marts_staging.stg_stores ...................... [[32mCREATE VIEW[0m in 0.40s]
[0m12:19:35.299895 [debug] [Thread-4 (]: Finished running node model.retail_project.stg_stores
[0m12:19:35.300754 [debug] [Thread-4 (]: Began running node model.retail_project.dim_product
[0m12:19:35.302638 [info ] [Thread-4 (]: 5 of 8 START sql view model marts_marts.dim_product ............................ [RUN]
[0m12:19:35.304040 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_stores, now model.retail_project.dim_product)
[0m12:19:35.304919 [debug] [Thread-4 (]: Began compiling node model.retail_project.dim_product
[0m12:19:35.308896 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_project.dim_product"
[0m12:19:35.310553 [debug] [Thread-3 (]: Began running node model.retail_project.dim_customer
[0m12:19:35.312978 [debug] [Thread-4 (]: Timing info for model.retail_project.dim_product (compile): 12:19:35.305296 => 12:19:35.312080
[0m12:19:35.313956 [info ] [Thread-3 (]: 6 of 8 START sql view model marts_marts.dim_customer ........................... [RUN]
[0m12:19:35.315017 [debug] [Thread-2 (]: Began running node model.retail_project.dim_store
[0m12:19:35.318365 [info ] [Thread-2 (]: 7 of 8 START sql view model marts_marts.dim_store .............................. [RUN]
[0m12:19:35.317338 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_sales_transaction, now model.retail_project.dim_customer)
[0m12:19:35.316274 [debug] [Thread-4 (]: Began executing node model.retail_project.dim_product
[0m12:19:35.321336 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_products, now model.retail_project.dim_store)
[0m12:19:35.322229 [debug] [Thread-3 (]: Began compiling node model.retail_project.dim_customer
[0m12:19:35.327665 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_project.dim_product"
[0m12:19:35.329057 [debug] [Thread-2 (]: Began compiling node model.retail_project.dim_store
[0m12:19:35.333050 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_project.dim_customer"
[0m12:19:35.337996 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_project.dim_store"
[0m12:19:35.339858 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:19:35.343100 [debug] [Thread-3 (]: Timing info for model.retail_project.dim_customer (compile): 12:19:35.329740 => 12:19:35.341998
[0m12:19:35.344160 [debug] [Thread-4 (]: On model.retail_project.dim_product: BEGIN
[0m12:19:35.345184 [debug] [Thread-2 (]: Timing info for model.retail_project.dim_store (compile): 12:19:35.334787 => 12:19:35.344930
[0m12:19:35.345893 [debug] [Thread-3 (]: Began executing node model.retail_project.dim_customer
[0m12:19:35.346933 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:19:35.348185 [debug] [Thread-2 (]: Began executing node model.retail_project.dim_store
[0m12:19:35.353911 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_project.dim_customer"
[0m12:19:35.365980 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_project.dim_store"
[0m12:19:35.367555 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:19:35.368806 [debug] [Thread-3 (]: On model.retail_project.dim_customer: BEGIN
[0m12:19:35.369748 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:19:35.370498 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:19:35.371179 [debug] [Thread-2 (]: On model.retail_project.dim_store: BEGIN
[0m12:19:35.371779 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:19:35.378726 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:19:35.379405 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:19:35.380014 [debug] [Thread-4 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */

  create view "retail_dwh"."marts_marts"."dim_product__dbt_tmp"
    
    
  as (
    SELECT
    product_id,
    product_name,
    product_category,
    product_sub_category,
    product_price
FROM
    "retail_dwh"."marts_staging"."stg_products"
  );
[0m12:19:35.384200 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:19:35.389869 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:19:35.390991 [debug] [Thread-4 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */
alter table "retail_dwh"."marts_marts"."dim_product__dbt_tmp" rename to "dim_product"
[0m12:19:35.392204 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:19:35.393869 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:19:35.394885 [debug] [Thread-3 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */

  create view "retail_dwh"."marts_marts"."dim_customer__dbt_tmp"
    
    
  as (
    SELECT
    customer_id,
    customer_name,
    customer_gender,
    customer_city,
    customer_signup_date
FROM
    "retail_dwh"."marts_staging"."stg_customers"
  );
[0m12:19:35.395912 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:19:35.399552 [debug] [Thread-4 (]: On model.retail_project.dim_product: COMMIT
[0m12:19:35.401051 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:19:35.401724 [debug] [Thread-4 (]: On model.retail_project.dim_product: COMMIT
[0m12:19:35.402810 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:19:35.407930 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:19:35.412311 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:19:35.414044 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:19:35.415146 [debug] [Thread-3 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */
alter table "retail_dwh"."marts_marts"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m12:19:35.416336 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m12:19:35.417804 [debug] [Thread-2 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */

  create view "retail_dwh"."marts_marts"."dim_store__dbt_tmp"
    
    
  as (
    select
    store_id,
    store_name,
    city as store_city,
    store_region
from "retail_dwh"."marts_staging"."stg_stores"
  );
[0m12:19:35.422300 [debug] [Thread-4 (]: Applying DROP to: "retail_dwh"."marts_marts"."dim_product__dbt_backup"
[0m12:19:35.424369 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:19:35.425810 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:19:35.429452 [debug] [Thread-3 (]: On model.retail_project.dim_customer: COMMIT
[0m12:19:35.430932 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:19:35.432097 [debug] [Thread-4 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */
drop view if exists "retail_dwh"."marts_marts"."dim_product__dbt_backup" cascade
[0m12:19:35.433246 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:19:35.441986 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:19:35.443066 [debug] [Thread-3 (]: On model.retail_project.dim_customer: COMMIT
[0m12:19:35.444489 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:19:35.445234 [debug] [Thread-2 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */
alter table "retail_dwh"."marts_marts"."dim_store__dbt_tmp" rename to "dim_store"
[0m12:19:35.451915 [debug] [Thread-4 (]: Timing info for model.retail_project.dim_product (execute): 12:19:35.322869 => 12:19:35.451164
[0m12:19:35.453299 [debug] [Thread-4 (]: On model.retail_project.dim_product: Close
[0m12:19:35.455678 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6801ff6-0d4b-486c-bd06-176e186dc33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2a5302780>]}
[0m12:19:35.457714 [info ] [Thread-4 (]: 5 of 8 OK created sql view model marts_marts.dim_product ....................... [[32mCREATE VIEW[0m in 0.15s]
[0m12:19:35.459571 [debug] [Thread-4 (]: Finished running node model.retail_project.dim_product
[0m12:19:35.461690 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m12:19:35.466112 [debug] [Thread-3 (]: Applying DROP to: "retail_dwh"."marts_marts"."dim_customer__dbt_backup"
[0m12:19:35.467531 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:19:35.468776 [debug] [Thread-3 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */
drop view if exists "retail_dwh"."marts_marts"."dim_customer__dbt_backup" cascade
[0m12:19:35.469595 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:19:35.472777 [debug] [Thread-2 (]: On model.retail_project.dim_store: COMMIT
[0m12:19:35.473459 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:19:35.474116 [debug] [Thread-2 (]: On model.retail_project.dim_store: COMMIT
[0m12:19:35.475728 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:19:35.479048 [debug] [Thread-3 (]: Timing info for model.retail_project.dim_customer (execute): 12:19:35.348958 => 12:19:35.478765
[0m12:19:35.480037 [debug] [Thread-3 (]: On model.retail_project.dim_customer: Close
[0m12:19:35.481806 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6801ff6-0d4b-486c-bd06-176e186dc33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2a5bec890>]}
[0m12:19:35.483907 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:19:35.488247 [debug] [Thread-2 (]: Applying DROP to: "retail_dwh"."marts_marts"."dim_store__dbt_backup"
[0m12:19:35.489515 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:19:35.490004 [debug] [Thread-2 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */
drop view if exists "retail_dwh"."marts_marts"."dim_store__dbt_backup" cascade
[0m12:19:35.482898 [info ] [Thread-3 (]: 6 of 8 OK created sql view model marts_marts.dim_customer ...................... [[32mCREATE VIEW[0m in 0.16s]
[0m12:19:35.492916 [debug] [Thread-3 (]: Finished running node model.retail_project.dim_customer
[0m12:19:35.493780 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:19:35.495600 [debug] [Thread-2 (]: Timing info for model.retail_project.dim_store (execute): 12:19:35.355055 => 12:19:35.495353
[0m12:19:35.495987 [debug] [Thread-2 (]: On model.retail_project.dim_store: Close
[0m12:19:35.498790 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6801ff6-0d4b-486c-bd06-176e186dc33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2a57a3fb0>]}
[0m12:19:35.499782 [info ] [Thread-2 (]: 7 of 8 OK created sql view model marts_marts.dim_store ......................... [[32mCREATE VIEW[0m in 0.18s]
[0m12:19:35.500853 [debug] [Thread-2 (]: Finished running node model.retail_project.dim_store
[0m12:19:35.504787 [debug] [Thread-1 (]: Began running node model.retail_project.fact_sales
[0m12:19:35.505477 [info ] [Thread-1 (]: 8 of 8 START sql view model marts_marts.fact_sales ............................. [RUN]
[0m12:19:35.508024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_customers, now model.retail_project.fact_sales)
[0m12:19:35.508963 [debug] [Thread-1 (]: Began compiling node model.retail_project.fact_sales
[0m12:19:35.514374 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_project.fact_sales"
[0m12:19:35.515734 [debug] [Thread-1 (]: Timing info for model.retail_project.fact_sales (compile): 12:19:35.509333 => 12:19:35.515463
[0m12:19:35.517067 [debug] [Thread-1 (]: Began executing node model.retail_project.fact_sales
[0m12:19:35.523810 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_project.fact_sales"
[0m12:19:35.525164 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.fact_sales"
[0m12:19:35.525763 [debug] [Thread-1 (]: On model.retail_project.fact_sales: BEGIN
[0m12:19:35.526132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:19:35.540671 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:19:35.541524 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.fact_sales"
[0m12:19:35.542335 [debug] [Thread-1 (]: On model.retail_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.fact_sales"} */

  create view "retail_dwh"."marts_marts"."fact_sales__dbt_tmp"
    
    
  as (
    with sales as (
    select
        transaction_id,
        transaction_date,
        customer_id,
        product_id,
        store_id,
        quantity,
        unit_price,
        quantity * unit_price as gross_sales
    from "retail_dwh"."marts_staging"."stg_sales_transaction"
),

joined as (
    select
        s.transaction_id,
        s.transaction_date,
        s.customer_id,
        s.product_id,
        s.store_id,
        s.quantity,
        s.unit_price,
        s.gross_sales,

        c.customer_name,
        p.product_name,
        -- p.category,   -- sementara DIHAPUS biar nggak error
        st.store_name,
        st.store_city,
        st.store_region
    from sales s
    left join "retail_dwh"."marts_marts"."dim_customer" c
        on s.customer_id = c.customer_id
    left join "retail_dwh"."marts_marts"."dim_product" p
        on s.product_id = p.product_id
    left join "retail_dwh"."marts_marts"."dim_store" st
        on s.store_id = st.store_id
)

select * from joined
  );
[0m12:19:35.546334 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:19:35.551692 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.fact_sales"
[0m12:19:35.552310 [debug] [Thread-1 (]: On model.retail_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.fact_sales"} */
alter table "retail_dwh"."marts_marts"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m12:19:35.554789 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:19:35.557310 [debug] [Thread-1 (]: On model.retail_project.fact_sales: COMMIT
[0m12:19:35.558088 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.fact_sales"
[0m12:19:35.558779 [debug] [Thread-1 (]: On model.retail_project.fact_sales: COMMIT
[0m12:19:35.563640 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:19:35.567404 [debug] [Thread-1 (]: Applying DROP to: "retail_dwh"."marts_marts"."fact_sales__dbt_backup"
[0m12:19:35.568683 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.fact_sales"
[0m12:19:35.569196 [debug] [Thread-1 (]: On model.retail_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.fact_sales"} */
drop view if exists "retail_dwh"."marts_marts"."fact_sales__dbt_backup" cascade
[0m12:19:35.570949 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:19:35.573870 [debug] [Thread-1 (]: Timing info for model.retail_project.fact_sales (execute): 12:19:35.517311 => 12:19:35.573342
[0m12:19:35.574308 [debug] [Thread-1 (]: On model.retail_project.fact_sales: Close
[0m12:19:35.576001 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6801ff6-0d4b-486c-bd06-176e186dc33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2a5794b00>]}
[0m12:19:35.576683 [info ] [Thread-1 (]: 8 of 8 OK created sql view model marts_marts.fact_sales ........................ [[32mCREATE VIEW[0m in 0.07s]
[0m12:19:35.578744 [debug] [Thread-1 (]: Finished running node model.retail_project.fact_sales
[0m12:19:35.584749 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:35.585211 [debug] [MainThread]: On master: BEGIN
[0m12:19:35.585500 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:19:35.599908 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:19:35.600399 [debug] [MainThread]: On master: COMMIT
[0m12:19:35.600698 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:35.601529 [debug] [MainThread]: On master: COMMIT
[0m12:19:35.602854 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:19:35.603234 [debug] [MainThread]: On master: Close
[0m12:19:35.604570 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:19:35.605068 [debug] [MainThread]: Connection 'model.retail_project.fact_sales' was properly closed.
[0m12:19:35.605483 [debug] [MainThread]: Connection 'model.retail_project.dim_store' was properly closed.
[0m12:19:35.605865 [debug] [MainThread]: Connection 'model.retail_project.dim_customer' was properly closed.
[0m12:19:35.607167 [debug] [MainThread]: Connection 'model.retail_project.dim_product' was properly closed.
[0m12:19:35.608032 [info ] [MainThread]: 
[0m12:19:35.608450 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 1.01 seconds (1.01s).
[0m12:19:35.613749 [debug] [MainThread]: Command end result
[0m12:19:35.628045 [info ] [MainThread]: 
[0m12:19:35.629319 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:19:35.630887 [info ] [MainThread]: 
[0m12:19:35.631810 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m12:19:35.633657 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7308998, "process_user_time": 2.996998, "process_kernel_time": 0.896305, "process_mem_max_rss": "151412", "process_out_blocks": "2656", "process_in_blocks": "0"}
[0m12:19:35.634391 [debug] [MainThread]: Command `dbt run` succeeded at 12:19:35.634224 after 1.73 seconds
[0m12:19:35.635282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2a7563aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2a7bbc8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2a577ab10>]}
[0m12:19:35.636156 [debug] [MainThread]: Flushing usage events
[0m12:19:42.412257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3412ddd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb34155dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3414a8fe0>]}


============================== 12:19:42.415598 | b3edb52b-f7e1-447e-a61c-79a29d1ff035 ==============================
[0m12:19:42.415598 [info ] [MainThread]: Running with dbt=1.7.0
[0m12:19:42.417071 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/dbt/retail_project/retail_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /root/.dbt', 'send_anonymous_usage_stats': 'True'}
[0m12:19:42.621318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3edb52b-f7e1-447e-a61c-79a29d1ff035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb342c88a70>]}
[0m12:19:42.726002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3edb52b-f7e1-447e-a61c-79a29d1ff035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3413eec00>]}
[0m12:19:42.726783 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m12:19:42.757897 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m12:19:42.793942 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:19:42.794383 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:19:42.795188 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail_project.intermediate
[0m12:19:42.802084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3edb52b-f7e1-447e-a61c-79a29d1ff035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb340932990>]}
[0m12:19:42.818172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3edb52b-f7e1-447e-a61c-79a29d1ff035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb34096c4a0>]}
[0m12:19:42.818856 [info ] [MainThread]: Found 8 models, 4 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:19:42.820026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3edb52b-f7e1-447e-a61c-79a29d1ff035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb34130b290>]}
[0m12:19:42.822383 [info ] [MainThread]: 
[0m12:19:42.823213 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:19:42.825004 [debug] [MainThread]: Command end result
[0m12:19:42.834263 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.49164334, "process_user_time": 2.789792, "process_kernel_time": 0.305507, "process_mem_max_rss": "151400", "process_out_blocks": "1616", "process_in_blocks": "0"}
[0m12:19:42.834884 [debug] [MainThread]: Command `dbt test` succeeded at 12:19:42.834724 after 0.49 seconds
[0m12:19:42.835290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb341b52300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3413d5d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb34096d670>]}
[0m12:19:42.835669 [debug] [MainThread]: Flushing usage events
[0m12:23:18.988473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd877585c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd877585c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd877585c10>]}


============================== 12:23:18.992901 | c222d481-66a1-42e2-9968-81992d8243ab ==============================
[0m12:23:18.992901 [info ] [MainThread]: Running with dbt=1.7.0
[0m12:23:18.993481 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/opt/dbt/retail_project/retail_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps --profiles-dir /root/.dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:23:19.140373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c222d481-66a1-42e2-9968-81992d8243ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd877456480>]}
[0m12:23:19.141319 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:23:19.143519 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:23:19.145798 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.21215963, "process_user_time": 2.958483, "process_kernel_time": 0.38405, "process_mem_max_rss": "151496", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m12:23:19.146320 [debug] [MainThread]: Command `dbt deps` succeeded at 12:23:19.146178 after 0.21 seconds
[0m12:23:19.146685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd87c46a7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8775daff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8776033e0>]}
[0m12:23:19.147049 [debug] [MainThread]: Flushing usage events
[0m12:23:25.182961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b32d45a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b32d45010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b32d45f10>]}


============================== 12:23:25.188000 | ecfd7ec1-89df-44bf-ab07-1548ca089e27 ==============================
[0m12:23:25.188000 [info ] [MainThread]: Running with dbt=1.7.0
[0m12:23:25.189871 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/dbt/retail_project/retail_project/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /root/.dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:23:25.400080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecfd7ec1-89df-44bf-ab07-1548ca089e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b326d2cc0>]}
[0m12:23:25.509937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ecfd7ec1-89df-44bf-ab07-1548ca089e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b379041a0>]}
[0m12:23:25.510759 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m12:23:25.523110 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m12:23:25.550924 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:23:25.551955 [debug] [MainThread]: Partial parsing: updated file: retail_project://models/marts/dimensions/dim_product.sql
[0m12:23:25.733352 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail_project.intermediate
[0m12:23:25.747205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecfd7ec1-89df-44bf-ab07-1548ca089e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b31b17dd0>]}
[0m12:23:25.791993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ecfd7ec1-89df-44bf-ab07-1548ca089e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b32388290>]}
[0m12:23:25.792814 [info ] [MainThread]: Found 8 models, 4 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:23:25.796981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecfd7ec1-89df-44bf-ab07-1548ca089e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b32c13c50>]}
[0m12:23:25.801856 [info ] [MainThread]: 
[0m12:23:25.813181 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:23:25.815825 [debug] [ThreadPool]: Acquiring new postgres connection 'list_retail_dwh'
[0m12:23:25.835924 [debug] [ThreadPool]: Acquiring new postgres connection 'list_retail_dwh'
[0m12:23:25.833674 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh"
[0m12:23:25.841000 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh"
[0m12:23:25.841812 [debug] [ThreadPool]: On list_retail_dwh: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh"} */

    select distinct nspname from pg_namespace
  
[0m12:23:25.842535 [debug] [ThreadPool]: On list_retail_dwh: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh"} */

    select distinct nspname from pg_namespace
  
[0m12:23:25.843357 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:23:25.844320 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:23:25.867328 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m12:23:25.869004 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m12:23:25.871530 [debug] [ThreadPool]: On list_retail_dwh: Close
[0m12:23:25.873905 [debug] [ThreadPool]: On list_retail_dwh: Close
[0m12:23:25.881028 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_dwh, now list_retail_dwh_marts_marts)
[0m12:23:25.892437 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_marts"
[0m12:23:25.893909 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: BEGIN
[0m12:23:25.894592 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:23:25.896710 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_dwh, now list_retail_dwh_marts_staging)
[0m12:23:25.966331 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_staging"
[0m12:23:25.978144 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: BEGIN
[0m12:23:25.985135 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:23:25.987158 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:23:25.989980 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_marts"
[0m12:23:25.990470 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh_marts_marts"} */
select
      'retail_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'retail_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'retail_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m12:23:25.997009 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:23:25.999037 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: ROLLBACK
[0m12:23:26.001635 [debug] [ThreadPool]: On list_retail_dwh_marts_marts: Close
[0m12:23:26.008355 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:23:26.009015 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_marts_staging"
[0m12:23:26.009555 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh_marts_staging"} */
select
      'retail_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'retail_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'retail_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m12:23:26.015895 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:23:26.018786 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: ROLLBACK
[0m12:23:26.020807 [debug] [ThreadPool]: On list_retail_dwh_marts_staging: Close
[0m12:23:26.028941 [debug] [MainThread]: Using postgres connection "master"
[0m12:23:26.029423 [debug] [MainThread]: On master: BEGIN
[0m12:23:26.029838 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:23:26.048782 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:23:26.049570 [debug] [MainThread]: Using postgres connection "master"
[0m12:23:26.051161 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:23:26.091638 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m12:23:26.097131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecfd7ec1-89df-44bf-ab07-1548ca089e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b33cfa930>]}
[0m12:23:26.097608 [debug] [MainThread]: On master: ROLLBACK
[0m12:23:26.099721 [debug] [MainThread]: Using postgres connection "master"
[0m12:23:26.101112 [debug] [MainThread]: On master: BEGIN
[0m12:23:26.103233 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:23:26.104186 [debug] [MainThread]: On master: COMMIT
[0m12:23:26.105063 [debug] [MainThread]: Using postgres connection "master"
[0m12:23:26.105498 [debug] [MainThread]: On master: COMMIT
[0m12:23:26.106686 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:23:26.107087 [debug] [MainThread]: On master: Close
[0m12:23:26.108706 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:23:26.109429 [info ] [MainThread]: 
[0m12:23:26.118863 [debug] [Thread-1 (]: Began running node model.retail_project.stg_customers
[0m12:23:26.120882 [debug] [Thread-2 (]: Began running node model.retail_project.stg_products
[0m12:23:26.119971 [info ] [Thread-1 (]: 1 of 8 START sql view model marts_staging.stg_customers ........................ [RUN]
[0m12:23:26.123899 [debug] [Thread-3 (]: Began running node model.retail_project.stg_sales_transaction
[0m12:23:26.121847 [info ] [Thread-2 (]: 2 of 8 START sql view model marts_staging.stg_products ......................... [RUN]
[0m12:23:26.125485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail_dwh_marts_staging, now model.retail_project.stg_customers)
[0m12:23:26.126330 [debug] [Thread-4 (]: Began running node model.retail_project.stg_stores
[0m12:23:26.127354 [info ] [Thread-3 (]: 3 of 8 START sql view model marts_staging.stg_sales_transaction ................ [RUN]
[0m12:23:26.129195 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_retail_dwh_marts_marts, now model.retail_project.stg_products)
[0m12:23:26.130257 [debug] [Thread-1 (]: Began compiling node model.retail_project.stg_customers
[0m12:23:26.132057 [info ] [Thread-4 (]: 4 of 8 START sql view model marts_staging.stg_stores ........................... [RUN]
[0m12:23:26.135343 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.retail_project.stg_sales_transaction'
[0m12:23:26.136407 [debug] [Thread-2 (]: Began compiling node model.retail_project.stg_products
[0m12:23:26.146011 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_project.stg_customers"
[0m12:23:26.148497 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.retail_project.stg_stores'
[0m12:23:26.149867 [debug] [Thread-3 (]: Began compiling node model.retail_project.stg_sales_transaction
[0m12:23:26.154699 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_project.stg_products"
[0m12:23:26.164336 [debug] [Thread-2 (]: Timing info for model.retail_project.stg_products (compile): 12:23:26.150946 => 12:23:26.164041
[0m12:23:26.158203 [debug] [Thread-1 (]: Timing info for model.retail_project.stg_customers (compile): 12:23:26.137304 => 12:23:26.157921
[0m12:23:26.162563 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_project.stg_sales_transaction"
[0m12:23:26.157041 [debug] [Thread-4 (]: Began compiling node model.retail_project.stg_stores
[0m12:23:26.165203 [debug] [Thread-2 (]: Began executing node model.retail_project.stg_products
[0m12:23:26.166733 [debug] [Thread-1 (]: Began executing node model.retail_project.stg_customers
[0m12:23:26.172357 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_project.stg_stores"
[0m12:23:26.176193 [debug] [Thread-3 (]: Timing info for model.retail_project.stg_sales_transaction (compile): 12:23:26.159300 => 12:23:26.175639
[0m12:23:26.226150 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_project.stg_customers"
[0m12:23:26.230806 [debug] [Thread-3 (]: Began executing node model.retail_project.stg_sales_transaction
[0m12:23:26.233394 [debug] [Thread-4 (]: Timing info for model.retail_project.stg_stores (compile): 12:23:26.169131 => 12:23:26.232759
[0m12:23:26.241611 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_project.stg_products"
[0m12:23:26.250366 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_project.stg_sales_transaction"
[0m12:23:26.253981 [debug] [Thread-4 (]: Began executing node model.retail_project.stg_stores
[0m12:23:26.252781 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:23:26.262666 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_project.stg_stores"
[0m12:23:26.257054 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:23:26.264205 [debug] [Thread-1 (]: On model.retail_project.stg_customers: BEGIN
[0m12:23:26.264916 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m12:23:26.267525 [debug] [Thread-2 (]: On model.retail_project.stg_products: BEGIN
[0m12:23:26.269869 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:26.270588 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:23:26.271548 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: BEGIN
[0m12:23:26.272969 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:23:26.274524 [debug] [Thread-4 (]: On model.retail_project.stg_stores: BEGIN
[0m12:23:26.276153 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:23:26.278091 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:23:26.290582 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:23:26.292994 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m12:23:26.293744 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */

  create view "retail_dwh"."marts_staging"."stg_sales_transaction__dbt_tmp"
    
    
  as (
    with source as (
    select
        transaction_id,
        transaction_date,
        customer_id,
        product_id,
        store_id,
        quantity,
        total_price
    from "retail_dwh"."raw"."sales_transaction_raw"
),

typed as (
    select
        transaction_id,
        customer_id,
        product_id,
        store_id,
        transaction_date::date        as transaction_date,
        quantity::integer             as quantity,
        total_price::numeric(18,2)    as total_price,
        case
            when quantity::numeric <> 0
                then total_price::numeric(18,2) / quantity::numeric
            else null
        end                           as unit_price
    from source
)

select * from typed
  );
[0m12:23:26.295514 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:23:26.296239 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:23:26.296915 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */

  create view "retail_dwh"."marts_staging"."stg_customers__dbt_tmp"
    
    
  as (
    SELECT
    customer_id,
    customer_name,
    UPPER(TRIM(gender)) AS customer_gender,
    TRIM(city) AS customer_city,
    CAST(signup_date AS DATE) AS customer_signup_date
FROM
    "retail_dwh"."raw"."customers_raw"
  );
[0m12:23:26.303408 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:23:26.313247 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:23:26.325911 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m12:23:26.327946 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */
alter table "retail_dwh"."marts_staging"."stg_sales_transaction" rename to "stg_sales_transaction__dbt_backup"
[0m12:23:26.330127 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:23:26.331339 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
alter table "retail_dwh"."marts_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m12:23:26.333668 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:23:26.335884 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:23:26.341077 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m12:23:26.342744 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:23:26.343529 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:23:26.348165 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:23:26.349686 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */
alter table "retail_dwh"."marts_staging"."stg_sales_transaction__dbt_tmp" rename to "stg_sales_transaction"
[0m12:23:26.351859 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:23:26.353192 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:23:26.354128 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
alter table "retail_dwh"."marts_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m12:23:26.355752 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */

  create view "retail_dwh"."marts_staging"."stg_stores__dbt_tmp"
    
    
  as (
    with source as (
    select
        store_id,
        store_name,
        city,
        region
    from "retail_dwh"."raw"."stores_raw"
),

renamed as (
    select
        store_id,
        store_name,
        city,
        region as store_region
    from source
)

select * from renamed
  );
[0m12:23:26.356901 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:23:26.358045 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */

  create view "retail_dwh"."marts_staging"."stg_products__dbt_tmp"
    
    
  as (
    SELECT
    product_id,
    product_name,
    TRIM(category) AS product_category,
    TRIM(sub_category) AS product_sub_category,
    CAST(price AS NUMERIC) AS product_price
FROM
    "retail_dwh"."raw"."products_raw"
  );
[0m12:23:26.366436 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:23:26.368109 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:23:26.387021 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:23:26.387809 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:23:26.404919 [debug] [Thread-1 (]: On model.retail_project.stg_customers: COMMIT
[0m12:23:26.406233 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: COMMIT
[0m12:23:26.407171 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
alter table "retail_dwh"."marts_staging"."stg_stores" rename to "stg_stores__dbt_backup"
[0m12:23:26.411992 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:23:26.416138 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
alter table "retail_dwh"."marts_staging"."stg_products" rename to "stg_products__dbt_backup"
[0m12:23:26.413751 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:23:26.414880 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m12:23:26.417260 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:23:26.419425 [debug] [Thread-1 (]: On model.retail_project.stg_customers: COMMIT
[0m12:23:26.420943 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: COMMIT
[0m12:23:26.421750 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:23:26.426093 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:23:26.435213 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:23:26.436704 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
alter table "retail_dwh"."marts_staging"."stg_stores__dbt_tmp" rename to "stg_stores"
[0m12:23:26.439326 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:23:26.440575 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m12:23:26.450311 [debug] [Thread-1 (]: Applying DROP to: "retail_dwh"."marts_staging"."stg_customers__dbt_backup"
[0m12:23:26.453504 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
alter table "retail_dwh"."marts_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m12:23:26.459676 [debug] [Thread-3 (]: Applying DROP to: "retail_dwh"."marts_staging"."stg_sales_transaction__dbt_backup"
[0m12:23:26.469320 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:23:26.471168 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:23:26.474210 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m12:23:26.475692 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
drop view if exists "retail_dwh"."marts_staging"."stg_customers__dbt_backup" cascade
[0m12:23:26.476764 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:23:26.480423 [debug] [Thread-4 (]: On model.retail_project.stg_stores: COMMIT
[0m12:23:26.481703 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */
drop view if exists "retail_dwh"."marts_staging"."stg_sales_transaction__dbt_backup" cascade
[0m12:23:26.488024 [debug] [Thread-2 (]: On model.retail_project.stg_products: COMMIT
[0m12:23:26.489716 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:23:26.491757 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:23:26.493234 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:23:26.495992 [debug] [Thread-4 (]: On model.retail_project.stg_stores: COMMIT
[0m12:23:26.498761 [debug] [Thread-1 (]: Timing info for model.retail_project.stg_customers (execute): 12:23:26.200455 => 12:23:26.498486
[0m12:23:26.501824 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:23:26.503707 [debug] [Thread-2 (]: On model.retail_project.stg_products: COMMIT
[0m12:23:26.506065 [debug] [Thread-1 (]: On model.retail_project.stg_customers: Close
[0m12:23:26.513328 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecfd7ec1-89df-44bf-ab07-1548ca089e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b317ceab0>]}
[0m12:23:26.511020 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m12:23:26.509546 [debug] [Thread-3 (]: Timing info for model.retail_project.stg_sales_transaction (execute): 12:23:26.243853 => 12:23:26.508923
[0m12:23:26.514739 [info ] [Thread-1 (]: 1 of 8 OK created sql view model marts_staging.stg_customers ................... [[32mCREATE VIEW[0m in 0.39s]
[0m12:23:26.517639 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:23:26.525316 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: Close
[0m12:23:26.527041 [debug] [Thread-4 (]: Applying DROP to: "retail_dwh"."marts_staging"."stg_stores__dbt_backup"
[0m12:23:26.528363 [debug] [Thread-1 (]: Finished running node model.retail_project.stg_customers
[0m12:23:26.534432 [debug] [Thread-2 (]: Applying DROP to: "retail_dwh"."marts_staging"."stg_products__dbt_backup"
[0m12:23:26.546692 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:23:26.542442 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:23:26.540601 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecfd7ec1-89df-44bf-ab07-1548ca089e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b317a3890>]}
[0m12:23:26.547980 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
drop view if exists "retail_dwh"."marts_staging"."stg_products__dbt_backup" cascade
[0m12:23:26.549155 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
drop view if exists "retail_dwh"."marts_staging"."stg_stores__dbt_backup" cascade
[0m12:23:26.550940 [debug] [Thread-1 (]: Began running node model.retail_project.dim_customer
[0m12:23:26.552427 [info ] [Thread-3 (]: 3 of 8 OK created sql view model marts_staging.stg_sales_transaction ........... [[32mCREATE VIEW[0m in 0.41s]
[0m12:23:26.556341 [debug] [Thread-3 (]: Finished running node model.retail_project.stg_sales_transaction
[0m12:23:26.554816 [info ] [Thread-1 (]: 5 of 8 START sql view model marts_marts.dim_customer ........................... [RUN]
[0m12:23:26.558406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_customers, now model.retail_project.dim_customer)
[0m12:23:26.560013 [debug] [Thread-1 (]: Began compiling node model.retail_project.dim_customer
[0m12:23:26.564481 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_project.dim_customer"
[0m12:23:26.566065 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:23:26.570866 [debug] [Thread-4 (]: Timing info for model.retail_project.stg_stores (execute): 12:23:26.257783 => 12:23:26.570605
[0m12:23:26.572779 [debug] [Thread-4 (]: On model.retail_project.stg_stores: Close
[0m12:23:26.574944 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecfd7ec1-89df-44bf-ab07-1548ca089e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b317d65d0>]}
[0m12:23:26.576145 [info ] [Thread-4 (]: 4 of 8 OK created sql view model marts_staging.stg_stores ...................... [[32mCREATE VIEW[0m in 0.43s]
[0m12:23:26.578892 [debug] [Thread-4 (]: Finished running node model.retail_project.stg_stores
[0m12:23:26.580847 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:23:26.584764 [debug] [Thread-2 (]: Timing info for model.retail_project.stg_products (execute): 12:23:26.176865 => 12:23:26.584399
[0m12:23:26.586185 [debug] [Thread-2 (]: On model.retail_project.stg_products: Close
[0m12:23:26.587692 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecfd7ec1-89df-44bf-ab07-1548ca089e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b31fcad20>]}
[0m12:23:26.588408 [info ] [Thread-2 (]: 2 of 8 OK created sql view model marts_staging.stg_products .................... [[32mCREATE VIEW[0m in 0.46s]
[0m12:23:26.592089 [debug] [Thread-2 (]: Finished running node model.retail_project.stg_products
[0m12:23:26.590597 [debug] [Thread-1 (]: Timing info for model.retail_project.dim_customer (compile): 12:23:26.560489 => 12:23:26.589193
[0m12:23:26.594683 [debug] [Thread-1 (]: Began executing node model.retail_project.dim_customer
[0m12:23:26.594075 [debug] [Thread-2 (]: Began running node model.retail_project.dim_store
[0m12:23:26.601652 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_project.dim_customer"
[0m12:23:26.606705 [info ] [Thread-2 (]: 6 of 8 START sql view model marts_marts.dim_store .............................. [RUN]
[0m12:23:26.611733 [debug] [Thread-3 (]: Began running node model.retail_project.dim_product
[0m12:23:26.621056 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:23:26.618341 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_products, now model.retail_project.dim_store)
[0m12:23:26.624495 [debug] [Thread-1 (]: On model.retail_project.dim_customer: BEGIN
[0m12:23:26.626940 [debug] [Thread-2 (]: Began compiling node model.retail_project.dim_store
[0m12:23:26.623106 [info ] [Thread-3 (]: 7 of 8 START sql view model marts_marts.dim_product ............................ [RUN]
[0m12:23:26.628291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:26.636469 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_sales_transaction, now model.retail_project.dim_product)
[0m12:23:26.638023 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_project.dim_store"
[0m12:23:26.640797 [debug] [Thread-3 (]: Began compiling node model.retail_project.dim_product
[0m12:23:26.647100 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_project.dim_product"
[0m12:23:26.650001 [debug] [Thread-3 (]: Timing info for model.retail_project.dim_product (compile): 12:23:26.641400 => 12:23:26.648724
[0m12:23:26.651738 [debug] [Thread-3 (]: Began executing node model.retail_project.dim_product
[0m12:23:26.661075 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_project.dim_product"
[0m12:23:26.663138 [debug] [Thread-2 (]: Timing info for model.retail_project.dim_store (compile): 12:23:26.629207 => 12:23:26.662472
[0m12:23:26.664336 [debug] [Thread-2 (]: Began executing node model.retail_project.dim_store
[0m12:23:26.681773 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_project.dim_store"
[0m12:23:26.684326 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:23:26.686404 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:23:26.688289 [debug] [Thread-1 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */

  create view "retail_dwh"."marts_marts"."dim_customer__dbt_tmp"
    
    
  as (
    SELECT
    customer_id,
    customer_name,
    customer_gender,
    customer_city,
    customer_signup_date
FROM
    "retail_dwh"."marts_staging"."stg_customers"
  );
[0m12:23:26.690476 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:23:26.692204 [debug] [Thread-2 (]: On model.retail_project.dim_store: BEGIN
[0m12:23:26.693452 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:23:26.694863 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:23:26.696634 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:23:26.698081 [debug] [Thread-3 (]: On model.retail_project.dim_product: BEGIN
[0m12:23:26.708106 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:23:26.710033 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:23:26.711834 [debug] [Thread-1 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */
alter table "retail_dwh"."marts_marts"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m12:23:26.714131 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:23:26.718468 [debug] [Thread-1 (]: On model.retail_project.dim_customer: COMMIT
[0m12:23:26.719112 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:23:26.719511 [debug] [Thread-1 (]: On model.retail_project.dim_customer: COMMIT
[0m12:23:26.723000 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:23:26.723545 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:23:26.723945 [debug] [Thread-2 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */

  create view "retail_dwh"."marts_marts"."dim_store__dbt_tmp"
    
    
  as (
    select
    store_id,
    store_name,
    city as store_city,
    store_region
from "retail_dwh"."marts_staging"."stg_stores"
  );
[0m12:23:26.724933 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:23:26.729914 [debug] [Thread-1 (]: Applying DROP to: "retail_dwh"."marts_marts"."dim_customer__dbt_backup"
[0m12:23:26.731715 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:23:26.733268 [debug] [Thread-1 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */
drop view if exists "retail_dwh"."marts_marts"."dim_customer__dbt_backup" cascade
[0m12:23:26.735467 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:23:26.740352 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:23:26.742125 [debug] [Thread-2 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */
alter table "retail_dwh"."marts_marts"."dim_store__dbt_tmp" rename to "dim_store"
[0m12:23:26.743980 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:23:26.747058 [debug] [Thread-1 (]: Timing info for model.retail_project.dim_customer (execute): 12:23:26.595950 => 12:23:26.746737
[0m12:23:26.749384 [debug] [Thread-1 (]: On model.retail_project.dim_customer: Close
[0m12:23:26.752131 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:23:26.756276 [debug] [Thread-2 (]: On model.retail_project.dim_store: COMMIT
[0m12:23:26.758158 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:23:26.760403 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:23:26.761552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecfd7ec1-89df-44bf-ab07-1548ca089e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b317d73b0>]}
[0m12:23:26.762836 [debug] [Thread-2 (]: On model.retail_project.dim_store: COMMIT
[0m12:23:26.764202 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:23:26.765392 [info ] [Thread-1 (]: 5 of 8 OK created sql view model marts_marts.dim_customer ...................... [[32mCREATE VIEW[0m in 0.20s]
[0m12:23:26.768048 [debug] [Thread-3 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */

  create view "retail_dwh"."marts_marts"."dim_product__dbt_tmp"
    
    
  as (
    select
    product_id,
    product_name,
    product_category      as category,
    product_sub_category  as sub_category,
    product_price         as price
from "retail_dwh"."marts_staging"."stg_products"
  );
[0m12:23:26.770460 [debug] [Thread-1 (]: Finished running node model.retail_project.dim_customer
[0m12:23:26.771824 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:23:26.779507 [debug] [Thread-2 (]: Applying DROP to: "retail_dwh"."marts_marts"."dim_store__dbt_backup"
[0m12:23:26.781203 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:23:26.784926 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:23:26.789377 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:23:26.790795 [debug] [Thread-2 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */
drop view if exists "retail_dwh"."marts_marts"."dim_store__dbt_backup" cascade
[0m12:23:26.792130 [debug] [Thread-3 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */
alter table "retail_dwh"."marts_marts"."dim_product__dbt_tmp" rename to "dim_product"
[0m12:23:26.794391 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:23:26.798022 [debug] [Thread-2 (]: Timing info for model.retail_project.dim_store (execute): 12:23:26.664921 => 12:23:26.796470
[0m12:23:26.799522 [debug] [Thread-2 (]: On model.retail_project.dim_store: Close
[0m12:23:26.804150 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecfd7ec1-89df-44bf-ab07-1548ca089e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b3132d850>]}
[0m12:23:26.804809 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:23:26.810680 [debug] [Thread-3 (]: On model.retail_project.dim_product: COMMIT
[0m12:23:26.811282 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:23:26.812674 [debug] [Thread-3 (]: On model.retail_project.dim_product: COMMIT
[0m12:23:26.806671 [info ] [Thread-2 (]: 6 of 8 OK created sql view model marts_marts.dim_store ......................... [[32mCREATE VIEW[0m in 0.19s]
[0m12:23:26.815008 [debug] [Thread-2 (]: Finished running node model.retail_project.dim_store
[0m12:23:26.817305 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m12:23:26.820451 [debug] [Thread-3 (]: Applying DROP to: "retail_dwh"."marts_marts"."dim_product__dbt_backup"
[0m12:23:26.821356 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:23:26.821745 [debug] [Thread-3 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */
drop view if exists "retail_dwh"."marts_marts"."dim_product__dbt_backup" cascade
[0m12:23:26.823776 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:23:26.826370 [debug] [Thread-3 (]: Timing info for model.retail_project.dim_product (execute): 12:23:26.652342 => 12:23:26.826124
[0m12:23:26.826802 [debug] [Thread-3 (]: On model.retail_project.dim_product: Close
[0m12:23:26.829234 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecfd7ec1-89df-44bf-ab07-1548ca089e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b3131ea20>]}
[0m12:23:26.830314 [info ] [Thread-3 (]: 7 of 8 OK created sql view model marts_marts.dim_product ....................... [[32mCREATE VIEW[0m in 0.19s]
[0m12:23:26.832119 [debug] [Thread-3 (]: Finished running node model.retail_project.dim_product
[0m12:23:26.838971 [debug] [Thread-4 (]: Began running node model.retail_project.fact_sales
[0m12:23:26.839587 [info ] [Thread-4 (]: 8 of 8 START sql view model marts_marts.fact_sales ............................. [RUN]
[0m12:23:26.841790 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_stores, now model.retail_project.fact_sales)
[0m12:23:26.843023 [debug] [Thread-4 (]: Began compiling node model.retail_project.fact_sales
[0m12:23:26.851617 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_project.fact_sales"
[0m12:23:26.853737 [debug] [Thread-4 (]: Timing info for model.retail_project.fact_sales (compile): 12:23:26.843967 => 12:23:26.853059
[0m12:23:26.854388 [debug] [Thread-4 (]: Began executing node model.retail_project.fact_sales
[0m12:23:26.864071 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_project.fact_sales"
[0m12:23:26.865058 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.fact_sales"
[0m12:23:26.867470 [debug] [Thread-4 (]: On model.retail_project.fact_sales: BEGIN
[0m12:23:26.868400 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:23:26.886093 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:23:26.887638 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.fact_sales"
[0m12:23:26.888147 [debug] [Thread-4 (]: On model.retail_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.fact_sales"} */

  create view "retail_dwh"."marts_marts"."fact_sales__dbt_tmp"
    
    
  as (
    with sales as (
    select
        transaction_id,
        transaction_date,
        customer_id,
        product_id,
        store_id,
        quantity,
        unit_price,
        quantity * unit_price as gross_sales
    from "retail_dwh"."marts_staging"."stg_sales_transaction"
),

joined as (
    select
        s.transaction_id,
        s.transaction_date,
        s.customer_id,
        s.product_id,
        s.store_id,
        s.quantity,
        s.unit_price,
        s.gross_sales,

        c.customer_name,
        p.product_name,
        -- p.category,   -- sementara DIHAPUS biar nggak error
        st.store_name,
        st.store_city,
        st.store_region
    from sales s
    left join "retail_dwh"."marts_marts"."dim_customer" c
        on s.customer_id = c.customer_id
    left join "retail_dwh"."marts_marts"."dim_product" p
        on s.product_id = p.product_id
    left join "retail_dwh"."marts_marts"."dim_store" st
        on s.store_id = st.store_id
)

select * from joined
  );
[0m12:23:26.893418 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:23:26.899533 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.fact_sales"
[0m12:23:26.901235 [debug] [Thread-4 (]: On model.retail_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.fact_sales"} */
alter table "retail_dwh"."marts_marts"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m12:23:26.902947 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:23:26.905578 [debug] [Thread-4 (]: On model.retail_project.fact_sales: COMMIT
[0m12:23:26.905990 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.fact_sales"
[0m12:23:26.906870 [debug] [Thread-4 (]: On model.retail_project.fact_sales: COMMIT
[0m12:23:26.912027 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m12:23:26.916176 [debug] [Thread-4 (]: Applying DROP to: "retail_dwh"."marts_marts"."fact_sales__dbt_backup"
[0m12:23:26.917789 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.fact_sales"
[0m12:23:26.918237 [debug] [Thread-4 (]: On model.retail_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.fact_sales"} */
drop view if exists "retail_dwh"."marts_marts"."fact_sales__dbt_backup" cascade
[0m12:23:26.919715 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:23:26.921747 [debug] [Thread-4 (]: Timing info for model.retail_project.fact_sales (execute): 12:23:26.855055 => 12:23:26.921511
[0m12:23:26.922910 [debug] [Thread-4 (]: On model.retail_project.fact_sales: Close
[0m12:23:26.924462 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecfd7ec1-89df-44bf-ab07-1548ca089e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b3131e5d0>]}
[0m12:23:26.925707 [info ] [Thread-4 (]: 8 of 8 OK created sql view model marts_marts.fact_sales ........................ [[32mCREATE VIEW[0m in 0.08s]
[0m12:23:26.927723 [debug] [Thread-4 (]: Finished running node model.retail_project.fact_sales
[0m12:23:26.933851 [debug] [MainThread]: Using postgres connection "master"
[0m12:23:26.934945 [debug] [MainThread]: On master: BEGIN
[0m12:23:26.935861 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:23:26.951888 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:23:26.952396 [debug] [MainThread]: On master: COMMIT
[0m12:23:26.952703 [debug] [MainThread]: Using postgres connection "master"
[0m12:23:26.953397 [debug] [MainThread]: On master: COMMIT
[0m12:23:26.954743 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:23:26.955104 [debug] [MainThread]: On master: Close
[0m12:23:26.957103 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:23:26.957750 [debug] [MainThread]: Connection 'model.retail_project.dim_store' was properly closed.
[0m12:23:26.958457 [debug] [MainThread]: Connection 'model.retail_project.dim_customer' was properly closed.
[0m12:23:26.959232 [debug] [MainThread]: Connection 'model.retail_project.dim_product' was properly closed.
[0m12:23:26.959531 [debug] [MainThread]: Connection 'model.retail_project.fact_sales' was properly closed.
[0m12:23:26.960280 [info ] [MainThread]: 
[0m12:23:26.960714 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 1.15 seconds (1.15s).
[0m12:23:26.964584 [debug] [MainThread]: Command end result
[0m12:23:26.979675 [info ] [MainThread]: 
[0m12:23:26.980355 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:23:26.981498 [info ] [MainThread]: 
[0m12:23:26.982471 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m12:23:26.985651 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.866563, "process_user_time": 3.537232, "process_kernel_time": 0.847745, "process_mem_max_rss": "151424", "process_out_blocks": "2640", "process_in_blocks": "0"}
[0m12:23:26.987168 [debug] [MainThread]: Command `dbt run` succeeded at 12:23:26.986701 after 1.87 seconds
[0m12:23:26.987616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b32db99d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b31731880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b3269b9e0>]}
[0m12:23:26.988099 [debug] [MainThread]: Flushing usage events
[0m12:23:33.039600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdcb7018e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdcb703c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdcb701940>]}


============================== 12:23:33.046987 | 532dedb9-fd6e-46e2-abd5-0072f1a7e1fa ==============================
[0m12:23:33.046987 [info ] [MainThread]: Running with dbt=1.7.0
[0m12:23:33.048442 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/dbt/retail_project/retail_project/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /root/.dbt', 'send_anonymous_usage_stats': 'True'}
[0m12:23:33.353018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '532dedb9-fd6e-46e2-abd5-0072f1a7e1fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdcb7621e0>]}
[0m12:23:33.499463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '532dedb9-fd6e-46e2-abd5-0072f1a7e1fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdcb603e90>]}
[0m12:23:33.500605 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m12:23:33.510624 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m12:23:33.572140 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:23:33.573866 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:23:33.580553 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail_project.intermediate
[0m12:23:33.601747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '532dedb9-fd6e-46e2-abd5-0072f1a7e1fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdcb0c3da0>]}
[0m12:23:33.618917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '532dedb9-fd6e-46e2-abd5-0072f1a7e1fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdcad88cb0>]}
[0m12:23:33.619490 [info ] [MainThread]: Found 8 models, 4 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:23:33.620041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '532dedb9-fd6e-46e2-abd5-0072f1a7e1fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdcb1256a0>]}
[0m12:23:33.622156 [info ] [MainThread]: 
[0m12:23:33.622790 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:23:33.623437 [debug] [MainThread]: Command end result
[0m12:23:33.687827 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.749669, "process_user_time": 3.340453, "process_kernel_time": 0.384878, "process_mem_max_rss": "151420", "process_out_blocks": "1616", "process_in_blocks": "0"}
[0m12:23:33.689015 [debug] [MainThread]: Command `dbt test` succeeded at 12:23:33.688532 after 0.75 seconds
[0m12:23:33.689723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdd0602810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdcb603c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdcb701940>]}
[0m12:23:33.691700 [debug] [MainThread]: Flushing usage events
[0m12:40:57.505366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3aa205ad80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3aa227d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3aa237bbf0>]}


============================== 12:40:57.513894 | 0caf2fd7-fd30-4be7-b39e-8216ef755c60 ==============================
[0m12:40:57.513894 [info ] [MainThread]: Running with dbt=1.7.0
[0m12:40:57.518078 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/dbt/retail_project/retail_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps --profiles-dir /root/.dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:40:57.643291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0caf2fd7-fd30-4be7-b39e-8216ef755c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3aa23bd9a0>]}
[0m12:40:57.644033 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:40:57.646505 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:40:57.648686 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.20155002, "process_user_time": 2.58854, "process_kernel_time": 0.351062, "process_mem_max_rss": "151576", "process_out_blocks": "16", "process_in_blocks": "0"}
[0m12:40:57.649777 [debug] [MainThread]: Command `dbt deps` succeeded at 12:40:57.649564 after 0.20 seconds
[0m12:40:57.650221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3aa23a9be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3aa2147d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3aa23bd9a0>]}
[0m12:40:57.650615 [debug] [MainThread]: Flushing usage events
[0m12:41:04.136643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc9de8a990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc9def6240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc9de89fa0>]}


============================== 12:41:04.145314 | c21117aa-f629-4b4f-9de1-14452bc6628f ==============================
[0m12:41:04.145314 [info ] [MainThread]: Running with dbt=1.7.0
[0m12:41:04.146272 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/dbt/retail_project/retail_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /root/.dbt', 'send_anonymous_usage_stats': 'True'}
[0m12:41:04.463056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c21117aa-f629-4b4f-9de1-14452bc6628f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc9ded54f0>]}
[0m12:41:04.575460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c21117aa-f629-4b4f-9de1-14452bc6628f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc9df21520>]}
[0m12:41:04.576310 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m12:41:04.586297 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m12:41:04.596189 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:41:04.597174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c21117aa-f629-4b4f-9de1-14452bc6628f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc9cd6a810>]}
[0m12:41:05.822403 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail_project.intermediate
[0m12:41:05.829052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c21117aa-f629-4b4f-9de1-14452bc6628f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc9c9ac9e0>]}
[0m12:41:05.844805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c21117aa-f629-4b4f-9de1-14452bc6628f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc9c5179b0>]}
[0m12:41:05.845558 [info ] [MainThread]: Found 8 models, 4 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m12:41:05.846150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c21117aa-f629-4b4f-9de1-14452bc6628f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc9d1e9160>]}
[0m12:41:05.848699 [info ] [MainThread]: 
[0m12:41:05.850001 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:41:05.857153 [debug] [ThreadPool]: Acquiring new postgres connection 'list_retail_dwh'
[0m12:41:05.870244 [debug] [ThreadPool]: Acquiring new postgres connection 'list_retail_dwh'
[0m12:41:05.919914 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh"
[0m12:41:05.921812 [debug] [ThreadPool]: On list_retail_dwh: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh"} */

    select distinct nspname from pg_namespace
  
[0m12:41:05.922522 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:41:05.933095 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh"
[0m12:41:05.933694 [debug] [ThreadPool]: On list_retail_dwh: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh"} */

    select distinct nspname from pg_namespace
  
[0m12:41:05.934139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:41:05.946875 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m12:41:05.949175 [debug] [ThreadPool]: On list_retail_dwh: Close
[0m12:41:05.955999 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m12:41:05.958397 [debug] [ThreadPool]: On list_retail_dwh: Close
[0m12:41:05.961875 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_dwh, now create_retail_dwh_mart)
[0m12:41:05.963448 [debug] [ThreadPool]: Creating schema "database: "retail_dwh"
schema: "mart"
"
[0m12:41:05.972229 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_dwh, now create_retail_dwh_staging)
[0m12:41:05.974575 [debug] [ThreadPool]: Creating schema "database: "retail_dwh"
schema: "staging"
"
[0m12:41:05.987221 [debug] [ThreadPool]: Using postgres connection "create_retail_dwh_mart"
[0m12:41:05.988322 [debug] [ThreadPool]: On create_retail_dwh_mart: BEGIN
[0m12:41:05.989336 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:41:05.981681 [debug] [ThreadPool]: Using postgres connection "create_retail_dwh_staging"
[0m12:41:05.991435 [debug] [ThreadPool]: On create_retail_dwh_staging: BEGIN
[0m12:41:05.992392 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:41:06.008980 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:41:06.010341 [debug] [ThreadPool]: Using postgres connection "create_retail_dwh_mart"
[0m12:41:06.011116 [debug] [ThreadPool]: On create_retail_dwh_mart: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "create_retail_dwh_mart"} */
create schema if not exists "mart"
[0m12:41:06.012364 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:41:06.013028 [debug] [ThreadPool]: Using postgres connection "create_retail_dwh_staging"
[0m12:41:06.013942 [debug] [ThreadPool]: On create_retail_dwh_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "create_retail_dwh_staging"} */
create schema if not exists "staging"
[0m12:41:06.014932 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m12:41:06.016523 [debug] [ThreadPool]: On create_retail_dwh_mart: COMMIT
[0m12:41:06.017548 [debug] [ThreadPool]: Using postgres connection "create_retail_dwh_mart"
[0m12:41:06.018433 [debug] [ThreadPool]: On create_retail_dwh_mart: COMMIT
[0m12:41:06.019515 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m12:41:06.021881 [debug] [ThreadPool]: On create_retail_dwh_staging: COMMIT
[0m12:41:06.023190 [debug] [ThreadPool]: Using postgres connection "create_retail_dwh_staging"
[0m12:41:06.023981 [debug] [ThreadPool]: On create_retail_dwh_staging: COMMIT
[0m12:41:06.024741 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m12:41:06.027007 [debug] [ThreadPool]: On create_retail_dwh_mart: Close
[0m12:41:06.031374 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m12:41:06.033095 [debug] [ThreadPool]: On create_retail_dwh_staging: Close
[0m12:41:06.040607 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_retail_dwh_staging, now list_retail_dwh_mart)
[0m12:41:06.049861 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_retail_dwh_mart, now list_retail_dwh_staging)
[0m12:41:06.066880 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_staging"
[0m12:41:06.069037 [debug] [ThreadPool]: On list_retail_dwh_staging: BEGIN
[0m12:41:06.070098 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_mart"
[0m12:41:06.070962 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:41:06.071943 [debug] [ThreadPool]: On list_retail_dwh_mart: BEGIN
[0m12:41:06.073219 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:41:06.098632 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:41:06.099716 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:41:06.100873 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_staging"
[0m12:41:06.102142 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_mart"
[0m12:41:06.102996 [debug] [ThreadPool]: On list_retail_dwh_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh_staging"} */
select
      'retail_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'retail_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'retail_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m12:41:06.104245 [debug] [ThreadPool]: On list_retail_dwh_mart: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh_mart"} */
select
      'retail_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'retail_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
    union all
    select
      'retail_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'mart'
  
[0m12:41:06.110792 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m12:41:06.113674 [debug] [ThreadPool]: On list_retail_dwh_staging: ROLLBACK
[0m12:41:06.114713 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m12:41:06.117655 [debug] [ThreadPool]: On list_retail_dwh_mart: ROLLBACK
[0m12:41:06.118374 [debug] [ThreadPool]: On list_retail_dwh_staging: Close
[0m12:41:06.120225 [debug] [ThreadPool]: On list_retail_dwh_mart: Close
[0m12:41:06.134822 [debug] [MainThread]: Using postgres connection "master"
[0m12:41:06.136083 [debug] [MainThread]: On master: BEGIN
[0m12:41:06.136805 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:41:06.155954 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:41:06.156461 [debug] [MainThread]: Using postgres connection "master"
[0m12:41:06.157019 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:41:06.189012 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m12:41:06.191165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c21117aa-f629-4b4f-9de1-14452bc6628f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc9d1bf920>]}
[0m12:41:06.191743 [debug] [MainThread]: On master: ROLLBACK
[0m12:41:06.194947 [debug] [MainThread]: Using postgres connection "master"
[0m12:41:06.195409 [debug] [MainThread]: On master: BEGIN
[0m12:41:06.198001 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:41:06.198535 [debug] [MainThread]: On master: COMMIT
[0m12:41:06.198885 [debug] [MainThread]: Using postgres connection "master"
[0m12:41:06.199306 [debug] [MainThread]: On master: COMMIT
[0m12:41:06.201040 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:41:06.201478 [debug] [MainThread]: On master: Close
[0m12:41:06.203375 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:41:06.205064 [info ] [MainThread]: 
[0m12:41:06.215383 [debug] [Thread-1 (]: Began running node model.retail_project.stg_customers
[0m12:41:06.216921 [info ] [Thread-1 (]: 1 of 8 START sql view model staging.stg_customers .............................. [RUN]
[0m12:41:06.218637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail_dwh_mart, now model.retail_project.stg_customers)
[0m12:41:06.219926 [debug] [Thread-1 (]: Began compiling node model.retail_project.stg_customers
[0m12:41:06.233554 [debug] [Thread-2 (]: Began running node model.retail_project.stg_products
[0m12:41:06.236610 [debug] [Thread-3 (]: Began running node model.retail_project.stg_sales_transaction
[0m12:41:06.240714 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_project.stg_customers"
[0m12:41:06.235575 [info ] [Thread-2 (]: 2 of 8 START sql view model staging.stg_products ............................... [RUN]
[0m12:41:06.243568 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_retail_dwh_staging, now model.retail_project.stg_products)
[0m12:41:06.244993 [debug] [Thread-4 (]: Began running node model.retail_project.stg_stores
[0m12:41:06.247570 [debug] [Thread-2 (]: Began compiling node model.retail_project.stg_products
[0m12:41:06.239487 [info ] [Thread-3 (]: 3 of 8 START sql view model staging.stg_sales_transaction ...................... [RUN]
[0m12:41:06.256184 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.retail_project.stg_sales_transaction'
[0m12:41:06.250037 [info ] [Thread-4 (]: 4 of 8 START sql view model staging.stg_stores ................................. [RUN]
[0m12:41:06.254740 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_project.stg_products"
[0m12:41:06.248562 [debug] [Thread-1 (]: Timing info for model.retail_project.stg_customers (compile): 12:41:06.220405 => 12:41:06.248268
[0m12:41:06.257376 [debug] [Thread-3 (]: Began compiling node model.retail_project.stg_sales_transaction
[0m12:41:06.259581 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.retail_project.stg_stores'
[0m12:41:06.261959 [debug] [Thread-1 (]: Began executing node model.retail_project.stg_customers
[0m12:41:06.267133 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_project.stg_sales_transaction"
[0m12:41:06.268344 [debug] [Thread-4 (]: Began compiling node model.retail_project.stg_stores
[0m12:41:06.269199 [debug] [Thread-2 (]: Timing info for model.retail_project.stg_products (compile): 12:41:06.251228 => 12:41:06.268910
[0m12:41:06.302993 [debug] [Thread-3 (]: Timing info for model.retail_project.stg_sales_transaction (compile): 12:41:06.263006 => 12:41:06.301603
[0m12:41:06.309873 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_project.stg_stores"
[0m12:41:06.321340 [debug] [Thread-2 (]: Began executing node model.retail_project.stg_products
[0m12:41:06.340311 [debug] [Thread-3 (]: Began executing node model.retail_project.stg_sales_transaction
[0m12:41:06.355948 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_project.stg_products"
[0m12:41:06.366311 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_project.stg_sales_transaction"
[0m12:41:06.369029 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_project.stg_customers"
[0m12:41:06.375810 [debug] [Thread-4 (]: Timing info for model.retail_project.stg_stores (compile): 12:41:06.303670 => 12:41:06.374593
[0m12:41:06.378221 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:41:06.383521 [debug] [Thread-2 (]: On model.retail_project.stg_products: BEGIN
[0m12:41:06.380780 [debug] [Thread-4 (]: Began executing node model.retail_project.stg_stores
[0m12:41:06.382439 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:41:06.377500 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m12:41:06.384848 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:41:06.390559 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_project.stg_stores"
[0m12:41:06.392096 [debug] [Thread-1 (]: On model.retail_project.stg_customers: BEGIN
[0m12:41:06.393774 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: BEGIN
[0m12:41:06.396944 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:41:06.398890 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:41:06.401065 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:41:06.403281 [debug] [Thread-4 (]: On model.retail_project.stg_stores: BEGIN
[0m12:41:06.404280 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:41:06.424140 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:41:06.425314 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:41:06.427019 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */

  create view "retail_dwh"."staging"."stg_products__dbt_tmp"
    
    
  as (
    SELECT
    product_id,
    product_name,
    TRIM(category) AS product_category,
    TRIM(sub_category) AS product_sub_category,
    CAST(price AS NUMERIC) AS product_price
FROM
    "retail_dwh"."raw"."products_raw"
  );
[0m12:41:06.429982 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:41:06.431039 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m12:41:06.432986 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */

  create view "retail_dwh"."staging"."stg_sales_transaction__dbt_tmp"
    
    
  as (
    with source as (
    select
        transaction_id,
        transaction_date,
        customer_id,
        product_id,
        store_id,
        quantity,
        total_price
    from "retail_dwh"."raw"."sales_transaction_raw"
),

typed as (
    select
        transaction_id,
        customer_id,
        product_id,
        store_id,
        transaction_date::date        as transaction_date,
        quantity::integer             as quantity,
        total_price::numeric(18,2)    as total_price,
        case
            when quantity::numeric <> 0
                then total_price::numeric(18,2) / quantity::numeric
            else null
        end                           as unit_price
    from source
)

select * from typed
  );
[0m12:41:06.434361 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:41:06.435793 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:41:06.436888 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */

  create view "retail_dwh"."staging"."stg_stores__dbt_tmp"
    
    
  as (
    with source as (
    select
        store_id,
        store_name,
        city,
        region
    from "retail_dwh"."raw"."stores_raw"
),

renamed as (
    select
        store_id,
        store_name,
        city,
        region as store_region
    from source
)

select * from renamed
  );
[0m12:41:06.437872 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:41:06.439375 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:41:06.462560 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:41:06.464284 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:41:06.467417 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m12:41:06.468791 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
alter table "retail_dwh"."staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m12:41:06.469811 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:41:06.471050 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:41:06.472190 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */
alter table "retail_dwh"."staging"."stg_sales_transaction__dbt_tmp" rename to "stg_sales_transaction"
[0m12:41:06.478046 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:41:06.479878 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */

  create view "retail_dwh"."staging"."stg_customers__dbt_tmp"
    
    
  as (
    SELECT
    customer_id,
    customer_name,
    UPPER(TRIM(gender)) AS customer_gender,
    TRIM(city) AS customer_city,
    CAST(signup_date AS DATE) AS customer_signup_date
FROM
    "retail_dwh"."raw"."customers_raw"
  );
[0m12:41:06.481070 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:41:06.482799 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
alter table "retail_dwh"."staging"."stg_stores__dbt_tmp" rename to "stg_stores"
[0m12:41:06.485676 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:41:06.510250 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:41:06.513837 [debug] [Thread-2 (]: On model.retail_project.stg_products: COMMIT
[0m12:41:06.517365 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: COMMIT
[0m12:41:06.518850 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:41:06.523565 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:41:06.525972 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:41:06.527214 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m12:41:06.530007 [debug] [Thread-4 (]: On model.retail_project.stg_stores: COMMIT
[0m12:41:06.531855 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
alter table "retail_dwh"."staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m12:41:06.533125 [debug] [Thread-2 (]: On model.retail_project.stg_products: COMMIT
[0m12:41:06.534815 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: COMMIT
[0m12:41:06.536053 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:41:06.538138 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:41:06.541975 [debug] [Thread-4 (]: On model.retail_project.stg_stores: COMMIT
[0m12:41:06.543300 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:41:06.546784 [debug] [Thread-1 (]: On model.retail_project.stg_customers: COMMIT
[0m12:41:06.549227 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m12:41:06.563490 [debug] [Thread-2 (]: Applying DROP to: "retail_dwh"."staging"."stg_products__dbt_backup"
[0m12:41:06.564948 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:41:06.566878 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m12:41:06.573639 [debug] [Thread-3 (]: Applying DROP to: "retail_dwh"."staging"."stg_sales_transaction__dbt_backup"
[0m12:41:06.581954 [debug] [Thread-1 (]: On model.retail_project.stg_customers: COMMIT
[0m12:41:06.586614 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m12:41:06.591146 [debug] [Thread-4 (]: Applying DROP to: "retail_dwh"."staging"."stg_stores__dbt_backup"
[0m12:41:06.594021 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m12:41:06.597312 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
drop view if exists "retail_dwh"."staging"."stg_products__dbt_backup" cascade
[0m12:41:06.599622 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m12:41:06.601438 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */
drop view if exists "retail_dwh"."staging"."stg_sales_transaction__dbt_backup" cascade
[0m12:41:06.603897 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:41:06.605760 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
drop view if exists "retail_dwh"."staging"."stg_stores__dbt_backup" cascade
[0m12:41:06.606383 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:41:06.612736 [debug] [Thread-1 (]: Applying DROP to: "retail_dwh"."staging"."stg_customers__dbt_backup"
[0m12:41:06.618000 [debug] [Thread-2 (]: Timing info for model.retail_project.stg_products (execute): 12:41:06.342076 => 12:41:06.617677
[0m12:41:06.618786 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:41:06.621241 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m12:41:06.622879 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:41:06.624141 [debug] [Thread-2 (]: On model.retail_project.stg_products: Close
[0m12:41:06.627641 [debug] [Thread-4 (]: Timing info for model.retail_project.stg_stores (execute): 12:41:06.385541 => 12:41:06.627161
[0m12:41:06.631015 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
drop view if exists "retail_dwh"."staging"."stg_customers__dbt_backup" cascade
[0m12:41:06.634131 [debug] [Thread-3 (]: Timing info for model.retail_project.stg_sales_transaction (execute): 12:41:06.357346 => 12:41:06.633499
[0m12:41:06.635905 [debug] [Thread-4 (]: On model.retail_project.stg_stores: Close
[0m12:41:06.637988 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c21117aa-f629-4b4f-9de1-14452bc6628f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc9c99a8d0>]}
[0m12:41:06.639958 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: Close
[0m12:41:06.647965 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c21117aa-f629-4b4f-9de1-14452bc6628f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc9c186a80>]}
[0m12:41:06.642378 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c21117aa-f629-4b4f-9de1-14452bc6628f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc9c1871d0>]}
[0m12:41:06.645940 [info ] [Thread-2 (]: 2 of 8 OK created sql view model staging.stg_products .......................... [[32mCREATE VIEW[0m in 0.39s]
[0m12:41:06.643949 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:41:06.648807 [info ] [Thread-3 (]: 3 of 8 OK created sql view model staging.stg_sales_transaction ................. [[32mCREATE VIEW[0m in 0.39s]
[0m12:41:06.650973 [info ] [Thread-4 (]: 4 of 8 OK created sql view model staging.stg_stores ............................ [[32mCREATE VIEW[0m in 0.38s]
[0m12:41:06.652587 [debug] [Thread-2 (]: Finished running node model.retail_project.stg_products
[0m12:41:06.656393 [debug] [Thread-1 (]: Timing info for model.retail_project.stg_customers (execute): 12:41:06.269603 => 12:41:06.656026
[0m12:41:06.657497 [debug] [Thread-3 (]: Finished running node model.retail_project.stg_sales_transaction
[0m12:41:06.658547 [debug] [Thread-4 (]: Finished running node model.retail_project.stg_stores
[0m12:41:06.660644 [debug] [Thread-2 (]: Began running node model.retail_project.dim_product
[0m12:41:06.662177 [debug] [Thread-1 (]: On model.retail_project.stg_customers: Close
[0m12:41:06.668224 [info ] [Thread-2 (]: 5 of 8 START sql view model mart.dim_product ................................... [RUN]
[0m12:41:06.670551 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c21117aa-f629-4b4f-9de1-14452bc6628f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc9c95ae40>]}
[0m12:41:06.672002 [debug] [Thread-3 (]: Began running node model.retail_project.dim_store
[0m12:41:06.675734 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_products, now model.retail_project.dim_product)
[0m12:41:06.677302 [info ] [Thread-1 (]: 1 of 8 OK created sql view model staging.stg_customers ......................... [[32mCREATE VIEW[0m in 0.45s]
[0m12:41:06.679874 [debug] [Thread-2 (]: Began compiling node model.retail_project.dim_product
[0m12:41:06.678969 [info ] [Thread-3 (]: 6 of 8 START sql view model mart.dim_store ..................................... [RUN]
[0m12:41:06.681274 [debug] [Thread-1 (]: Finished running node model.retail_project.stg_customers
[0m12:41:06.684753 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_project.dim_product"
[0m12:41:06.686002 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_sales_transaction, now model.retail_project.dim_store)
[0m12:41:06.691758 [debug] [Thread-3 (]: Began compiling node model.retail_project.dim_store
[0m12:41:06.699725 [debug] [Thread-4 (]: Began running node model.retail_project.dim_customer
[0m12:41:06.701124 [info ] [Thread-4 (]: 7 of 8 START sql view model mart.dim_customer .................................. [RUN]
[0m12:41:06.703904 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_stores, now model.retail_project.dim_customer)
[0m12:41:06.705414 [debug] [Thread-4 (]: Began compiling node model.retail_project.dim_customer
[0m12:41:06.709686 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_project.dim_customer"
[0m12:41:06.713669 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_project.dim_store"
[0m12:41:06.715386 [debug] [Thread-2 (]: Timing info for model.retail_project.dim_product (compile): 12:41:06.681850 => 12:41:06.714432
[0m12:41:06.718117 [debug] [Thread-4 (]: Timing info for model.retail_project.dim_customer (compile): 12:41:06.706296 => 12:41:06.717771
[0m12:41:06.719335 [debug] [Thread-2 (]: Began executing node model.retail_project.dim_product
[0m12:41:06.720965 [debug] [Thread-4 (]: Began executing node model.retail_project.dim_customer
[0m12:41:06.723338 [debug] [Thread-3 (]: Timing info for model.retail_project.dim_store (compile): 12:41:06.692991 => 12:41:06.723057
[0m12:41:06.730850 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_project.dim_product"
[0m12:41:06.737518 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_project.dim_customer"
[0m12:41:06.740009 [debug] [Thread-3 (]: Began executing node model.retail_project.dim_store
[0m12:41:06.749003 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_project.dim_store"
[0m12:41:06.751241 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:41:06.752959 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:41:06.754705 [debug] [Thread-2 (]: On model.retail_project.dim_product: BEGIN
[0m12:41:06.756036 [debug] [Thread-4 (]: On model.retail_project.dim_customer: BEGIN
[0m12:41:06.757994 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:41:06.759021 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:41:06.760063 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:41:06.761088 [debug] [Thread-3 (]: On model.retail_project.dim_store: BEGIN
[0m12:41:06.763086 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:41:06.782073 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:41:06.783750 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:41:06.784826 [debug] [Thread-4 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */

  create view "retail_dwh"."mart"."dim_customer__dbt_tmp"
    
    
  as (
    SELECT
    customer_id,
    customer_name,
    customer_gender,
    customer_city,
    customer_signup_date
FROM
    "retail_dwh"."staging"."stg_customers"
  );
[0m12:41:06.785977 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:41:06.786732 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:41:06.788198 [debug] [Thread-2 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */

  create view "retail_dwh"."mart"."dim_product__dbt_tmp"
    
    
  as (
    select
    product_id,
    product_name,
    product_category      as category,
    product_sub_category  as sub_category,
    product_price         as price
from "retail_dwh"."staging"."stg_products"
  );
[0m12:41:06.791581 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:41:06.797008 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:41:06.799035 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:41:06.799948 [debug] [Thread-4 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */
alter table "retail_dwh"."mart"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m12:41:06.800834 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:41:06.802069 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:41:06.807446 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:41:06.809521 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:41:06.810879 [debug] [Thread-3 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */

  create view "retail_dwh"."mart"."dim_store__dbt_tmp"
    
    
  as (
    select
    store_id,
    store_name,
    city as store_city,
    store_region
from "retail_dwh"."staging"."stg_stores"
  );
[0m12:41:06.812755 [debug] [Thread-2 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */
alter table "retail_dwh"."mart"."dim_product__dbt_tmp" rename to "dim_product"
[0m12:41:06.815954 [debug] [Thread-4 (]: On model.retail_project.dim_customer: COMMIT
[0m12:41:06.818108 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:41:06.819217 [debug] [Thread-4 (]: On model.retail_project.dim_customer: COMMIT
[0m12:41:06.820769 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:41:06.826973 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:41:06.827931 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m12:41:06.831127 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:41:06.832257 [debug] [Thread-3 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */
alter table "retail_dwh"."mart"."dim_store__dbt_tmp" rename to "dim_store"
[0m12:41:06.840083 [debug] [Thread-4 (]: Applying DROP to: "retail_dwh"."mart"."dim_customer__dbt_backup"
[0m12:41:06.843882 [debug] [Thread-2 (]: On model.retail_project.dim_product: COMMIT
[0m12:41:06.846666 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_customer"
[0m12:41:06.848629 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:41:06.850123 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:41:06.851427 [debug] [Thread-4 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */
drop view if exists "retail_dwh"."mart"."dim_customer__dbt_backup" cascade
[0m12:41:06.853246 [debug] [Thread-2 (]: On model.retail_project.dim_product: COMMIT
[0m12:41:06.856300 [debug] [Thread-3 (]: On model.retail_project.dim_store: COMMIT
[0m12:41:06.858340 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:41:06.859780 [debug] [Thread-3 (]: On model.retail_project.dim_store: COMMIT
[0m12:41:06.860985 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:41:06.864152 [debug] [Thread-4 (]: Timing info for model.retail_project.dim_customer (execute): 12:41:06.732210 => 12:41:06.863589
[0m12:41:06.865165 [debug] [Thread-4 (]: On model.retail_project.dim_customer: Close
[0m12:41:06.867133 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m12:41:06.874905 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:41:06.880358 [debug] [Thread-2 (]: Applying DROP to: "retail_dwh"."mart"."dim_product__dbt_backup"
[0m12:41:06.882616 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_product"
[0m12:41:06.884662 [debug] [Thread-2 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */
drop view if exists "retail_dwh"."mart"."dim_product__dbt_backup" cascade
[0m12:41:06.887044 [debug] [Thread-3 (]: Applying DROP to: "retail_dwh"."mart"."dim_store__dbt_backup"
[0m12:41:06.889317 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_store"
[0m12:41:06.890836 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c21117aa-f629-4b4f-9de1-14452bc6628f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc9c123350>]}
[0m12:41:06.892021 [debug] [Thread-3 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */
drop view if exists "retail_dwh"."mart"."dim_store__dbt_backup" cascade
[0m12:41:06.893176 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:41:06.894867 [info ] [Thread-4 (]: 7 of 8 OK created sql view model mart.dim_customer ............................. [[32mCREATE VIEW[0m in 0.19s]
[0m12:41:06.898519 [debug] [Thread-2 (]: Timing info for model.retail_project.dim_product (execute): 12:41:06.724084 => 12:41:06.898252
[0m12:41:06.899951 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:41:06.902002 [debug] [Thread-4 (]: Finished running node model.retail_project.dim_customer
[0m12:41:06.903084 [debug] [Thread-2 (]: On model.retail_project.dim_product: Close
[0m12:41:06.906668 [debug] [Thread-3 (]: Timing info for model.retail_project.dim_store (execute): 12:41:06.743295 => 12:41:06.906397
[0m12:41:06.908658 [debug] [Thread-3 (]: On model.retail_project.dim_store: Close
[0m12:41:06.911408 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c21117aa-f629-4b4f-9de1-14452bc6628f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc9bd58830>]}
[0m12:41:06.914078 [info ] [Thread-2 (]: 5 of 8 OK created sql view model mart.dim_product .............................. [[32mCREATE VIEW[0m in 0.24s]
[0m12:41:06.916118 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c21117aa-f629-4b4f-9de1-14452bc6628f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc9bd48b00>]}
[0m12:41:06.917277 [debug] [Thread-2 (]: Finished running node model.retail_project.dim_product
[0m12:41:06.918804 [info ] [Thread-3 (]: 6 of 8 OK created sql view model mart.dim_store ................................ [[32mCREATE VIEW[0m in 0.23s]
[0m12:41:06.921457 [debug] [Thread-3 (]: Finished running node model.retail_project.dim_store
[0m12:41:06.924985 [debug] [Thread-1 (]: Began running node model.retail_project.fact_sales
[0m12:41:06.926557 [info ] [Thread-1 (]: 8 of 8 START sql view model mart.fact_sales .................................... [RUN]
[0m12:41:06.928335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_customers, now model.retail_project.fact_sales)
[0m12:41:06.929420 [debug] [Thread-1 (]: Began compiling node model.retail_project.fact_sales
[0m12:41:06.935268 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_project.fact_sales"
[0m12:41:06.937145 [debug] [Thread-1 (]: Timing info for model.retail_project.fact_sales (compile): 12:41:06.929840 => 12:41:06.936823
[0m12:41:06.938165 [debug] [Thread-1 (]: Began executing node model.retail_project.fact_sales
[0m12:41:06.944682 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_project.fact_sales"
[0m12:41:06.945952 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.fact_sales"
[0m12:41:06.946590 [debug] [Thread-1 (]: On model.retail_project.fact_sales: BEGIN
[0m12:41:06.947059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:41:06.963084 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:41:06.964265 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.fact_sales"
[0m12:41:06.965130 [debug] [Thread-1 (]: On model.retail_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.fact_sales"} */

  create view "retail_dwh"."mart"."fact_sales__dbt_tmp"
    
    
  as (
    with sales as (
    select
        transaction_id,
        transaction_date,
        customer_id,
        product_id,
        store_id,
        quantity,
        unit_price,
        quantity * unit_price as gross_sales
    from "retail_dwh"."staging"."stg_sales_transaction"
),

joined as (
    select
        s.transaction_id,
        s.transaction_date,
        s.customer_id,
        s.product_id,
        s.store_id,
        s.quantity,
        s.unit_price,
        s.gross_sales,

        c.customer_name,
        p.product_name,
        -- p.category,   -- sementara DIHAPUS biar nggak error
        st.store_name,
        st.store_city,
        st.store_region
    from sales s
    left join "retail_dwh"."mart"."dim_customer" c
        on s.customer_id = c.customer_id
    left join "retail_dwh"."mart"."dim_product" p
        on s.product_id = p.product_id
    left join "retail_dwh"."mart"."dim_store" st
        on s.store_id = st.store_id
)

select * from joined
  );
[0m12:41:06.970273 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:41:06.975747 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.fact_sales"
[0m12:41:06.976287 [debug] [Thread-1 (]: On model.retail_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.fact_sales"} */
alter table "retail_dwh"."mart"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m12:41:06.977848 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:41:06.980649 [debug] [Thread-1 (]: On model.retail_project.fact_sales: COMMIT
[0m12:41:06.981203 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.fact_sales"
[0m12:41:06.981589 [debug] [Thread-1 (]: On model.retail_project.fact_sales: COMMIT
[0m12:41:06.986881 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:41:06.994238 [debug] [Thread-1 (]: Applying DROP to: "retail_dwh"."mart"."fact_sales__dbt_backup"
[0m12:41:06.996306 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.fact_sales"
[0m12:41:06.997067 [debug] [Thread-1 (]: On model.retail_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.fact_sales"} */
drop view if exists "retail_dwh"."mart"."fact_sales__dbt_backup" cascade
[0m12:41:06.998969 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:41:07.001845 [debug] [Thread-1 (]: Timing info for model.retail_project.fact_sales (execute): 12:41:06.938666 => 12:41:07.001303
[0m12:41:07.002620 [debug] [Thread-1 (]: On model.retail_project.fact_sales: Close
[0m12:41:07.004453 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c21117aa-f629-4b4f-9de1-14452bc6628f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc9bd37c80>]}
[0m12:41:07.005845 [info ] [Thread-1 (]: 8 of 8 OK created sql view model mart.fact_sales ............................... [[32mCREATE VIEW[0m in 0.08s]
[0m12:41:07.008191 [debug] [Thread-1 (]: Finished running node model.retail_project.fact_sales
[0m12:41:07.013959 [debug] [MainThread]: Using postgres connection "master"
[0m12:41:07.014992 [debug] [MainThread]: On master: BEGIN
[0m12:41:07.015872 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:41:07.036693 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:41:07.037430 [debug] [MainThread]: On master: COMMIT
[0m12:41:07.038219 [debug] [MainThread]: Using postgres connection "master"
[0m12:41:07.038615 [debug] [MainThread]: On master: COMMIT
[0m12:41:07.040231 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:41:07.041054 [debug] [MainThread]: On master: Close
[0m12:41:07.042876 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:41:07.044103 [debug] [MainThread]: Connection 'model.retail_project.fact_sales' was properly closed.
[0m12:41:07.044873 [debug] [MainThread]: Connection 'model.retail_project.dim_product' was properly closed.
[0m12:41:07.046282 [debug] [MainThread]: Connection 'model.retail_project.dim_store' was properly closed.
[0m12:41:07.047039 [debug] [MainThread]: Connection 'model.retail_project.dim_customer' was properly closed.
[0m12:41:07.047734 [info ] [MainThread]: 
[0m12:41:07.048781 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 1.20 seconds (1.20s).
[0m12:41:07.052014 [debug] [MainThread]: Command end result
[0m12:41:07.066459 [info ] [MainThread]: 
[0m12:41:07.067370 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:41:07.068145 [info ] [MainThread]: 
[0m12:41:07.068887 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m12:41:07.071578 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.001541, "process_user_time": 4.463149, "process_kernel_time": 0.911495, "process_mem_max_rss": "151480", "process_out_blocks": "2656", "process_in_blocks": "0"}
[0m12:41:07.072526 [debug] [MainThread]: Command `dbt run` succeeded at 12:41:07.072365 after 3.00 seconds
[0m12:41:07.072974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc9def6240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc9c9c4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc9c199220>]}
[0m12:41:07.073778 [debug] [MainThread]: Flushing usage events
[0m12:41:13.526463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb276926690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb277248440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2769a2f00>]}


============================== 12:41:13.529842 | 51a80bd8-76d4-4808-a754-1e4dfe3b855b ==============================
[0m12:41:13.529842 [info ] [MainThread]: Running with dbt=1.7.0
[0m12:41:13.530668 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/dbt/retail_project/retail_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /root/.dbt', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:41:13.777523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51a80bd8-76d4-4808-a754-1e4dfe3b855b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2768142f0>]}
[0m12:41:13.887614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51a80bd8-76d4-4808-a754-1e4dfe3b855b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb27695a5a0>]}
[0m12:41:13.888486 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m12:41:13.902105 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m12:41:13.929098 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:41:13.929506 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:41:13.930301 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail_project.intermediate
[0m12:41:13.950968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51a80bd8-76d4-4808-a754-1e4dfe3b855b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb27695b080>]}
[0m12:41:13.966594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51a80bd8-76d4-4808-a754-1e4dfe3b855b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb275f7ccb0>]}
[0m12:41:13.967425 [info ] [MainThread]: Found 8 models, 4 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m12:41:13.967796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51a80bd8-76d4-4808-a754-1e4dfe3b855b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2769c5070>]}
[0m12:41:13.972224 [info ] [MainThread]: 
[0m12:41:13.973305 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:41:13.974488 [debug] [MainThread]: Command end result
[0m12:41:13.984750 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.51391363, "process_user_time": 2.837944, "process_kernel_time": 0.354547, "process_mem_max_rss": "151476", "process_out_blocks": "1616", "process_in_blocks": "0"}
[0m12:41:13.985394 [debug] [MainThread]: Command `dbt test` succeeded at 12:41:13.985240 after 0.51 seconds
[0m12:41:13.985787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb27b7fa810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb276283290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb276329550>]}
[0m12:41:13.986195 [debug] [MainThread]: Flushing usage events
[0m13:00:07.067458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa800e1e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa80363440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa800e1eb0>]}


============================== 13:00:07.073568 | cbc522b8-d910-44a8-8051-4c3c03ec53a7 ==============================
[0m13:00:07.073568 [info ] [MainThread]: Running with dbt=1.7.0
[0m13:00:07.074674 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/dbt/retail_project/retail_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps --profiles-dir /root/.dbt', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:00:07.229831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbc522b8-d910-44a8-8051-4c3c03ec53a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa800e1c40>]}
[0m13:00:07.230663 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:00:07.232011 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:00:07.233633 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.24939577, "process_user_time": 2.962519, "process_kernel_time": 0.360503, "process_mem_max_rss": "151564", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m13:00:07.234418 [debug] [MainThread]: Command `dbt deps` succeeded at 13:00:07.234235 after 0.25 seconds
[0m13:00:07.234875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa804b1df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa8015c8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa8015e960>]}
[0m13:00:07.235319 [debug] [MainThread]: Flushing usage events
[0m13:00:15.116974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e5ad9ede0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e5ad9daf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e5ad9d2e0>]}


============================== 13:00:15.126549 | b6f52430-c926-4dbc-8f01-73d59035cf27 ==============================
[0m13:00:15.126549 [info ] [MainThread]: Running with dbt=1.7.0
[0m13:00:15.128152 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/opt/dbt/retail_project/retail_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /root/.dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:00:15.437080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6f52430-c926-4dbc-8f01-73d59035cf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e5ac7b6b0>]}
[0m13:00:15.575663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6f52430-c926-4dbc-8f01-73d59035cf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e5ad9c8c0>]}
[0m13:00:15.576772 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m13:00:15.601801 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m13:00:15.633574 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:00:15.634083 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:00:15.635008 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail_project.intermediate
[0m13:00:15.643968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6f52430-c926-4dbc-8f01-73d59035cf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e5a366ab0>]}
[0m13:00:15.668730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6f52430-c926-4dbc-8f01-73d59035cf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e5a39d250>]}
[0m13:00:15.669368 [info ] [MainThread]: Found 8 models, 4 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m13:00:15.670286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6f52430-c926-4dbc-8f01-73d59035cf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e5ac678c0>]}
[0m13:00:15.672813 [info ] [MainThread]: 
[0m13:00:15.674685 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:00:15.678873 [debug] [ThreadPool]: Acquiring new postgres connection 'list_retail_dwh'
[0m13:00:15.695098 [debug] [ThreadPool]: Acquiring new postgres connection 'list_retail_dwh'
[0m13:00:15.709145 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh"
[0m13:00:15.710761 [debug] [ThreadPool]: On list_retail_dwh: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh"} */

    select distinct nspname from pg_namespace
  
[0m13:00:15.712928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:15.722383 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh"
[0m13:00:15.723181 [debug] [ThreadPool]: On list_retail_dwh: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh"} */

    select distinct nspname from pg_namespace
  
[0m13:00:15.724121 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:15.735685 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m13:00:15.737308 [debug] [ThreadPool]: On list_retail_dwh: Close
[0m13:00:15.744059 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m13:00:15.746165 [debug] [ThreadPool]: On list_retail_dwh: Close
[0m13:00:15.752373 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_dwh, now list_retail_dwh_staging)
[0m13:00:15.762159 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_dwh, now list_retail_dwh_mart)
[0m13:00:15.774465 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_staging"
[0m13:00:15.775182 [debug] [ThreadPool]: On list_retail_dwh_staging: BEGIN
[0m13:00:15.776337 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:00:15.781986 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_mart"
[0m13:00:15.783263 [debug] [ThreadPool]: On list_retail_dwh_mart: BEGIN
[0m13:00:15.783889 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:00:15.796192 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:00:15.796682 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_staging"
[0m13:00:15.797136 [debug] [ThreadPool]: On list_retail_dwh_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh_staging"} */
select
      'retail_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'retail_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'retail_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m13:00:15.802905 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:00:15.803738 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_mart"
[0m13:00:15.804930 [debug] [ThreadPool]: On list_retail_dwh_mart: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh_mart"} */
select
      'retail_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'retail_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
    union all
    select
      'retail_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'mart'
  
[0m13:00:15.805837 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:00:15.807592 [debug] [ThreadPool]: On list_retail_dwh_staging: ROLLBACK
[0m13:00:15.808736 [debug] [ThreadPool]: On list_retail_dwh_staging: Close
[0m13:00:15.810345 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:00:15.818065 [debug] [ThreadPool]: On list_retail_dwh_mart: ROLLBACK
[0m13:00:15.819376 [debug] [ThreadPool]: On list_retail_dwh_mart: Close
[0m13:00:15.833281 [debug] [MainThread]: Using postgres connection "master"
[0m13:00:15.834036 [debug] [MainThread]: On master: BEGIN
[0m13:00:15.834425 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:00:15.850948 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:00:15.851573 [debug] [MainThread]: Using postgres connection "master"
[0m13:00:15.852028 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:00:15.891207 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m13:00:15.898159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6f52430-c926-4dbc-8f01-73d59035cf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e5bd5f230>]}
[0m13:00:15.898692 [debug] [MainThread]: On master: ROLLBACK
[0m13:00:15.899820 [debug] [MainThread]: Using postgres connection "master"
[0m13:00:15.901161 [debug] [MainThread]: On master: BEGIN
[0m13:00:15.903782 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:00:15.905133 [debug] [MainThread]: On master: COMMIT
[0m13:00:15.905482 [debug] [MainThread]: Using postgres connection "master"
[0m13:00:15.905786 [debug] [MainThread]: On master: COMMIT
[0m13:00:15.907073 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:00:15.907472 [debug] [MainThread]: On master: Close
[0m13:00:15.909622 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:00:15.911470 [info ] [MainThread]: 
[0m13:00:15.921615 [debug] [Thread-1 (]: Began running node model.retail_project.stg_customers
[0m13:00:15.922884 [debug] [Thread-2 (]: Began running node model.retail_project.stg_products
[0m13:00:15.925974 [debug] [Thread-3 (]: Began running node model.retail_project.stg_sales_transaction
[0m13:00:15.924546 [info ] [Thread-1 (]: 1 of 8 START sql view model staging.stg_customers .............................. [RUN]
[0m13:00:15.935283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail_dwh_mart, now model.retail_project.stg_customers)
[0m13:00:15.927485 [info ] [Thread-2 (]: 2 of 8 START sql view model staging.stg_products ............................... [RUN]
[0m13:00:15.931996 [info ] [Thread-3 (]: 3 of 8 START sql view model staging.stg_sales_transaction ...................... [RUN]
[0m13:00:15.929329 [debug] [Thread-4 (]: Began running node model.retail_project.stg_stores
[0m13:00:15.936392 [debug] [Thread-1 (]: Began compiling node model.retail_project.stg_customers
[0m13:00:15.938202 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_retail_dwh_staging, now model.retail_project.stg_products)
[0m13:00:15.940260 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.retail_project.stg_sales_transaction'
[0m13:00:15.941929 [info ] [Thread-4 (]: 4 of 8 START sql view model staging.stg_stores ................................. [RUN]
[0m13:00:15.952916 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_project.stg_customers"
[0m13:00:15.955281 [debug] [Thread-2 (]: Began compiling node model.retail_project.stg_products
[0m13:00:15.956769 [debug] [Thread-3 (]: Began compiling node model.retail_project.stg_sales_transaction
[0m13:00:15.958960 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.retail_project.stg_stores'
[0m13:00:15.971588 [debug] [Thread-4 (]: Began compiling node model.retail_project.stg_stores
[0m13:00:15.969175 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_project.stg_sales_transaction"
[0m13:00:15.970378 [debug] [Thread-1 (]: Timing info for model.retail_project.stg_customers (compile): 13:00:15.943381 => 13:00:15.970068
[0m13:00:15.963706 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_project.stg_products"
[0m13:00:15.980056 [debug] [Thread-3 (]: Timing info for model.retail_project.stg_sales_transaction (compile): 13:00:15.965645 => 13:00:15.979716
[0m13:00:15.978629 [debug] [Thread-1 (]: Began executing node model.retail_project.stg_customers
[0m13:00:15.975785 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_project.stg_stores"
[0m13:00:15.981934 [debug] [Thread-3 (]: Began executing node model.retail_project.stg_sales_transaction
[0m13:00:15.999939 [debug] [Thread-2 (]: Timing info for model.retail_project.stg_products (compile): 13:00:15.960389 => 13:00:15.998927
[0m13:00:16.049811 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_project.stg_customers"
[0m13:00:16.050537 [debug] [Thread-4 (]: Timing info for model.retail_project.stg_stores (compile): 13:00:15.972000 => 13:00:16.050215
[0m13:00:16.069019 [debug] [Thread-4 (]: Began executing node model.retail_project.stg_stores
[0m13:00:16.065111 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_project.stg_sales_transaction"
[0m13:00:16.067866 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m13:00:16.060077 [debug] [Thread-2 (]: Began executing node model.retail_project.stg_products
[0m13:00:16.076928 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_project.stg_stores"
[0m13:00:16.079906 [debug] [Thread-1 (]: On model.retail_project.stg_customers: BEGIN
[0m13:00:16.086997 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_project.stg_products"
[0m13:00:16.090513 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m13:00:16.091604 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m13:00:16.092917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:00:16.094809 [debug] [Thread-4 (]: On model.retail_project.stg_stores: BEGIN
[0m13:00:16.096449 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m13:00:16.098180 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: BEGIN
[0m13:00:16.102397 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:00:16.104232 [debug] [Thread-2 (]: On model.retail_project.stg_products: BEGIN
[0m13:00:16.106063 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:00:16.110796 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:00:16.121594 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:00:16.122512 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m13:00:16.123732 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */

  create view "retail_dwh"."staging"."stg_customers__dbt_tmp"
    
    
  as (
    SELECT
    customer_id,
    customer_name,
    UPPER(TRIM(gender)) AS customer_gender,
    TRIM(city) AS customer_city,
    CAST(signup_date AS DATE) AS customer_signup_date
FROM
    "retail_dwh"."raw"."customers_raw"
  );
[0m13:00:16.131852 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m13:00:16.132610 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m13:00:16.133638 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */

  create view "retail_dwh"."staging"."stg_stores__dbt_tmp"
    
    
  as (
    with source as (
    select
        store_id,
        store_name,
        city,
        region
    from "retail_dwh"."raw"."stores_raw"
),

renamed as (
    select
        store_id,
        store_name,
        city,
        region as store_region
    from source
)

select * from renamed
  );
[0m13:00:16.137037 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m13:00:16.139079 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m13:00:16.141239 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:00:16.140224 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:00:16.142375 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m13:00:16.144014 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */

  create view "retail_dwh"."staging"."stg_products__dbt_tmp"
    
    
  as (
    SELECT
    product_id,
    product_name,
    TRIM(category) AS product_category,
    TRIM(sub_category) AS product_sub_category,
    CAST(price AS NUMERIC) AS product_price
FROM
    "retail_dwh"."raw"."products_raw"
  );
[0m13:00:16.157378 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m13:00:16.164723 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m13:00:16.169128 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m13:00:16.293738 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
alter table "retail_dwh"."staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m13:00:16.297239 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
alter table "retail_dwh"."staging"."stg_stores" rename to "stg_stores__dbt_backup"
[0m13:00:16.300465 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */

  create view "retail_dwh"."staging"."stg_sales_transaction__dbt_tmp"
    
    
  as (
    with source as (
    select
        transaction_id,
        transaction_date,
        customer_id,
        product_id,
        store_id,
        quantity,
        total_price
    from "retail_dwh"."raw"."sales_transaction_raw"
),

typed as (
    select
        transaction_id,
        customer_id,
        product_id,
        store_id,
        transaction_date::date        as transaction_date,
        quantity::integer             as quantity,
        total_price::numeric(18,2)    as total_price,
        case
            when quantity::numeric <> 0
                then total_price::numeric(18,2) / quantity::numeric
            else null
        end                           as unit_price
    from source
)

select * from typed
  );
[0m13:00:16.423049 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:00:16.303991 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:00:16.432080 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m13:00:16.439417 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:00:16.440504 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
alter table "retail_dwh"."staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m13:00:16.442166 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:00:16.446499 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m13:00:16.459916 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m13:00:16.468735 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m13:00:16.475309 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
alter table "retail_dwh"."staging"."stg_stores__dbt_tmp" rename to "stg_stores"
[0m13:00:16.472790 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:00:16.470381 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
alter table "retail_dwh"."staging"."stg_products" rename to "stg_products__dbt_backup"
[0m13:00:16.474021 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */
alter table "retail_dwh"."staging"."stg_sales_transaction" rename to "stg_sales_transaction__dbt_backup"
[0m13:00:16.485045 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:00:16.504226 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:00:16.535147 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m13:00:16.537801 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
alter table "retail_dwh"."staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:00:16.542572 [debug] [Thread-1 (]: On model.retail_project.stg_customers: COMMIT
[0m13:00:16.545303 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m13:00:16.547071 [debug] [Thread-1 (]: On model.retail_project.stg_customers: COMMIT
[0m13:00:16.549078 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:00:16.550694 [debug] [Thread-4 (]: On model.retail_project.stg_stores: COMMIT
[0m13:00:16.552100 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:00:16.562854 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m13:00:16.564804 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m13:00:16.568290 [debug] [Thread-2 (]: On model.retail_project.stg_products: COMMIT
[0m13:00:16.570487 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:00:16.572773 [debug] [Thread-4 (]: On model.retail_project.stg_stores: COMMIT
[0m13:00:16.574307 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */
alter table "retail_dwh"."staging"."stg_sales_transaction__dbt_tmp" rename to "stg_sales_transaction"
[0m13:00:16.575488 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m13:00:16.592862 [debug] [Thread-1 (]: Applying DROP to: "retail_dwh"."staging"."stg_customers__dbt_backup"
[0m13:00:16.593942 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m13:00:16.595861 [debug] [Thread-2 (]: On model.retail_project.stg_products: COMMIT
[0m13:00:16.608708 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:00:16.615484 [debug] [Thread-4 (]: Applying DROP to: "retail_dwh"."staging"."stg_stores__dbt_backup"
[0m13:00:16.618609 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m13:00:16.631079 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m13:00:16.629391 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m13:00:16.625890 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: COMMIT
[0m13:00:16.632818 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
drop view if exists "retail_dwh"."staging"."stg_customers__dbt_backup" cascade
[0m13:00:16.646110 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
drop view if exists "retail_dwh"."staging"."stg_stores__dbt_backup" cascade
[0m13:00:16.641870 [debug] [Thread-2 (]: Applying DROP to: "retail_dwh"."staging"."stg_products__dbt_backup"
[0m13:00:16.648720 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m13:00:16.653824 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m13:00:16.656085 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: COMMIT
[0m13:00:16.660294 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
drop view if exists "retail_dwh"."staging"."stg_products__dbt_backup" cascade
[0m13:00:16.662166 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:00:16.665949 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:00:16.667548 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m13:00:16.671433 [debug] [Thread-1 (]: Timing info for model.retail_project.stg_customers (execute): 13:00:15.982961 => 13:00:16.670933
[0m13:00:16.677890 [debug] [Thread-4 (]: Timing info for model.retail_project.stg_stores (execute): 13:00:16.069514 => 13:00:16.677273
[0m13:00:16.679527 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:00:16.685412 [debug] [Thread-3 (]: Applying DROP to: "retail_dwh"."staging"."stg_sales_transaction__dbt_backup"
[0m13:00:16.687981 [debug] [Thread-1 (]: On model.retail_project.stg_customers: Close
[0m13:00:16.689748 [debug] [Thread-4 (]: On model.retail_project.stg_stores: Close
[0m13:00:16.694573 [debug] [Thread-2 (]: Timing info for model.retail_project.stg_products (execute): 13:00:16.080651 => 13:00:16.694149
[0m13:00:16.697151 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m13:00:16.700138 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6f52430-c926-4dbc-8f01-73d59035cf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e59b2ad20>]}
[0m13:00:16.704210 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6f52430-c926-4dbc-8f01-73d59035cf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e59b280b0>]}
[0m13:00:16.707064 [debug] [Thread-2 (]: On model.retail_project.stg_products: Close
[0m13:00:16.718688 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6f52430-c926-4dbc-8f01-73d59035cf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e5a6cb3b0>]}
[0m13:00:16.711779 [info ] [Thread-1 (]: 1 of 8 OK created sql view model staging.stg_customers ......................... [[32mCREATE VIEW[0m in 0.77s]
[0m13:00:16.715127 [info ] [Thread-4 (]: 4 of 8 OK created sql view model staging.stg_stores ............................ [[32mCREATE VIEW[0m in 0.75s]
[0m13:00:16.710199 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */
drop view if exists "retail_dwh"."staging"."stg_sales_transaction__dbt_backup" cascade
[0m13:00:16.723888 [debug] [Thread-1 (]: Finished running node model.retail_project.stg_customers
[0m13:00:16.719610 [info ] [Thread-2 (]: 2 of 8 OK created sql view model staging.stg_products .......................... [[32mCREATE VIEW[0m in 0.78s]
[0m13:00:16.726760 [debug] [Thread-4 (]: Finished running node model.retail_project.stg_stores
[0m13:00:16.731381 [debug] [Thread-2 (]: Finished running node model.retail_project.stg_products
[0m13:00:16.735609 [debug] [Thread-4 (]: Began running node model.retail_project.dim_customer
[0m13:00:16.736934 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:00:16.739826 [debug] [Thread-2 (]: Began running node model.retail_project.dim_store
[0m13:00:16.742215 [info ] [Thread-4 (]: 5 of 8 START sql view model mart.dim_customer .................................. [RUN]
[0m13:00:16.747798 [debug] [Thread-3 (]: Timing info for model.retail_project.stg_sales_transaction (execute): 13:00:16.020785 => 13:00:16.747442
[0m13:00:16.750941 [info ] [Thread-2 (]: 6 of 8 START sql view model mart.dim_store ..................................... [RUN]
[0m13:00:16.753728 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_stores, now model.retail_project.dim_customer)
[0m13:00:16.754799 [debug] [Thread-1 (]: Began running node model.retail_project.dim_product
[0m13:00:16.756336 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: Close
[0m13:00:16.758706 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_products, now model.retail_project.dim_store)
[0m13:00:16.761271 [debug] [Thread-4 (]: Began compiling node model.retail_project.dim_customer
[0m13:00:16.763373 [info ] [Thread-1 (]: 7 of 8 START sql view model mart.dim_product ................................... [RUN]
[0m13:00:16.766742 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6f52430-c926-4dbc-8f01-73d59035cf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e59b2abd0>]}
[0m13:00:16.769820 [debug] [Thread-2 (]: Began compiling node model.retail_project.dim_store
[0m13:00:16.774867 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_project.dim_customer"
[0m13:00:16.778448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_customers, now model.retail_project.dim_product)
[0m13:00:16.781452 [info ] [Thread-3 (]: 3 of 8 OK created sql view model staging.stg_sales_transaction ................. [[32mCREATE VIEW[0m in 0.83s]
[0m13:00:16.791439 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_project.dim_store"
[0m13:00:16.795385 [debug] [Thread-4 (]: Timing info for model.retail_project.dim_customer (compile): 13:00:16.770933 => 13:00:16.792412
[0m13:00:16.797770 [debug] [Thread-1 (]: Began compiling node model.retail_project.dim_product
[0m13:00:16.799326 [debug] [Thread-3 (]: Finished running node model.retail_project.stg_sales_transaction
[0m13:00:16.801311 [debug] [Thread-4 (]: Began executing node model.retail_project.dim_customer
[0m13:00:16.805692 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_project.dim_product"
[0m13:00:16.807113 [debug] [Thread-2 (]: Timing info for model.retail_project.dim_store (compile): 13:00:16.783051 => 13:00:16.806784
[0m13:00:16.814108 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_project.dim_customer"
[0m13:00:16.819183 [debug] [Thread-1 (]: Timing info for model.retail_project.dim_product (compile): 13:00:16.802739 => 13:00:16.818737
[0m13:00:16.821242 [debug] [Thread-2 (]: Began executing node model.retail_project.dim_store
[0m13:00:16.823481 [debug] [Thread-1 (]: Began executing node model.retail_project.dim_product
[0m13:00:16.832520 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_project.dim_store"
[0m13:00:16.833479 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_customer"
[0m13:00:16.840034 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_project.dim_product"
[0m13:00:16.843256 [debug] [Thread-4 (]: On model.retail_project.dim_customer: BEGIN
[0m13:00:16.845846 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:00:16.847926 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_store"
[0m13:00:16.849227 [debug] [Thread-2 (]: On model.retail_project.dim_store: BEGIN
[0m13:00:16.850255 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:00:16.852916 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_product"
[0m13:00:16.853767 [debug] [Thread-1 (]: On model.retail_project.dim_product: BEGIN
[0m13:00:16.854384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:00:16.864202 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m13:00:16.865176 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_customer"
[0m13:00:16.866094 [debug] [Thread-4 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */

  create view "retail_dwh"."mart"."dim_customer__dbt_tmp"
    
    
  as (
    SELECT
    customer_id,
    customer_name,
    customer_gender,
    customer_city,
    customer_signup_date
FROM
    "retail_dwh"."staging"."stg_customers"
  );
[0m13:00:16.866898 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m13:00:16.867524 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_store"
[0m13:00:16.868161 [debug] [Thread-2 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */

  create view "retail_dwh"."mart"."dim_store__dbt_tmp"
    
    
  as (
    select
    store_id,
    store_name,
    city as store_city,
    store_region
from "retail_dwh"."staging"."stg_stores"
  );
[0m13:00:16.868851 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:00:16.876805 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_customer"
[0m13:00:16.879318 [debug] [Thread-4 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */
alter table "retail_dwh"."mart"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m13:00:16.881577 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:00:16.886642 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_store"
[0m13:00:16.888994 [debug] [Thread-2 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */
alter table "retail_dwh"."mart"."dim_store__dbt_tmp" rename to "dim_store"
[0m13:00:16.890942 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:00:16.894441 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:00:16.896649 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:00:16.901815 [debug] [Thread-4 (]: On model.retail_project.dim_customer: COMMIT
[0m13:00:16.903186 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_product"
[0m13:00:16.907022 [debug] [Thread-2 (]: On model.retail_project.dim_store: COMMIT
[0m13:00:16.908529 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_customer"
[0m13:00:16.910945 [debug] [Thread-1 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */

  create view "retail_dwh"."mart"."dim_product__dbt_tmp"
    
    
  as (
    select
    product_id,
    product_name,
    product_category      as category,
    product_sub_category  as sub_category,
    product_price         as price
from "retail_dwh"."staging"."stg_products"
  );
[0m13:00:16.912040 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_store"
[0m13:00:16.913169 [debug] [Thread-4 (]: On model.retail_project.dim_customer: COMMIT
[0m13:00:16.915048 [debug] [Thread-2 (]: On model.retail_project.dim_store: COMMIT
[0m13:00:16.917465 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:00:16.923431 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_product"
[0m13:00:16.924780 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m13:00:16.926887 [debug] [Thread-1 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */
alter table "retail_dwh"."mart"."dim_product__dbt_tmp" rename to "dim_product"
[0m13:00:16.928008 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m13:00:16.931915 [debug] [Thread-4 (]: Applying DROP to: "retail_dwh"."mart"."dim_customer__dbt_backup"
[0m13:00:16.937978 [debug] [Thread-2 (]: Applying DROP to: "retail_dwh"."mart"."dim_store__dbt_backup"
[0m13:00:16.940758 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_customer"
[0m13:00:16.943517 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_store"
[0m13:00:16.944878 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:00:16.946262 [debug] [Thread-4 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */
drop view if exists "retail_dwh"."mart"."dim_customer__dbt_backup" cascade
[0m13:00:16.947526 [debug] [Thread-2 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */
drop view if exists "retail_dwh"."mart"."dim_store__dbt_backup" cascade
[0m13:00:16.951012 [debug] [Thread-1 (]: On model.retail_project.dim_product: COMMIT
[0m13:00:16.954849 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_product"
[0m13:00:16.956668 [debug] [Thread-1 (]: On model.retail_project.dim_product: COMMIT
[0m13:00:16.957990 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:00:16.962180 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:00:16.965353 [debug] [Thread-2 (]: Timing info for model.retail_project.dim_store (execute): 13:00:16.826111 => 13:00:16.964957
[0m13:00:16.966692 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:00:16.969490 [debug] [Thread-4 (]: Timing info for model.retail_project.dim_customer (execute): 13:00:16.807978 => 13:00:16.969223
[0m13:00:16.971057 [debug] [Thread-2 (]: On model.retail_project.dim_store: Close
[0m13:00:16.976142 [debug] [Thread-1 (]: Applying DROP to: "retail_dwh"."mart"."dim_product__dbt_backup"
[0m13:00:16.977829 [debug] [Thread-4 (]: On model.retail_project.dim_customer: Close
[0m13:00:16.980397 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6f52430-c926-4dbc-8f01-73d59035cf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e59b316d0>]}
[0m13:00:16.983779 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_product"
[0m13:00:16.985609 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6f52430-c926-4dbc-8f01-73d59035cf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e5972c2f0>]}
[0m13:00:16.988917 [info ] [Thread-2 (]: 6 of 8 OK created sql view model mart.dim_store ................................ [[32mCREATE VIEW[0m in 0.22s]
[0m13:00:16.991422 [debug] [Thread-1 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */
drop view if exists "retail_dwh"."mart"."dim_product__dbt_backup" cascade
[0m13:00:16.994036 [info ] [Thread-4 (]: 5 of 8 OK created sql view model mart.dim_customer ............................. [[32mCREATE VIEW[0m in 0.23s]
[0m13:00:16.997355 [debug] [Thread-2 (]: Finished running node model.retail_project.dim_store
[0m13:00:16.999839 [debug] [Thread-4 (]: Finished running node model.retail_project.dim_customer
[0m13:00:17.002127 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:00:17.006735 [debug] [Thread-1 (]: Timing info for model.retail_project.dim_product (execute): 13:00:16.835113 => 13:00:17.006159
[0m13:00:17.007434 [debug] [Thread-1 (]: On model.retail_project.dim_product: Close
[0m13:00:17.009800 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6f52430-c926-4dbc-8f01-73d59035cf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e59b7df70>]}
[0m13:00:17.011804 [info ] [Thread-1 (]: 7 of 8 OK created sql view model mart.dim_product .............................. [[32mCREATE VIEW[0m in 0.23s]
[0m13:00:17.014432 [debug] [Thread-1 (]: Finished running node model.retail_project.dim_product
[0m13:00:17.017269 [debug] [Thread-3 (]: Began running node model.retail_project.fact_sales
[0m13:00:17.019128 [info ] [Thread-3 (]: 8 of 8 START sql view model mart.fact_sales .................................... [RUN]
[0m13:00:17.023367 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_sales_transaction, now model.retail_project.fact_sales)
[0m13:00:17.024863 [debug] [Thread-3 (]: Began compiling node model.retail_project.fact_sales
[0m13:00:17.031976 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_project.fact_sales"
[0m13:00:17.035974 [debug] [Thread-3 (]: Timing info for model.retail_project.fact_sales (compile): 13:00:17.025466 => 13:00:17.035129
[0m13:00:17.036590 [debug] [Thread-3 (]: Began executing node model.retail_project.fact_sales
[0m13:00:17.047312 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_project.fact_sales"
[0m13:00:17.050802 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.fact_sales"
[0m13:00:17.051417 [debug] [Thread-3 (]: On model.retail_project.fact_sales: BEGIN
[0m13:00:17.051848 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:00:17.073136 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m13:00:17.073684 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.fact_sales"
[0m13:00:17.074281 [debug] [Thread-3 (]: On model.retail_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.fact_sales"} */

  create view "retail_dwh"."mart"."fact_sales__dbt_tmp"
    
    
  as (
    with sales as (
    select
        transaction_id,
        transaction_date,
        customer_id,
        product_id,
        store_id,
        quantity,
        unit_price,
        quantity * unit_price as gross_sales
    from "retail_dwh"."staging"."stg_sales_transaction"
),

joined as (
    select
        s.transaction_id,
        s.transaction_date,
        s.customer_id,
        s.product_id,
        s.store_id,
        s.quantity,
        s.unit_price,
        s.gross_sales,

        c.customer_name,
        p.product_name,
        -- p.category,   -- sementara DIHAPUS biar nggak error
        st.store_name,
        st.store_city,
        st.store_region
    from sales s
    left join "retail_dwh"."mart"."dim_customer" c
        on s.customer_id = c.customer_id
    left join "retail_dwh"."mart"."dim_product" p
        on s.product_id = p.product_id
    left join "retail_dwh"."mart"."dim_store" st
        on s.store_id = st.store_id
)

select * from joined
  );
[0m13:00:17.079932 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:00:17.084315 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.fact_sales"
[0m13:00:17.085124 [debug] [Thread-3 (]: On model.retail_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.fact_sales"} */
alter table "retail_dwh"."mart"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m13:00:17.090024 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:00:17.093519 [debug] [Thread-3 (]: On model.retail_project.fact_sales: COMMIT
[0m13:00:17.094070 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.fact_sales"
[0m13:00:17.094577 [debug] [Thread-3 (]: On model.retail_project.fact_sales: COMMIT
[0m13:00:17.101099 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m13:00:17.104826 [debug] [Thread-3 (]: Applying DROP to: "retail_dwh"."mart"."fact_sales__dbt_backup"
[0m13:00:17.105973 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.fact_sales"
[0m13:00:17.106484 [debug] [Thread-3 (]: On model.retail_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.fact_sales"} */
drop view if exists "retail_dwh"."mart"."fact_sales__dbt_backup" cascade
[0m13:00:17.110797 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:00:17.113163 [debug] [Thread-3 (]: Timing info for model.retail_project.fact_sales (execute): 13:00:17.036899 => 13:00:17.112842
[0m13:00:17.113640 [debug] [Thread-3 (]: On model.retail_project.fact_sales: Close
[0m13:00:17.116260 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6f52430-c926-4dbc-8f01-73d59035cf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e5973aea0>]}
[0m13:00:17.118518 [info ] [Thread-3 (]: 8 of 8 OK created sql view model mart.fact_sales ............................... [[32mCREATE VIEW[0m in 0.09s]
[0m13:00:17.121087 [debug] [Thread-3 (]: Finished running node model.retail_project.fact_sales
[0m13:00:17.128862 [debug] [MainThread]: Using postgres connection "master"
[0m13:00:17.129558 [debug] [MainThread]: On master: BEGIN
[0m13:00:17.129957 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:00:17.147914 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:00:17.148948 [debug] [MainThread]: On master: COMMIT
[0m13:00:17.149895 [debug] [MainThread]: Using postgres connection "master"
[0m13:00:17.150293 [debug] [MainThread]: On master: COMMIT
[0m13:00:17.152024 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:00:17.152473 [debug] [MainThread]: On master: Close
[0m13:00:17.154587 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:00:17.155266 [debug] [MainThread]: Connection 'model.retail_project.dim_store' was properly closed.
[0m13:00:17.156161 [debug] [MainThread]: Connection 'model.retail_project.dim_product' was properly closed.
[0m13:00:17.156634 [debug] [MainThread]: Connection 'model.retail_project.fact_sales' was properly closed.
[0m13:00:17.158002 [debug] [MainThread]: Connection 'model.retail_project.dim_customer' was properly closed.
[0m13:00:17.158539 [info ] [MainThread]: 
[0m13:00:17.159662 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 1.48 seconds (1.48s).
[0m13:00:17.162118 [debug] [MainThread]: Command end result
[0m13:00:17.178732 [info ] [MainThread]: 
[0m13:00:17.181021 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:00:17.181880 [info ] [MainThread]: 
[0m13:00:17.183468 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m13:00:17.186786 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1347601, "process_user_time": 3.640543, "process_kernel_time": 1.137363, "process_mem_max_rss": "151480", "process_out_blocks": "1880", "process_in_blocks": "0"}
[0m13:00:17.187534 [debug] [MainThread]: Command `dbt run` succeeded at 13:00:17.187326 after 2.14 seconds
[0m13:00:17.188007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e5b45d100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e5c7aa4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e59725760>]}
[0m13:00:17.188598 [debug] [MainThread]: Flushing usage events
[0m13:00:24.191909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e4907afc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e49165c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e4966cbf0>]}


============================== 13:00:24.195322 | 4eb00952-a503-4811-9ded-2d67cd7b85fb ==============================
[0m13:00:24.195322 [info ] [MainThread]: Running with dbt=1.7.0
[0m13:00:24.196733 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/dbt/retail_project/retail_project/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /root/.dbt', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:00:24.455179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4eb00952-a503-4811-9ded-2d67cd7b85fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e49140830>]}
[0m13:00:24.586121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4eb00952-a503-4811-9ded-2d67cd7b85fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e495c8140>]}
[0m13:00:24.588903 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m13:00:24.601784 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m13:00:24.639529 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:00:24.640791 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:00:24.643474 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail_project.intermediate
[0m13:00:24.652113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4eb00952-a503-4811-9ded-2d67cd7b85fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e48ede420>]}
[0m13:00:24.673033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4eb00952-a503-4811-9ded-2d67cd7b85fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e483951c0>]}
[0m13:00:24.673649 [info ] [MainThread]: Found 8 models, 4 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m13:00:24.677063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4eb00952-a503-4811-9ded-2d67cd7b85fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e49db63f0>]}
[0m13:00:24.683853 [info ] [MainThread]: 
[0m13:00:24.684655 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:00:24.685281 [debug] [MainThread]: Command end result
[0m13:00:24.699953 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.577109, "process_user_time": 3.444039, "process_kernel_time": 0.592622, "process_mem_max_rss": "151476", "process_out_blocks": "1616", "process_in_blocks": "0"}
[0m13:00:24.700564 [debug] [MainThread]: Command `dbt test` succeeded at 13:00:24.700416 after 0.58 seconds
[0m13:00:24.701062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e491640b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e4907b2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e4907a240>]}
[0m13:00:24.701484 [debug] [MainThread]: Flushing usage events
[0m13:19:44.620336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e429d2cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e43612240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e429d3d40>]}


============================== 13:19:44.624240 | f864dd8c-5547-4c52-bb98-291515358f11 ==============================
[0m13:19:44.624240 [info ] [MainThread]: Running with dbt=1.7.0
[0m13:19:44.626473 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/opt/dbt/retail_project/retail_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /root/.dbt', 'send_anonymous_usage_stats': 'True'}
[0m13:19:44.861493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f864dd8c-5547-4c52-bb98-291515358f11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e42a2f320>]}
[0m13:19:44.973114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f864dd8c-5547-4c52-bb98-291515358f11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e42a2ff50>]}
[0m13:19:44.974026 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m13:19:44.990244 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m13:19:45.002675 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:19:45.006829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f864dd8c-5547-4c52-bb98-291515358f11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e41defaa0>]}
[0m13:19:46.231108 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail_project.intermediate
[0m13:19:46.242560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f864dd8c-5547-4c52-bb98-291515358f11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e42c1e0c0>]}
[0m13:19:46.261480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f864dd8c-5547-4c52-bb98-291515358f11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e41526db0>]}
[0m13:19:46.262476 [info ] [MainThread]: Found 11 models, 4 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m13:19:46.262965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f864dd8c-5547-4c52-bb98-291515358f11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e415442f0>]}
[0m13:19:46.265474 [info ] [MainThread]: 
[0m13:19:46.266508 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:19:46.271279 [debug] [ThreadPool]: Acquiring new postgres connection 'list_retail_dwh'
[0m13:19:46.273650 [debug] [ThreadPool]: Acquiring new postgres connection 'list_retail_dwh'
[0m13:19:46.288426 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh"
[0m13:19:46.297564 [debug] [ThreadPool]: On list_retail_dwh: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh"} */

    select distinct nspname from pg_namespace
  
[0m13:19:46.298566 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:19:46.300662 [debug] [ThreadPool]: Acquiring new postgres connection 'list_retail_dwh'
[0m13:19:46.295134 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh"
[0m13:19:46.307028 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh"
[0m13:19:46.309951 [debug] [ThreadPool]: On list_retail_dwh: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh"} */

    select distinct nspname from pg_namespace
  
[0m13:19:46.310389 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:19:46.308879 [debug] [ThreadPool]: On list_retail_dwh: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh"} */

    select distinct nspname from pg_namespace
  
[0m13:19:46.311861 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:19:46.322924 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m13:19:46.325501 [debug] [ThreadPool]: On list_retail_dwh: Close
[0m13:19:46.331621 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m13:19:46.334628 [debug] [ThreadPool]: On list_retail_dwh: Close
[0m13:19:46.340755 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m13:19:46.342760 [debug] [ThreadPool]: On list_retail_dwh: Close
[0m13:19:46.346886 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_dwh, now create_retail_dwh_analytics)
[0m13:19:46.348861 [debug] [ThreadPool]: Creating schema "database: "retail_dwh"
schema: "analytics"
"
[0m13:19:46.357721 [debug] [ThreadPool]: Using postgres connection "create_retail_dwh_analytics"
[0m13:19:46.358306 [debug] [ThreadPool]: On create_retail_dwh_analytics: BEGIN
[0m13:19:46.358676 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:19:46.375721 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:19:46.376891 [debug] [ThreadPool]: Using postgres connection "create_retail_dwh_analytics"
[0m13:19:46.377314 [debug] [ThreadPool]: On create_retail_dwh_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "create_retail_dwh_analytics"} */
create schema if not exists "analytics"
[0m13:19:46.380090 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m13:19:46.381799 [debug] [ThreadPool]: On create_retail_dwh_analytics: COMMIT
[0m13:19:46.382249 [debug] [ThreadPool]: Using postgres connection "create_retail_dwh_analytics"
[0m13:19:46.382641 [debug] [ThreadPool]: On create_retail_dwh_analytics: COMMIT
[0m13:19:46.394375 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m13:19:46.394931 [debug] [ThreadPool]: On create_retail_dwh_analytics: Close
[0m13:19:46.401914 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_retail_dwh_analytics, now list_retail_dwh_mart)
[0m13:19:46.409371 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_dwh, now list_retail_dwh_staging)
[0m13:19:46.412172 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_dwh, now list_retail_dwh_analytics)
[0m13:19:46.418864 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_staging"
[0m13:19:46.422669 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_mart"
[0m13:19:46.426491 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_analytics"
[0m13:19:46.428702 [debug] [ThreadPool]: On list_retail_dwh_staging: BEGIN
[0m13:19:46.430058 [debug] [ThreadPool]: On list_retail_dwh_mart: BEGIN
[0m13:19:46.430975 [debug] [ThreadPool]: On list_retail_dwh_analytics: BEGIN
[0m13:19:46.432236 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:19:46.433884 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:19:46.435009 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:19:46.448003 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:19:46.448814 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_staging"
[0m13:19:46.450531 [debug] [ThreadPool]: On list_retail_dwh_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh_staging"} */
select
      'retail_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'retail_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'retail_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m13:19:46.454672 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:19:46.455356 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_analytics"
[0m13:19:46.455788 [debug] [ThreadPool]: On list_retail_dwh_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh_analytics"} */
select
      'retail_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'retail_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'retail_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m13:19:46.458344 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:19:46.466970 [debug] [ThreadPool]: On list_retail_dwh_staging: ROLLBACK
[0m13:19:46.468828 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m13:19:46.471896 [debug] [ThreadPool]: On list_retail_dwh_analytics: ROLLBACK
[0m13:19:46.474987 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:19:46.476062 [debug] [ThreadPool]: On list_retail_dwh_staging: Close
[0m13:19:46.477238 [debug] [ThreadPool]: On list_retail_dwh_analytics: Close
[0m13:19:46.478867 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_mart"
[0m13:19:46.485524 [debug] [ThreadPool]: On list_retail_dwh_mart: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh_mart"} */
select
      'retail_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'retail_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
    union all
    select
      'retail_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'mart'
  
[0m13:19:46.489396 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:19:46.491022 [debug] [ThreadPool]: On list_retail_dwh_mart: ROLLBACK
[0m13:19:46.491570 [debug] [ThreadPool]: On list_retail_dwh_mart: Close
[0m13:19:46.505335 [debug] [MainThread]: Using postgres connection "master"
[0m13:19:46.505851 [debug] [MainThread]: On master: BEGIN
[0m13:19:46.506965 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:19:46.521895 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:19:46.522434 [debug] [MainThread]: Using postgres connection "master"
[0m13:19:46.523543 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:19:46.557559 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m13:19:46.563653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f864dd8c-5547-4c52-bb98-291515358f11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e4153d7f0>]}
[0m13:19:46.564716 [debug] [MainThread]: On master: ROLLBACK
[0m13:19:46.565981 [debug] [MainThread]: Using postgres connection "master"
[0m13:19:46.566420 [debug] [MainThread]: On master: BEGIN
[0m13:19:46.569094 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:19:46.569630 [debug] [MainThread]: On master: COMMIT
[0m13:19:46.570308 [debug] [MainThread]: Using postgres connection "master"
[0m13:19:46.571037 [debug] [MainThread]: On master: COMMIT
[0m13:19:46.572077 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:19:46.572509 [debug] [MainThread]: On master: Close
[0m13:19:46.574104 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:19:46.575401 [info ] [MainThread]: 
[0m13:19:46.585218 [debug] [Thread-1 (]: Began running node model.retail_project.stg_customers
[0m13:19:46.586254 [debug] [Thread-2 (]: Began running node model.retail_project.stg_products
[0m13:19:46.589005 [debug] [Thread-3 (]: Began running node model.retail_project.stg_sales_transaction
[0m13:19:46.591147 [debug] [Thread-4 (]: Began running node model.retail_project.stg_stores
[0m13:19:46.587304 [info ] [Thread-1 (]: 1 of 11 START sql view model staging.stg_customers ............................. [RUN]
[0m13:19:46.590238 [info ] [Thread-2 (]: 2 of 11 START sql view model staging.stg_products .............................. [RUN]
[0m13:19:46.599588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail_dwh_mart, now model.retail_project.stg_customers)
[0m13:19:46.592994 [info ] [Thread-3 (]: 3 of 11 START sql view model staging.stg_sales_transaction ..................... [RUN]
[0m13:19:46.602931 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_retail_dwh_analytics, now model.retail_project.stg_products)
[0m13:19:46.595952 [info ] [Thread-4 (]: 4 of 11 START sql view model staging.stg_stores ................................ [RUN]
[0m13:19:46.605197 [debug] [Thread-1 (]: Began compiling node model.retail_project.stg_customers
[0m13:19:46.606734 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_retail_dwh_staging, now model.retail_project.stg_sales_transaction)
[0m13:19:46.608061 [debug] [Thread-2 (]: Began compiling node model.retail_project.stg_products
[0m13:19:46.610049 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.retail_project.stg_stores'
[0m13:19:46.619729 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_project.stg_customers"
[0m13:19:46.623685 [debug] [Thread-3 (]: Began compiling node model.retail_project.stg_sales_transaction
[0m13:19:46.628661 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_project.stg_products"
[0m13:19:46.630652 [debug] [Thread-4 (]: Began compiling node model.retail_project.stg_stores
[0m13:19:46.637143 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_project.stg_sales_transaction"
[0m13:19:46.640823 [debug] [Thread-1 (]: Timing info for model.retail_project.stg_customers (compile): 13:19:46.610888 => 13:19:46.639777
[0m13:19:46.643358 [debug] [Thread-2 (]: Timing info for model.retail_project.stg_products (compile): 13:19:46.624439 => 13:19:46.642722
[0m13:19:46.653685 [debug] [Thread-2 (]: Began executing node model.retail_project.stg_products
[0m13:19:46.651323 [debug] [Thread-1 (]: Began executing node model.retail_project.stg_customers
[0m13:19:46.652861 [debug] [Thread-3 (]: Timing info for model.retail_project.stg_sales_transaction (compile): 13:19:46.631858 => 13:19:46.652513
[0m13:19:46.648298 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_project.stg_stores"
[0m13:19:46.745147 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_project.stg_customers"
[0m13:19:46.746808 [debug] [Thread-3 (]: Began executing node model.retail_project.stg_sales_transaction
[0m13:19:46.749879 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_project.stg_products"
[0m13:19:46.757435 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_project.stg_sales_transaction"
[0m13:19:46.764662 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m13:19:46.761535 [debug] [Thread-4 (]: Timing info for model.retail_project.stg_stores (compile): 13:19:46.644496 => 13:19:46.760947
[0m13:19:46.760331 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m13:19:46.765963 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m13:19:46.767677 [debug] [Thread-2 (]: On model.retail_project.stg_products: BEGIN
[0m13:19:46.769028 [debug] [Thread-4 (]: Began executing node model.retail_project.stg_stores
[0m13:19:46.770008 [debug] [Thread-1 (]: On model.retail_project.stg_customers: BEGIN
[0m13:19:46.770999 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: BEGIN
[0m13:19:46.772112 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:19:46.779217 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_project.stg_stores"
[0m13:19:46.781306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:46.782855 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:19:46.786212 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m13:19:46.788596 [debug] [Thread-4 (]: On model.retail_project.stg_stores: BEGIN
[0m13:19:46.789575 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:19:46.802067 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m13:19:46.803884 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m13:19:46.805733 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */

  create view "retail_dwh"."staging"."stg_products__dbt_tmp"
    
    
  as (
    SELECT
    product_id,
    product_name,
    TRIM(category) AS product_category,
    TRIM(sub_category) AS product_sub_category,
    CAST(price AS NUMERIC) AS product_price
FROM
    "retail_dwh"."raw"."products_raw"
  );
[0m13:19:46.807406 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:19:46.808366 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m13:19:46.810249 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */

  create view "retail_dwh"."staging"."stg_customers__dbt_tmp"
    
    
  as (
    SELECT
    customer_id,
    customer_name,
    UPPER(TRIM(gender)) AS customer_gender,
    TRIM(city) AS customer_city,
    CAST(signup_date AS DATE) AS customer_signup_date
FROM
    "retail_dwh"."raw"."customers_raw"
  );
[0m13:19:46.811789 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:19:46.823646 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:19:46.834195 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m13:19:46.836023 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m13:19:46.837132 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */

  create view "retail_dwh"."staging"."stg_sales_transaction__dbt_tmp"
    
    
  as (
    with source as (
    select
        transaction_id,
        transaction_date,
        customer_id,
        product_id,
        store_id,
        quantity,
        total_price
    from "retail_dwh"."raw"."sales_transaction_raw"
),

typed as (
    select
        transaction_id,
        customer_id,
        product_id,
        store_id,
        transaction_date::date        as transaction_date,
        quantity::integer             as quantity,
        total_price::numeric(18,2)    as total_price,
        case
            when quantity::numeric <> 0
                then total_price::numeric(18,2) / quantity::numeric
            else null
        end                           as unit_price
    from source
)

select * from typed
  );
[0m13:19:46.840772 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m13:19:46.844854 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:19:46.846307 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m13:19:46.848099 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
alter table "retail_dwh"."staging"."stg_products" rename to "stg_products__dbt_backup"
[0m13:19:46.849958 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m13:19:46.855834 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
alter table "retail_dwh"."staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m13:19:46.854269 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m13:19:46.857997 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m13:19:46.860228 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:19:46.861929 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */
alter table "retail_dwh"."staging"."stg_sales_transaction" rename to "stg_sales_transaction__dbt_backup"
[0m13:19:46.863066 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */

  create view "retail_dwh"."staging"."stg_stores__dbt_tmp"
    
    
  as (
    with source as (
    select
        store_id,
        store_name,
        city,
        region
    from "retail_dwh"."raw"."stores_raw"
),

renamed as (
    select
        store_id,
        store_name,
        city,
        region as store_region
    from source
)

select * from renamed
  );
[0m13:19:46.864301 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:19:46.868866 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m13:19:46.877885 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m13:19:46.879189 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:19:46.880524 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
alter table "retail_dwh"."staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:19:46.882320 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
alter table "retail_dwh"."staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m13:19:46.883791 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:19:46.888516 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m13:19:46.895176 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m13:19:46.897069 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */
alter table "retail_dwh"."staging"."stg_sales_transaction__dbt_tmp" rename to "stg_sales_transaction"
[0m13:19:46.898717 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:19:46.899668 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:19:46.900669 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
alter table "retail_dwh"."staging"."stg_stores" rename to "stg_stores__dbt_backup"
[0m13:19:46.921510 [debug] [Thread-1 (]: On model.retail_project.stg_customers: COMMIT
[0m13:19:46.924819 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:19:46.928520 [debug] [Thread-2 (]: On model.retail_project.stg_products: COMMIT
[0m13:19:46.931026 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m13:19:46.934652 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: COMMIT
[0m13:19:46.935923 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:19:46.937088 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m13:19:46.938798 [debug] [Thread-1 (]: On model.retail_project.stg_customers: COMMIT
[0m13:19:46.939996 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m13:19:46.945053 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m13:19:46.946920 [debug] [Thread-2 (]: On model.retail_project.stg_products: COMMIT
[0m13:19:46.948531 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: COMMIT
[0m13:19:46.949866 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
alter table "retail_dwh"."staging"."stg_stores__dbt_tmp" rename to "stg_stores"
[0m13:19:46.951144 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:19:46.962756 [debug] [Thread-1 (]: Applying DROP to: "retail_dwh"."staging"."stg_customers__dbt_backup"
[0m13:19:46.972131 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m13:19:46.975016 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m13:19:46.976893 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
drop view if exists "retail_dwh"."staging"."stg_customers__dbt_backup" cascade
[0m13:19:46.978238 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m13:19:46.983351 [debug] [Thread-2 (]: Applying DROP to: "retail_dwh"."staging"."stg_products__dbt_backup"
[0m13:19:46.984796 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:19:46.991582 [debug] [Thread-3 (]: Applying DROP to: "retail_dwh"."staging"."stg_sales_transaction__dbt_backup"
[0m13:19:46.993635 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m13:19:46.997948 [debug] [Thread-4 (]: On model.retail_project.stg_stores: COMMIT
[0m13:19:46.998967 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:19:47.000897 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m13:19:47.002590 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
drop view if exists "retail_dwh"."staging"."stg_products__dbt_backup" cascade
[0m13:19:47.003839 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m13:19:47.006675 [debug] [Thread-1 (]: Timing info for model.retail_project.stg_customers (execute): 13:19:46.671113 => 13:19:47.006169
[0m13:19:47.008038 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */
drop view if exists "retail_dwh"."staging"."stg_sales_transaction__dbt_backup" cascade
[0m13:19:47.010125 [debug] [Thread-4 (]: On model.retail_project.stg_stores: COMMIT
[0m13:19:47.011946 [debug] [Thread-1 (]: On model.retail_project.stg_customers: Close
[0m13:19:47.014784 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:19:47.018055 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f864dd8c-5547-4c52-bb98-291515358f11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e4117f7d0>]}
[0m13:19:47.022743 [debug] [Thread-2 (]: Timing info for model.retail_project.stg_products (execute): 13:19:46.654593 => 13:19:47.021953
[0m13:19:47.023909 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:19:47.029710 [debug] [Thread-2 (]: On model.retail_project.stg_products: Close
[0m13:19:47.026862 [info ] [Thread-1 (]: 1 of 11 OK created sql view model staging.stg_customers ........................ [[32mCREATE VIEW[0m in 0.42s]
[0m13:19:47.030999 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m13:19:47.033795 [debug] [Thread-3 (]: Timing info for model.retail_project.stg_sales_transaction (execute): 13:19:46.751812 => 13:19:47.033520
[0m13:19:47.035802 [debug] [Thread-1 (]: Finished running node model.retail_project.stg_customers
[0m13:19:47.037549 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f864dd8c-5547-4c52-bb98-291515358f11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e411d9c40>]}
[0m13:19:47.042197 [debug] [Thread-4 (]: Applying DROP to: "retail_dwh"."staging"."stg_stores__dbt_backup"
[0m13:19:47.043683 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: Close
[0m13:19:47.050313 [info ] [Thread-2 (]: 2 of 11 OK created sql view model staging.stg_products ......................... [[32mCREATE VIEW[0m in 0.44s]
[0m13:19:47.054473 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m13:19:47.056953 [debug] [Thread-1 (]: Began running node model.retail_project.dim_customer
[0m13:19:47.058619 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f864dd8c-5547-4c52-bb98-291515358f11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e411daea0>]}
[0m13:19:47.060595 [debug] [Thread-2 (]: Finished running node model.retail_project.stg_products
[0m13:19:47.062368 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
drop view if exists "retail_dwh"."staging"."stg_stores__dbt_backup" cascade
[0m13:19:47.063734 [info ] [Thread-1 (]: 5 of 11 START sql view model mart.dim_customer ................................. [RUN]
[0m13:19:47.070322 [debug] [Thread-2 (]: Began running node model.retail_project.dim_product
[0m13:19:47.072308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_customers, now model.retail_project.dim_customer)
[0m13:19:47.066818 [info ] [Thread-3 (]: 3 of 11 OK created sql view model staging.stg_sales_transaction ................ [[32mCREATE VIEW[0m in 0.45s]
[0m13:19:47.082412 [debug] [Thread-3 (]: Finished running node model.retail_project.stg_sales_transaction
[0m13:19:47.077135 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:19:47.076126 [info ] [Thread-2 (]: 6 of 11 START sql view model mart.dim_product .................................. [RUN]
[0m13:19:47.079467 [debug] [Thread-1 (]: Began compiling node model.retail_project.dim_customer
[0m13:19:47.087590 [debug] [Thread-4 (]: Timing info for model.retail_project.stg_stores (execute): 13:19:46.773274 => 13:19:47.086948
[0m13:19:47.089416 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_products, now model.retail_project.dim_product)
[0m13:19:47.096724 [debug] [Thread-2 (]: Began compiling node model.retail_project.dim_product
[0m13:19:47.095137 [debug] [Thread-4 (]: On model.retail_project.stg_stores: Close
[0m13:19:47.093237 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_project.dim_customer"
[0m13:19:47.100637 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_project.dim_product"
[0m13:19:47.103479 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f864dd8c-5547-4c52-bb98-291515358f11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e411d9d00>]}
[0m13:19:47.107810 [debug] [Thread-1 (]: Timing info for model.retail_project.dim_customer (compile): 13:19:47.090186 => 13:19:47.105228
[0m13:19:47.110059 [info ] [Thread-4 (]: 4 of 11 OK created sql view model staging.stg_stores ........................... [[32mCREATE VIEW[0m in 0.49s]
[0m13:19:47.112290 [debug] [Thread-1 (]: Began executing node model.retail_project.dim_customer
[0m13:19:47.115037 [debug] [Thread-4 (]: Finished running node model.retail_project.stg_stores
[0m13:19:47.116194 [debug] [Thread-2 (]: Timing info for model.retail_project.dim_product (compile): 13:19:47.097135 => 13:19:47.115802
[0m13:19:47.127813 [debug] [Thread-2 (]: Began executing node model.retail_project.dim_product
[0m13:19:47.136013 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_project.dim_customer"
[0m13:19:47.137822 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_project.dim_product"
[0m13:19:47.140866 [debug] [Thread-3 (]: Began running node model.retail_project.dim_store
[0m13:19:47.142829 [info ] [Thread-3 (]: 7 of 11 START sql view model mart.dim_store .................................... [RUN]
[0m13:19:47.146002 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_sales_transaction, now model.retail_project.dim_store)
[0m13:19:47.147745 [debug] [Thread-3 (]: Began compiling node model.retail_project.dim_store
[0m13:19:47.148820 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_customer"
[0m13:19:47.153136 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_project.dim_store"
[0m13:19:47.154285 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_product"
[0m13:19:47.155770 [debug] [Thread-1 (]: On model.retail_project.dim_customer: BEGIN
[0m13:19:47.157234 [debug] [Thread-2 (]: On model.retail_project.dim_product: BEGIN
[0m13:19:47.159381 [debug] [Thread-3 (]: Timing info for model.retail_project.dim_store (compile): 13:19:47.149441 => 13:19:47.158145
[0m13:19:47.161834 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:47.163070 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:19:47.164139 [debug] [Thread-3 (]: Began executing node model.retail_project.dim_store
[0m13:19:47.173276 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_project.dim_store"
[0m13:19:47.174335 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_store"
[0m13:19:47.177017 [debug] [Thread-3 (]: On model.retail_project.dim_store: BEGIN
[0m13:19:47.178745 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:19:47.181760 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:19:47.183128 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_customer"
[0m13:19:47.184246 [debug] [Thread-1 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */

  create view "retail_dwh"."mart"."dim_customer__dbt_tmp"
    
    
  as (
    SELECT
    customer_id,
    customer_name,
    customer_gender,
    customer_city,
    customer_signup_date
FROM
    "retail_dwh"."staging"."stg_customers"
  );
[0m13:19:47.189071 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:19:47.197430 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m13:19:47.199444 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_product"
[0m13:19:47.202345 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_customer"
[0m13:19:47.203913 [debug] [Thread-2 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */

  create view "retail_dwh"."mart"."dim_product__dbt_tmp"
    
    
  as (
    select
    product_id,
    product_name,
    product_category      as category,
    product_sub_category  as sub_category,
    product_price         as price
from "retail_dwh"."staging"."stg_products"
  );
[0m13:19:47.204982 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m13:19:47.205863 [debug] [Thread-1 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */
alter table "retail_dwh"."mart"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m13:19:47.207417 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_store"
[0m13:19:47.209100 [debug] [Thread-3 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */

  create view "retail_dwh"."mart"."dim_store__dbt_tmp"
    
    
  as (
    select
    store_id,
    store_name,
    city as store_city,
    store_region
from "retail_dwh"."staging"."stg_stores"
  );
[0m13:19:47.210440 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:19:47.217765 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:19:47.224634 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:19:47.225509 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_product"
[0m13:19:47.223457 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_store"
[0m13:19:47.228889 [debug] [Thread-1 (]: On model.retail_project.dim_customer: COMMIT
[0m13:19:47.229846 [debug] [Thread-2 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */
alter table "retail_dwh"."mart"."dim_product__dbt_tmp" rename to "dim_product"
[0m13:19:47.231159 [debug] [Thread-3 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */
alter table "retail_dwh"."mart"."dim_store__dbt_tmp" rename to "dim_store"
[0m13:19:47.232793 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_customer"
[0m13:19:47.235084 [debug] [Thread-1 (]: On model.retail_project.dim_customer: COMMIT
[0m13:19:47.237506 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:19:47.241628 [debug] [Thread-2 (]: On model.retail_project.dim_product: COMMIT
[0m13:19:47.243154 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_product"
[0m13:19:47.245035 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:19:47.246401 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:19:47.247976 [debug] [Thread-2 (]: On model.retail_project.dim_product: COMMIT
[0m13:19:47.252228 [debug] [Thread-1 (]: Applying DROP to: "retail_dwh"."mart"."dim_customer__dbt_backup"
[0m13:19:47.255690 [debug] [Thread-3 (]: On model.retail_project.dim_store: COMMIT
[0m13:19:47.258966 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_customer"
[0m13:19:47.260252 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_store"
[0m13:19:47.262011 [debug] [Thread-1 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */
drop view if exists "retail_dwh"."mart"."dim_customer__dbt_backup" cascade
[0m13:19:47.262952 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m13:19:47.264190 [debug] [Thread-3 (]: On model.retail_project.dim_store: COMMIT
[0m13:19:47.269180 [debug] [Thread-2 (]: Applying DROP to: "retail_dwh"."mart"."dim_product__dbt_backup"
[0m13:19:47.271212 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:19:47.273931 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_product"
[0m13:19:47.277703 [debug] [Thread-1 (]: Timing info for model.retail_project.dim_customer (execute): 13:19:47.117069 => 13:19:47.277116
[0m13:19:47.278927 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m13:19:47.280298 [debug] [Thread-2 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */
drop view if exists "retail_dwh"."mart"."dim_product__dbt_backup" cascade
[0m13:19:47.281285 [debug] [Thread-1 (]: On model.retail_project.dim_customer: Close
[0m13:19:47.285378 [debug] [Thread-3 (]: Applying DROP to: "retail_dwh"."mart"."dim_store__dbt_backup"
[0m13:19:47.288308 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f864dd8c-5547-4c52-bb98-291515358f11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e40de6f60>]}
[0m13:19:47.289750 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:19:47.292043 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_store"
[0m13:19:47.298277 [debug] [Thread-2 (]: Timing info for model.retail_project.dim_product (execute): 13:19:47.129738 => 13:19:47.297703
[0m13:19:47.294271 [info ] [Thread-1 (]: 5 of 11 OK created sql view model mart.dim_customer ............................ [[32mCREATE VIEW[0m in 0.22s]
[0m13:19:47.300327 [debug] [Thread-3 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */
drop view if exists "retail_dwh"."mart"."dim_store__dbt_backup" cascade
[0m13:19:47.302058 [debug] [Thread-2 (]: On model.retail_project.dim_product: Close
[0m13:19:47.303430 [debug] [Thread-1 (]: Finished running node model.retail_project.dim_customer
[0m13:19:47.306297 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f864dd8c-5547-4c52-bb98-291515358f11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e40d32660>]}
[0m13:19:47.308793 [info ] [Thread-2 (]: 6 of 11 OK created sql view model mart.dim_product ............................. [[32mCREATE VIEW[0m in 0.22s]
[0m13:19:47.311140 [debug] [Thread-2 (]: Finished running node model.retail_project.dim_product
[0m13:19:47.312772 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:19:47.315047 [debug] [Thread-3 (]: Timing info for model.retail_project.dim_store (execute): 13:19:47.166108 => 13:19:47.314781
[0m13:19:47.315527 [debug] [Thread-3 (]: On model.retail_project.dim_store: Close
[0m13:19:47.317698 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f864dd8c-5547-4c52-bb98-291515358f11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e40d74d40>]}
[0m13:19:47.318818 [info ] [Thread-3 (]: 7 of 11 OK created sql view model mart.dim_store ............................... [[32mCREATE VIEW[0m in 0.17s]
[0m13:19:47.320578 [debug] [Thread-3 (]: Finished running node model.retail_project.dim_store
[0m13:19:47.324798 [debug] [Thread-4 (]: Began running node model.retail_project.fact_sales
[0m13:19:47.325883 [info ] [Thread-4 (]: 8 of 11 START sql view model mart.fact_sales ................................... [RUN]
[0m13:19:47.328478 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_stores, now model.retail_project.fact_sales)
[0m13:19:47.329378 [debug] [Thread-4 (]: Began compiling node model.retail_project.fact_sales
[0m13:19:47.335451 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_project.fact_sales"
[0m13:19:47.337927 [debug] [Thread-4 (]: Timing info for model.retail_project.fact_sales (compile): 13:19:47.329719 => 13:19:47.336676
[0m13:19:47.338534 [debug] [Thread-4 (]: Began executing node model.retail_project.fact_sales
[0m13:19:47.344501 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_project.fact_sales"
[0m13:19:47.347623 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.fact_sales"
[0m13:19:47.348348 [debug] [Thread-4 (]: On model.retail_project.fact_sales: BEGIN
[0m13:19:47.348860 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:19:47.363993 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m13:19:47.364580 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.fact_sales"
[0m13:19:47.365092 [debug] [Thread-4 (]: On model.retail_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.fact_sales"} */

  create view "retail_dwh"."mart"."fact_sales__dbt_tmp"
    
    
  as (
    with sales as (
    select
        transaction_id,
        transaction_date,
        customer_id,
        product_id,
        store_id,
        quantity,
        unit_price,
        quantity * unit_price as gross_sales
    from "retail_dwh"."staging"."stg_sales_transaction"
),

joined as (
    select
        s.transaction_id,
        s.transaction_date,
        s.customer_id,
        s.product_id,
        s.store_id,
        s.quantity,
        s.unit_price,
        s.gross_sales,

        c.customer_name,
        p.product_name,
        -- p.category,   -- sementara DIHAPUS biar nggak error
        st.store_name,
        st.store_city,
        st.store_region
    from sales s
    left join "retail_dwh"."mart"."dim_customer" c
        on s.customer_id = c.customer_id
    left join "retail_dwh"."mart"."dim_product" p
        on s.product_id = p.product_id
    left join "retail_dwh"."mart"."dim_store" st
        on s.store_id = st.store_id
)

select * from joined
  );
[0m13:19:47.369834 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:19:47.378976 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.fact_sales"
[0m13:19:47.379718 [debug] [Thread-4 (]: On model.retail_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.fact_sales"} */
alter table "retail_dwh"."mart"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m13:19:47.381381 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:19:47.384947 [debug] [Thread-4 (]: On model.retail_project.fact_sales: COMMIT
[0m13:19:47.385790 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.fact_sales"
[0m13:19:47.386707 [debug] [Thread-4 (]: On model.retail_project.fact_sales: COMMIT
[0m13:19:47.608999 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m13:19:47.615240 [debug] [Thread-4 (]: Applying DROP to: "retail_dwh"."mart"."fact_sales__dbt_backup"
[0m13:19:47.618192 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.fact_sales"
[0m13:19:47.619276 [debug] [Thread-4 (]: On model.retail_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.fact_sales"} */
drop view if exists "retail_dwh"."mart"."fact_sales__dbt_backup" cascade
[0m13:19:47.622108 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:19:47.625616 [debug] [Thread-4 (]: Timing info for model.retail_project.fact_sales (execute): 13:19:47.338829 => 13:19:47.625178
[0m13:19:47.626391 [debug] [Thread-4 (]: On model.retail_project.fact_sales: Close
[0m13:19:47.630598 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f864dd8c-5547-4c52-bb98-291515358f11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e40dfd880>]}
[0m13:19:47.635392 [info ] [Thread-4 (]: 8 of 11 OK created sql view model mart.fact_sales .............................. [[32mCREATE VIEW[0m in 0.30s]
[0m13:19:47.636390 [debug] [Thread-4 (]: Finished running node model.retail_project.fact_sales
[0m13:19:47.640961 [debug] [Thread-2 (]: Began running node model.retail_project.customer_features
[0m13:19:47.642548 [info ] [Thread-2 (]: 9 of 11 START sql table model analytics.customer_features ...................... [RUN]
[0m13:19:47.644241 [debug] [Thread-3 (]: Began running node model.retail_project.daily_sales_kpi
[0m13:19:47.646389 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_project.dim_product, now model.retail_project.customer_features)
[0m13:19:47.648000 [debug] [Thread-1 (]: Began running node model.retail_project.daily_store_sales
[0m13:19:47.651063 [debug] [Thread-2 (]: Began compiling node model.retail_project.customer_features
[0m13:19:47.649492 [info ] [Thread-3 (]: 10 of 11 START sql view model analytics.daily_sales_kpi ........................ [RUN]
[0m13:19:47.653381 [info ] [Thread-1 (]: 11 of 11 START sql table model analytics.daily_store_sales ..................... [RUN]
[0m13:19:47.661769 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_project.customer_features"
[0m13:19:47.665236 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_project.dim_store, now model.retail_project.daily_sales_kpi)
[0m13:19:47.667082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_project.dim_customer, now model.retail_project.daily_store_sales)
[0m13:19:47.668780 [debug] [Thread-3 (]: Began compiling node model.retail_project.daily_sales_kpi
[0m13:19:47.670122 [debug] [Thread-1 (]: Began compiling node model.retail_project.daily_store_sales
[0m13:19:47.671945 [debug] [Thread-2 (]: Timing info for model.retail_project.customer_features (compile): 13:19:47.655967 => 13:19:47.671576
[0m13:19:47.675818 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_project.daily_sales_kpi"
[0m13:19:47.681553 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_project.daily_store_sales"
[0m13:19:47.683834 [debug] [Thread-2 (]: Began executing node model.retail_project.customer_features
[0m13:19:47.716910 [debug] [Thread-1 (]: Timing info for model.retail_project.daily_store_sales (compile): 13:19:47.676966 => 13:19:47.715654
[0m13:19:47.718269 [debug] [Thread-1 (]: Began executing node model.retail_project.daily_store_sales
[0m13:19:47.734506 [debug] [Thread-3 (]: Timing info for model.retail_project.daily_sales_kpi (compile): 13:19:47.672640 => 13:19:47.733953
[0m13:19:47.736279 [debug] [Thread-3 (]: Began executing node model.retail_project.daily_sales_kpi
[0m13:19:47.754366 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_project.daily_store_sales"
[0m13:19:47.766473 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.daily_store_sales"
[0m13:19:47.768848 [debug] [Thread-1 (]: On model.retail_project.daily_store_sales: BEGIN
[0m13:19:47.770148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:47.772428 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_project.customer_features"
[0m13:19:47.774795 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.customer_features"
[0m13:19:47.775791 [debug] [Thread-2 (]: On model.retail_project.customer_features: BEGIN
[0m13:19:47.776997 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:19:47.789474 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_project.daily_sales_kpi"
[0m13:19:47.794581 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:19:47.798646 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.daily_store_sales"
[0m13:19:47.801403 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.daily_sales_kpi"
[0m13:19:47.803940 [debug] [Thread-1 (]: On model.retail_project.daily_store_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.daily_store_sales"} */

  
    

  create  table "retail_dwh"."analytics"."daily_store_sales__dbt_tmp"
  
  
    as
  
  (
    select
    transaction_date::date    as date,
    store_id,
    store_name,
    store_city,
    sum(gross_sales)          as total_sales,
    sum(quantity)             as total_qty
from "retail_dwh"."mart"."fact_sales"
group by 1,2,3,4
order by 1,2
  );
  
[0m13:19:47.805493 [debug] [Thread-3 (]: On model.retail_project.daily_sales_kpi: BEGIN
[0m13:19:47.811894 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:19:47.813661 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m13:19:47.816150 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.customer_features"
[0m13:19:47.817371 [debug] [Thread-2 (]: On model.retail_project.customer_features: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.customer_features"} */

  
    

  create  table "retail_dwh"."analytics"."customer_features__dbt_tmp"
  
  
    as
  
  (
    with base as (
    select
        customer_id,
        customer_name,
        customer_signup_date,
        current_date - customer_signup_date as customer_tenure_days
    from "retail_dwh"."mart"."dim_customer"
),

agg_sales as (
    select
        customer_id,
        count(distinct transaction_id)    as total_txn,
        sum(gross_sales)                  as total_spent,
        max(transaction_date)             as last_transaction_date
    from "retail_dwh"."mart"."fact_sales"
    group by customer_id
)

select
    b.customer_id,
    b.customer_name,
    b.customer_signup_date,
    b.customer_tenure_days,
    a.total_txn,
    a.total_spent,
    a.last_transaction_date
from base b
left join agg_sales a
  on b.customer_id = a.customer_id
  );
  
[0m13:19:47.832095 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m13:19:47.832697 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.daily_sales_kpi"
[0m13:19:47.833232 [debug] [Thread-3 (]: On model.retail_project.daily_sales_kpi: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.daily_sales_kpi"} */

  create view "retail_dwh"."analytics"."daily_sales_kpi__dbt_tmp"
    
    
  as (
    select
    transaction_date::date                    as date,
    sum(gross_sales)                          as total_sales,
    sum(quantity)                             as total_qty,
    count(distinct customer_id)               as unique_customers
from "retail_dwh"."mart"."fact_sales"
group by 1
order by 1
  );
[0m13:19:47.838406 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:19:47.855456 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.daily_sales_kpi"
[0m13:19:47.856535 [debug] [Thread-3 (]: On model.retail_project.daily_sales_kpi: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.daily_sales_kpi"} */
alter table "retail_dwh"."analytics"."daily_sales_kpi__dbt_tmp" rename to "daily_sales_kpi"
[0m13:19:47.858946 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:19:47.862889 [debug] [Thread-3 (]: On model.retail_project.daily_sales_kpi: COMMIT
[0m13:19:47.863861 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.daily_sales_kpi"
[0m13:19:47.864676 [debug] [Thread-3 (]: On model.retail_project.daily_sales_kpi: COMMIT
[0m13:19:47.869561 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m13:19:47.873617 [debug] [Thread-3 (]: Applying DROP to: "retail_dwh"."analytics"."daily_sales_kpi__dbt_backup"
[0m13:19:47.875291 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.daily_sales_kpi"
[0m13:19:47.875830 [debug] [Thread-3 (]: On model.retail_project.daily_sales_kpi: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.daily_sales_kpi"} */
drop view if exists "retail_dwh"."analytics"."daily_sales_kpi__dbt_backup" cascade
[0m13:19:47.877298 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:19:47.880600 [debug] [Thread-3 (]: Timing info for model.retail_project.daily_sales_kpi (execute): 13:19:47.737112 => 13:19:47.880155
[0m13:19:47.881467 [debug] [Thread-3 (]: On model.retail_project.daily_sales_kpi: Close
[0m13:19:47.883310 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f864dd8c-5547-4c52-bb98-291515358f11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e40dfef90>]}
[0m13:19:47.884591 [info ] [Thread-3 (]: 10 of 11 OK created sql view model analytics.daily_sales_kpi ................... [[32mCREATE VIEW[0m in 0.22s]
[0m13:19:47.893307 [debug] [Thread-3 (]: Finished running node model.retail_project.daily_sales_kpi
[0m13:19:48.736233 [debug] [Thread-1 (]: SQL status: SELECT 99876 in 1.0 seconds
[0m13:19:48.741667 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.daily_store_sales"
[0m13:19:48.742615 [debug] [Thread-1 (]: On model.retail_project.daily_store_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.daily_store_sales"} */
alter table "retail_dwh"."analytics"."daily_store_sales__dbt_tmp" rename to "daily_store_sales"
[0m13:19:48.744566 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:19:48.755130 [debug] [Thread-1 (]: On model.retail_project.daily_store_sales: COMMIT
[0m13:19:48.755853 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.daily_store_sales"
[0m13:19:48.756372 [debug] [Thread-1 (]: On model.retail_project.daily_store_sales: COMMIT
[0m13:19:48.971829 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:19:48.987559 [debug] [Thread-1 (]: Applying DROP to: "retail_dwh"."analytics"."daily_store_sales__dbt_backup"
[0m13:19:48.998509 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.daily_store_sales"
[0m13:19:48.999488 [debug] [Thread-1 (]: On model.retail_project.daily_store_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.daily_store_sales"} */
drop table if exists "retail_dwh"."analytics"."daily_store_sales__dbt_backup" cascade
[0m13:19:49.003587 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:19:49.006094 [debug] [Thread-1 (]: Timing info for model.retail_project.daily_store_sales (execute): 13:19:47.720170 => 13:19:49.005805
[0m13:19:49.006635 [debug] [Thread-1 (]: On model.retail_project.daily_store_sales: Close
[0m13:19:49.011924 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f864dd8c-5547-4c52-bb98-291515358f11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e40de7470>]}
[0m13:19:49.013032 [info ] [Thread-1 (]: 11 of 11 OK created sql table model analytics.daily_store_sales ................ [[32mSELECT 99876[0m in 1.35s]
[0m13:19:49.016639 [debug] [Thread-1 (]: Finished running node model.retail_project.daily_store_sales
[0m13:19:49.098824 [debug] [Thread-2 (]: SQL status: SELECT 100000 in 1.0 seconds
[0m13:19:49.102737 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.customer_features"
[0m13:19:49.103238 [debug] [Thread-2 (]: On model.retail_project.customer_features: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.customer_features"} */
alter table "retail_dwh"."analytics"."customer_features__dbt_tmp" rename to "customer_features"
[0m13:19:49.106064 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:19:49.109990 [debug] [Thread-2 (]: On model.retail_project.customer_features: COMMIT
[0m13:19:49.110637 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.customer_features"
[0m13:19:49.111105 [debug] [Thread-2 (]: On model.retail_project.customer_features: COMMIT
[0m13:19:49.422308 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m13:19:49.426672 [debug] [Thread-2 (]: Applying DROP to: "retail_dwh"."analytics"."customer_features__dbt_backup"
[0m13:19:49.427883 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.customer_features"
[0m13:19:49.428809 [debug] [Thread-2 (]: On model.retail_project.customer_features: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.customer_features"} */
drop table if exists "retail_dwh"."analytics"."customer_features__dbt_backup" cascade
[0m13:19:49.431223 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:19:49.433097 [debug] [Thread-2 (]: Timing info for model.retail_project.customer_features (execute): 13:19:47.686007 => 13:19:49.432838
[0m13:19:49.433556 [debug] [Thread-2 (]: On model.retail_project.customer_features: Close
[0m13:19:49.435532 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f864dd8c-5547-4c52-bb98-291515358f11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e40de75f0>]}
[0m13:19:49.436339 [info ] [Thread-2 (]: 9 of 11 OK created sql table model analytics.customer_features ................. [[32mSELECT 100000[0m in 1.79s]
[0m13:19:49.438212 [debug] [Thread-2 (]: Finished running node model.retail_project.customer_features
[0m13:19:49.445869 [debug] [MainThread]: Using postgres connection "master"
[0m13:19:49.446775 [debug] [MainThread]: On master: BEGIN
[0m13:19:49.447228 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:19:49.467110 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:19:49.467761 [debug] [MainThread]: On master: COMMIT
[0m13:19:49.468571 [debug] [MainThread]: Using postgres connection "master"
[0m13:19:49.468962 [debug] [MainThread]: On master: COMMIT
[0m13:19:49.470133 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:19:49.471183 [debug] [MainThread]: On master: Close
[0m13:19:49.472863 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:19:49.473519 [debug] [MainThread]: Connection 'model.retail_project.daily_store_sales' was properly closed.
[0m13:19:49.474075 [debug] [MainThread]: Connection 'model.retail_project.daily_sales_kpi' was properly closed.
[0m13:19:49.475058 [debug] [MainThread]: Connection 'model.retail_project.customer_features' was properly closed.
[0m13:19:49.476600 [debug] [MainThread]: Connection 'model.retail_project.fact_sales' was properly closed.
[0m13:19:49.477340 [info ] [MainThread]: 
[0m13:19:49.478111 [info ] [MainThread]: Finished running 9 view models, 2 table models in 0 hours 0 minutes and 3.21 seconds (3.21s).
[0m13:19:49.483320 [debug] [MainThread]: Command end result
[0m13:19:49.497611 [info ] [MainThread]: 
[0m13:19:49.498887 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:19:49.500748 [info ] [MainThread]: 
[0m13:19:49.502076 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m13:19:49.504332 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.940142, "process_user_time": 4.574381, "process_kernel_time": 1.040466, "process_mem_max_rss": "140496", "process_out_blocks": "2808", "process_in_blocks": "0"}
[0m13:19:49.505598 [debug] [MainThread]: Command `dbt run` succeeded at 13:19:49.505401 after 4.94 seconds
[0m13:19:49.506422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e47912ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e40d05e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e4329e3f0>]}
[0m13:19:49.506938 [debug] [MainThread]: Flushing usage events
[0m13:27:54.697537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effbba9ee10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effbbdf1880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effbba9dcd0>]}


============================== 13:27:54.701150 | 36182045-75ad-428c-a713-ec2f1023e53c ==============================
[0m13:27:54.701150 [info ] [MainThread]: Running with dbt=1.7.0
[0m13:27:54.703375 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/dbt/retail_project/retail_project/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /root/.dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:27:54.946525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36182045-75ad-428c-a713-ec2f1023e53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effbba9d5b0>]}
[0m13:27:55.083719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36182045-75ad-428c-a713-ec2f1023e53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effbad077a0>]}
[0m13:27:55.084673 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m13:27:55.100281 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m13:27:55.139671 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m13:27:55.140458 [debug] [MainThread]: Partial parsing: updated file: retail_project://models/analytics/kpi/daily_sales_kpi.sql
[0m13:27:55.141069 [debug] [MainThread]: Partial parsing: updated file: retail_project://models/analytics/features/customer_features.sql
[0m13:27:55.141665 [debug] [MainThread]: Partial parsing: updated file: retail_project://models/analytics/summaries/daily_store_sales.sql
[0m13:27:55.345956 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail_project.intermediate
[0m13:27:55.353959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36182045-75ad-428c-a713-ec2f1023e53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effba53e960>]}
[0m13:27:55.371220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36182045-75ad-428c-a713-ec2f1023e53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effbad6d2b0>]}
[0m13:27:55.372086 [info ] [MainThread]: Found 11 models, 4 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m13:27:55.376748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36182045-75ad-428c-a713-ec2f1023e53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effba5ffe90>]}
[0m13:27:55.380940 [info ] [MainThread]: 
[0m13:27:55.383782 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:27:55.387043 [debug] [ThreadPool]: Acquiring new postgres connection 'list_retail_dwh'
[0m13:27:55.404055 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh"
[0m13:27:55.406370 [debug] [ThreadPool]: Acquiring new postgres connection 'list_retail_dwh'
[0m13:27:55.409918 [debug] [ThreadPool]: On list_retail_dwh: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh"} */

    select distinct nspname from pg_namespace
  
[0m13:27:55.412720 [debug] [ThreadPool]: Acquiring new postgres connection 'list_retail_dwh'
[0m13:27:55.417262 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh"
[0m13:27:55.418917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:55.497705 [debug] [ThreadPool]: On list_retail_dwh: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh"} */

    select distinct nspname from pg_namespace
  
[0m13:27:55.500135 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh"
[0m13:27:55.503186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:55.505428 [debug] [ThreadPool]: On list_retail_dwh: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh"} */

    select distinct nspname from pg_namespace
  
[0m13:27:55.507461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:55.520011 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m13:27:55.526297 [debug] [ThreadPool]: On list_retail_dwh: Close
[0m13:27:55.531843 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m13:27:55.534243 [debug] [ThreadPool]: On list_retail_dwh: Close
[0m13:27:55.535285 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m13:27:55.541610 [debug] [ThreadPool]: On list_retail_dwh: Close
[0m13:27:55.546737 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_dwh, now list_retail_dwh_staging)
[0m13:27:55.555174 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_dwh, now list_retail_dwh_analytics)
[0m13:27:55.558783 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_staging"
[0m13:27:55.563329 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_analytics"
[0m13:27:55.566906 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_dwh, now list_retail_dwh_mart)
[0m13:27:55.568724 [debug] [ThreadPool]: On list_retail_dwh_staging: BEGIN
[0m13:27:55.569978 [debug] [ThreadPool]: On list_retail_dwh_analytics: BEGIN
[0m13:27:55.572828 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_mart"
[0m13:27:55.574236 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:27:55.575792 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:27:55.576782 [debug] [ThreadPool]: On list_retail_dwh_mart: BEGIN
[0m13:27:55.578359 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:27:55.594772 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:27:55.596003 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_mart"
[0m13:27:55.597314 [debug] [ThreadPool]: On list_retail_dwh_mart: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh_mart"} */
select
      'retail_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'retail_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
    union all
    select
      'retail_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'mart'
  
[0m13:27:55.598386 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:27:55.599149 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_staging"
[0m13:27:55.599653 [debug] [ThreadPool]: On list_retail_dwh_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh_staging"} */
select
      'retail_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'retail_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'retail_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m13:27:55.603251 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:27:55.606316 [debug] [ThreadPool]: On list_retail_dwh_mart: ROLLBACK
[0m13:27:55.608116 [debug] [ThreadPool]: On list_retail_dwh_mart: Close
[0m13:27:55.609824 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:27:55.611006 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:27:55.614537 [debug] [ThreadPool]: On list_retail_dwh_staging: ROLLBACK
[0m13:27:55.616741 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_analytics"
[0m13:27:55.619184 [debug] [ThreadPool]: On list_retail_dwh_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh_analytics"} */
select
      'retail_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'retail_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'retail_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m13:27:55.622024 [debug] [ThreadPool]: On list_retail_dwh_staging: Close
[0m13:27:55.628457 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m13:27:55.630392 [debug] [ThreadPool]: On list_retail_dwh_analytics: ROLLBACK
[0m13:27:55.631022 [debug] [ThreadPool]: On list_retail_dwh_analytics: Close
[0m13:27:55.644522 [debug] [MainThread]: Using postgres connection "master"
[0m13:27:55.645452 [debug] [MainThread]: On master: BEGIN
[0m13:27:55.646221 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:27:55.658016 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:27:55.658541 [debug] [MainThread]: Using postgres connection "master"
[0m13:27:55.659062 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:27:55.687586 [debug] [MainThread]: SQL status: SELECT 12 in 0.0 seconds
[0m13:27:55.691356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36182045-75ad-428c-a713-ec2f1023e53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effbb1a8bf0>]}
[0m13:27:55.691948 [debug] [MainThread]: On master: ROLLBACK
[0m13:27:55.693045 [debug] [MainThread]: Using postgres connection "master"
[0m13:27:55.693482 [debug] [MainThread]: On master: BEGIN
[0m13:27:55.695150 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:27:55.695615 [debug] [MainThread]: On master: COMMIT
[0m13:27:55.695992 [debug] [MainThread]: Using postgres connection "master"
[0m13:27:55.696364 [debug] [MainThread]: On master: COMMIT
[0m13:27:55.697344 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:27:55.697790 [debug] [MainThread]: On master: Close
[0m13:27:55.699018 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:27:55.699698 [info ] [MainThread]: 
[0m13:27:55.719112 [debug] [Thread-1 (]: Began running node model.retail_project.stg_customers
[0m13:27:55.720222 [debug] [Thread-2 (]: Began running node model.retail_project.stg_products
[0m13:27:55.721580 [info ] [Thread-1 (]: 1 of 11 START sql view model staging.stg_customers ............................. [RUN]
[0m13:27:55.725957 [info ] [Thread-2 (]: 2 of 11 START sql view model staging.stg_products .............................. [RUN]
[0m13:27:55.728980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail_dwh_analytics, now model.retail_project.stg_customers)
[0m13:27:55.730889 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_retail_dwh_staging, now model.retail_project.stg_products)
[0m13:27:55.732171 [debug] [Thread-3 (]: Began running node model.retail_project.stg_sales_transaction
[0m13:27:55.733650 [debug] [Thread-1 (]: Began compiling node model.retail_project.stg_customers
[0m13:27:55.736418 [debug] [Thread-2 (]: Began compiling node model.retail_project.stg_products
[0m13:27:55.737915 [debug] [Thread-4 (]: Began running node model.retail_project.stg_stores
[0m13:27:55.739073 [info ] [Thread-3 (]: 3 of 11 START sql view model staging.stg_sales_transaction ..................... [RUN]
[0m13:27:55.750465 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_project.stg_customers"
[0m13:27:55.756946 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_project.stg_products"
[0m13:27:55.759319 [info ] [Thread-4 (]: 4 of 11 START sql view model staging.stg_stores ................................ [RUN]
[0m13:27:55.763497 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_retail_dwh_mart, now model.retail_project.stg_sales_transaction)
[0m13:27:55.767256 [debug] [Thread-2 (]: Timing info for model.retail_project.stg_products (compile): 13:27:55.751601 => 13:27:55.766645
[0m13:27:55.769133 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.retail_project.stg_stores'
[0m13:27:55.770196 [debug] [Thread-1 (]: Timing info for model.retail_project.stg_customers (compile): 13:27:55.740750 => 13:27:55.769769
[0m13:27:55.771397 [debug] [Thread-3 (]: Began compiling node model.retail_project.stg_sales_transaction
[0m13:27:55.772821 [debug] [Thread-2 (]: Began executing node model.retail_project.stg_products
[0m13:27:55.774123 [debug] [Thread-4 (]: Began compiling node model.retail_project.stg_stores
[0m13:27:55.776976 [debug] [Thread-1 (]: Began executing node model.retail_project.stg_customers
[0m13:27:55.781248 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_project.stg_sales_transaction"
[0m13:27:55.807021 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_project.stg_stores"
[0m13:27:55.833521 [debug] [Thread-3 (]: Timing info for model.retail_project.stg_sales_transaction (compile): 13:27:55.778249 => 13:27:55.832830
[0m13:27:55.865453 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_project.stg_customers"
[0m13:27:55.870099 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_project.stg_products"
[0m13:27:55.872260 [debug] [Thread-3 (]: Began executing node model.retail_project.stg_sales_transaction
[0m13:27:55.875059 [debug] [Thread-4 (]: Timing info for model.retail_project.stg_stores (compile): 13:27:55.801760 => 13:27:55.874082
[0m13:27:55.881760 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_project.stg_sales_transaction"
[0m13:27:55.884922 [debug] [Thread-4 (]: Began executing node model.retail_project.stg_stores
[0m13:27:55.888174 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m13:27:55.889149 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m13:27:55.890286 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m13:27:55.896418 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_project.stg_stores"
[0m13:27:55.897881 [debug] [Thread-1 (]: On model.retail_project.stg_customers: BEGIN
[0m13:27:55.899804 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: BEGIN
[0m13:27:55.901706 [debug] [Thread-2 (]: On model.retail_project.stg_products: BEGIN
[0m13:27:55.903202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:55.904809 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:27:55.905883 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m13:27:55.906837 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:27:55.909297 [debug] [Thread-4 (]: On model.retail_project.stg_stores: BEGIN
[0m13:27:55.913094 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:27:55.924988 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:27:55.929631 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m13:27:55.931133 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */

  create view "retail_dwh"."staging"."stg_customers__dbt_tmp"
    
    
  as (
    SELECT
    customer_id,
    customer_name,
    UPPER(TRIM(gender)) AS customer_gender,
    TRIM(city) AS customer_city,
    CAST(signup_date AS DATE) AS customer_signup_date
FROM
    "retail_dwh"."raw"."customers_raw"
  );
[0m13:27:55.934987 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m13:27:55.935558 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m13:27:55.936925 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:27:55.938173 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m13:27:55.939210 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */

  create view "retail_dwh"."staging"."stg_sales_transaction__dbt_tmp"
    
    
  as (
    with source as (
    select
        transaction_id,
        transaction_date,
        customer_id,
        product_id,
        store_id,
        quantity,
        total_price
    from "retail_dwh"."raw"."sales_transaction_raw"
),

typed as (
    select
        transaction_id,
        customer_id,
        product_id,
        store_id,
        transaction_date::date        as transaction_date,
        quantity::integer             as quantity,
        total_price::numeric(18,2)    as total_price,
        case
            when quantity::numeric <> 0
                then total_price::numeric(18,2) / quantity::numeric
            else null
        end                           as unit_price
    from source
)

select * from typed
  );
[0m13:27:55.940434 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m13:27:55.948875 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m13:27:55.951502 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m13:27:55.953746 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m13:27:55.955074 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
alter table "retail_dwh"."staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m13:27:55.958160 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */

  create view "retail_dwh"."staging"."stg_stores__dbt_tmp"
    
    
  as (
    with source as (
    select
        store_id,
        store_name,
        city,
        region
    from "retail_dwh"."raw"."stores_raw"
),

renamed as (
    select
        store_id,
        store_name,
        city,
        region as store_region
    from source
)

select * from renamed
  );
[0m13:27:55.960290 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */

  create view "retail_dwh"."staging"."stg_products__dbt_tmp"
    
    
  as (
    SELECT
    product_id,
    product_name,
    TRIM(category) AS product_category,
    TRIM(sub_category) AS product_sub_category,
    CAST(price AS NUMERIC) AS product_price
FROM
    "retail_dwh"."raw"."products_raw"
  );
[0m13:27:55.962539 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:27:55.965041 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:27:55.970686 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m13:27:55.980868 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */
alter table "retail_dwh"."staging"."stg_sales_transaction" rename to "stg_sales_transaction__dbt_backup"
[0m13:27:55.973256 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:27:55.979275 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:27:55.978165 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m13:27:55.985994 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m13:27:55.990859 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m13:27:55.992033 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:27:55.993528 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
alter table "retail_dwh"."staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m13:27:55.994764 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
alter table "retail_dwh"."staging"."stg_stores" rename to "stg_stores__dbt_backup"
[0m13:27:55.995901 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
alter table "retail_dwh"."staging"."stg_products" rename to "stg_products__dbt_backup"
[0m13:27:55.999990 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m13:27:56.003764 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:27:56.005865 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:27:56.007961 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */
alter table "retail_dwh"."staging"."stg_sales_transaction__dbt_tmp" rename to "stg_sales_transaction"
[0m13:27:56.008935 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:27:56.023991 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m13:27:56.039860 [debug] [Thread-1 (]: On model.retail_project.stg_customers: COMMIT
[0m13:27:56.044288 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:27:56.051036 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m13:27:56.053125 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
alter table "retail_dwh"."staging"."stg_stores__dbt_tmp" rename to "stg_stores"
[0m13:27:56.054452 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m13:27:56.058558 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: COMMIT
[0m13:27:56.060100 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
alter table "retail_dwh"."staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:27:56.061652 [debug] [Thread-1 (]: On model.retail_project.stg_customers: COMMIT
[0m13:27:56.063749 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m13:27:56.064897 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:27:56.067863 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: COMMIT
[0m13:27:56.071791 [debug] [Thread-4 (]: On model.retail_project.stg_stores: COMMIT
[0m13:27:56.073053 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:27:56.075929 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m13:27:56.079867 [debug] [Thread-2 (]: On model.retail_project.stg_products: COMMIT
[0m13:27:56.081244 [debug] [Thread-4 (]: On model.retail_project.stg_stores: COMMIT
[0m13:27:56.083062 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m13:27:56.084165 [debug] [Thread-2 (]: On model.retail_project.stg_products: COMMIT
[0m13:27:56.106046 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:27:56.116902 [debug] [Thread-1 (]: Applying DROP to: "retail_dwh"."staging"."stg_customers__dbt_backup"
[0m13:27:56.119987 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m13:27:56.121115 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m13:27:56.122167 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m13:27:56.130260 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m13:27:56.135936 [debug] [Thread-3 (]: Applying DROP to: "retail_dwh"."staging"."stg_sales_transaction__dbt_backup"
[0m13:27:56.140665 [debug] [Thread-4 (]: Applying DROP to: "retail_dwh"."staging"."stg_stores__dbt_backup"
[0m13:27:56.151115 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m13:27:56.147156 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
drop view if exists "retail_dwh"."staging"."stg_customers__dbt_backup" cascade
[0m13:27:56.149867 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m13:27:56.153896 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */
drop view if exists "retail_dwh"."staging"."stg_sales_transaction__dbt_backup" cascade
[0m13:27:56.152031 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
drop view if exists "retail_dwh"."staging"."stg_stores__dbt_backup" cascade
[0m13:27:56.145642 [debug] [Thread-2 (]: Applying DROP to: "retail_dwh"."staging"."stg_products__dbt_backup"
[0m13:27:56.155984 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m13:27:56.156527 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
drop view if exists "retail_dwh"."staging"."stg_products__dbt_backup" cascade
[0m13:27:56.163069 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:27:56.166708 [debug] [Thread-1 (]: Timing info for model.retail_project.stg_customers (execute): 13:27:55.808953 => 13:27:56.166327
[0m13:27:56.167419 [debug] [Thread-1 (]: On model.retail_project.stg_customers: Close
[0m13:27:56.170006 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36182045-75ad-428c-a713-ec2f1023e53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effba9d2c30>]}
[0m13:27:56.173207 [info ] [Thread-1 (]: 1 of 11 OK created sql view model staging.stg_customers ........................ [[32mCREATE VIEW[0m in 0.44s]
[0m13:27:56.175928 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:27:56.180609 [debug] [Thread-1 (]: Finished running node model.retail_project.stg_customers
[0m13:27:56.182009 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:27:56.186456 [debug] [Thread-2 (]: Timing info for model.retail_project.stg_products (execute): 13:27:55.782748 => 13:27:56.185650
[0m13:27:56.187699 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:27:56.196208 [debug] [Thread-2 (]: On model.retail_project.stg_products: Close
[0m13:27:56.201540 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36182045-75ad-428c-a713-ec2f1023e53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effba11eff0>]}
[0m13:27:56.199807 [debug] [Thread-4 (]: Timing info for model.retail_project.stg_stores (execute): 13:27:55.891090 => 13:27:56.199532
[0m13:27:56.195205 [debug] [Thread-3 (]: Timing info for model.retail_project.stg_sales_transaction (execute): 13:27:55.876271 => 13:27:56.194696
[0m13:27:56.203266 [info ] [Thread-2 (]: 2 of 11 OK created sql view model staging.stg_products ......................... [[32mCREATE VIEW[0m in 0.47s]
[0m13:27:56.205455 [debug] [Thread-1 (]: Began running node model.retail_project.dim_customer
[0m13:27:56.207461 [debug] [Thread-4 (]: On model.retail_project.stg_stores: Close
[0m13:27:56.209010 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: Close
[0m13:27:56.210847 [debug] [Thread-2 (]: Finished running node model.retail_project.stg_products
[0m13:27:56.212411 [info ] [Thread-1 (]: 5 of 11 START sql view model mart.dim_customer ................................. [RUN]
[0m13:27:56.217404 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36182045-75ad-428c-a713-ec2f1023e53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effba9c00b0>]}
[0m13:27:56.220527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_customers, now model.retail_project.dim_customer)
[0m13:27:56.222335 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36182045-75ad-428c-a713-ec2f1023e53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effbb13dbb0>]}
[0m13:27:56.224476 [info ] [Thread-4 (]: 4 of 11 OK created sql view model staging.stg_stores ........................... [[32mCREATE VIEW[0m in 0.45s]
[0m13:27:56.227080 [debug] [Thread-2 (]: Began running node model.retail_project.dim_product
[0m13:27:56.229113 [debug] [Thread-1 (]: Began compiling node model.retail_project.dim_customer
[0m13:27:56.230351 [info ] [Thread-3 (]: 3 of 11 OK created sql view model staging.stg_sales_transaction ................ [[32mCREATE VIEW[0m in 0.46s]
[0m13:27:56.233330 [debug] [Thread-4 (]: Finished running node model.retail_project.stg_stores
[0m13:27:56.240951 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_project.dim_customer"
[0m13:27:56.244801 [debug] [Thread-3 (]: Finished running node model.retail_project.stg_sales_transaction
[0m13:27:56.235006 [info ] [Thread-2 (]: 6 of 11 START sql view model mart.dim_product .................................. [RUN]
[0m13:27:56.250094 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_products, now model.retail_project.dim_product)
[0m13:27:56.251756 [debug] [Thread-2 (]: Began compiling node model.retail_project.dim_product
[0m13:27:56.257653 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_project.dim_product"
[0m13:27:56.259990 [debug] [Thread-4 (]: Began running node model.retail_project.dim_store
[0m13:27:56.264183 [debug] [Thread-2 (]: Timing info for model.retail_project.dim_product (compile): 13:27:56.253675 => 13:27:56.263765
[0m13:27:56.263047 [info ] [Thread-4 (]: 7 of 11 START sql view model mart.dim_store .................................... [RUN]
[0m13:27:56.266815 [debug] [Thread-2 (]: Began executing node model.retail_project.dim_product
[0m13:27:56.268085 [debug] [Thread-1 (]: Timing info for model.retail_project.dim_customer (compile): 13:27:56.235641 => 13:27:56.267681
[0m13:27:56.281233 [debug] [Thread-1 (]: Began executing node model.retail_project.dim_customer
[0m13:27:56.279043 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_project.dim_product"
[0m13:27:56.269439 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_stores, now model.retail_project.dim_store)
[0m13:27:56.289216 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_project.dim_customer"
[0m13:27:56.294681 [debug] [Thread-4 (]: Began compiling node model.retail_project.dim_store
[0m13:27:56.292030 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_product"
[0m13:27:56.300290 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_project.dim_store"
[0m13:27:56.302992 [debug] [Thread-2 (]: On model.retail_project.dim_product: BEGIN
[0m13:27:56.304821 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_customer"
[0m13:27:56.307725 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:27:56.309756 [debug] [Thread-1 (]: On model.retail_project.dim_customer: BEGIN
[0m13:27:56.310820 [debug] [Thread-4 (]: Timing info for model.retail_project.dim_store (compile): 13:27:56.296692 => 13:27:56.310515
[0m13:27:56.312454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:56.314563 [debug] [Thread-4 (]: Began executing node model.retail_project.dim_store
[0m13:27:56.322101 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_project.dim_store"
[0m13:27:56.329055 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_store"
[0m13:27:56.331126 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m13:27:56.332921 [debug] [Thread-4 (]: On model.retail_project.dim_store: BEGIN
[0m13:27:56.334348 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_product"
[0m13:27:56.335649 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:27:56.337054 [debug] [Thread-2 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */

  create view "retail_dwh"."mart"."dim_product__dbt_tmp"
    
    
  as (
    select
    product_id,
    product_name,
    product_category      as category,
    product_sub_category  as sub_category,
    product_price         as price
from "retail_dwh"."staging"."stg_products"
  );
[0m13:27:56.345842 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:27:56.351902 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_product"
[0m13:27:56.353363 [debug] [Thread-2 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */
alter table "retail_dwh"."mart"."dim_product__dbt_tmp" rename to "dim_product"
[0m13:27:56.355014 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:27:56.357691 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_customer"
[0m13:27:56.360037 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:27:56.361868 [debug] [Thread-1 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */

  create view "retail_dwh"."mart"."dim_customer__dbt_tmp"
    
    
  as (
    SELECT
    customer_id,
    customer_name,
    customer_gender,
    customer_city,
    customer_signup_date
FROM
    "retail_dwh"."staging"."stg_customers"
  );
[0m13:27:56.366101 [debug] [Thread-2 (]: On model.retail_project.dim_product: COMMIT
[0m13:27:56.367412 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m13:27:56.369788 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_product"
[0m13:27:56.371072 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_store"
[0m13:27:56.373114 [debug] [Thread-2 (]: On model.retail_project.dim_product: COMMIT
[0m13:27:56.375331 [debug] [Thread-4 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */

  create view "retail_dwh"."mart"."dim_store__dbt_tmp"
    
    
  as (
    select
    store_id,
    store_name,
    city as store_city,
    store_region
from "retail_dwh"."staging"."stg_stores"
  );
[0m13:27:56.376504 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:27:56.385163 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_customer"
[0m13:27:56.387792 [debug] [Thread-1 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */
alter table "retail_dwh"."mart"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m13:27:56.389958 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m13:27:56.391071 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:27:56.392095 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:27:56.400186 [debug] [Thread-2 (]: Applying DROP to: "retail_dwh"."mart"."dim_product__dbt_backup"
[0m13:27:56.404583 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_store"
[0m13:27:56.408447 [debug] [Thread-1 (]: On model.retail_project.dim_customer: COMMIT
[0m13:27:56.411091 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_product"
[0m13:27:56.412730 [debug] [Thread-4 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */
alter table "retail_dwh"."mart"."dim_store__dbt_tmp" rename to "dim_store"
[0m13:27:56.414827 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_customer"
[0m13:27:56.415775 [debug] [Thread-2 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */
drop view if exists "retail_dwh"."mart"."dim_product__dbt_backup" cascade
[0m13:27:56.416929 [debug] [Thread-1 (]: On model.retail_project.dim_customer: COMMIT
[0m13:27:56.418593 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:27:56.420294 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:27:56.424026 [debug] [Thread-4 (]: On model.retail_project.dim_store: COMMIT
[0m13:27:56.427700 [debug] [Thread-2 (]: Timing info for model.retail_project.dim_product (execute): 13:27:56.270306 => 13:27:56.426735
[0m13:27:56.428914 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:27:56.430133 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_store"
[0m13:27:56.431230 [debug] [Thread-2 (]: On model.retail_project.dim_product: Close
[0m13:27:56.435163 [debug] [Thread-1 (]: Applying DROP to: "retail_dwh"."mart"."dim_customer__dbt_backup"
[0m13:27:56.436499 [debug] [Thread-4 (]: On model.retail_project.dim_store: COMMIT
[0m13:27:56.438413 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_customer"
[0m13:27:56.440012 [debug] [Thread-1 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */
drop view if exists "retail_dwh"."mart"."dim_customer__dbt_backup" cascade
[0m13:27:56.443043 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36182045-75ad-428c-a713-ec2f1023e53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effba18b650>]}
[0m13:27:56.444071 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m13:27:56.445312 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:27:56.446810 [info ] [Thread-2 (]: 6 of 11 OK created sql view model mart.dim_product ............................. [[32mCREATE VIEW[0m in 0.19s]
[0m13:27:56.456530 [debug] [Thread-1 (]: Timing info for model.retail_project.dim_customer (execute): 13:27:56.282631 => 13:27:56.456033
[0m13:27:56.453251 [debug] [Thread-4 (]: Applying DROP to: "retail_dwh"."mart"."dim_store__dbt_backup"
[0m13:27:56.459011 [debug] [Thread-2 (]: Finished running node model.retail_project.dim_product
[0m13:27:56.460111 [debug] [Thread-1 (]: On model.retail_project.dim_customer: Close
[0m13:27:56.461900 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_store"
[0m13:27:56.464161 [debug] [Thread-4 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */
drop view if exists "retail_dwh"."mart"."dim_store__dbt_backup" cascade
[0m13:27:56.466636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36182045-75ad-428c-a713-ec2f1023e53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effb9d0bf80>]}
[0m13:27:56.468388 [info ] [Thread-1 (]: 5 of 11 OK created sql view model mart.dim_customer ............................ [[32mCREATE VIEW[0m in 0.25s]
[0m13:27:56.470962 [debug] [Thread-1 (]: Finished running node model.retail_project.dim_customer
[0m13:27:56.472478 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:27:56.476969 [debug] [Thread-4 (]: Timing info for model.retail_project.dim_store (execute): 13:27:56.316353 => 13:27:56.476039
[0m13:27:56.478048 [debug] [Thread-4 (]: On model.retail_project.dim_store: Close
[0m13:27:56.480487 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36182045-75ad-428c-a713-ec2f1023e53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effb9d28f50>]}
[0m13:27:56.481272 [info ] [Thread-4 (]: 7 of 11 OK created sql view model mart.dim_store ............................... [[32mCREATE VIEW[0m in 0.21s]
[0m13:27:56.487391 [debug] [Thread-4 (]: Finished running node model.retail_project.dim_store
[0m13:27:56.489825 [debug] [Thread-3 (]: Began running node model.retail_project.fact_sales
[0m13:27:56.492542 [info ] [Thread-3 (]: 8 of 11 START sql view model mart.fact_sales ................................... [RUN]
[0m13:27:56.496513 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_sales_transaction, now model.retail_project.fact_sales)
[0m13:27:56.497422 [debug] [Thread-3 (]: Began compiling node model.retail_project.fact_sales
[0m13:27:56.502750 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_project.fact_sales"
[0m13:27:56.504788 [debug] [Thread-3 (]: Timing info for model.retail_project.fact_sales (compile): 13:27:56.497777 => 13:27:56.504038
[0m13:27:56.505878 [debug] [Thread-3 (]: Began executing node model.retail_project.fact_sales
[0m13:27:56.518264 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_project.fact_sales"
[0m13:27:56.519965 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.fact_sales"
[0m13:27:56.520740 [debug] [Thread-3 (]: On model.retail_project.fact_sales: BEGIN
[0m13:27:56.521471 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:27:56.540477 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m13:27:56.543985 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.fact_sales"
[0m13:27:56.544869 [debug] [Thread-3 (]: On model.retail_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.fact_sales"} */

  create view "retail_dwh"."mart"."fact_sales__dbt_tmp"
    
    
  as (
    with sales as (
    select
        transaction_id,
        transaction_date,
        customer_id,
        product_id,
        store_id,
        quantity,
        unit_price,
        quantity * unit_price as gross_sales
    from "retail_dwh"."staging"."stg_sales_transaction"
),

joined as (
    select
        s.transaction_id,
        s.transaction_date,
        s.customer_id,
        s.product_id,
        s.store_id,
        s.quantity,
        s.unit_price,
        s.gross_sales,

        c.customer_name,
        p.product_name,
        -- p.category,   -- sementara DIHAPUS biar nggak error
        st.store_name,
        st.store_city,
        st.store_region
    from sales s
    left join "retail_dwh"."mart"."dim_customer" c
        on s.customer_id = c.customer_id
    left join "retail_dwh"."mart"."dim_product" p
        on s.product_id = p.product_id
    left join "retail_dwh"."mart"."dim_store" st
        on s.store_id = st.store_id
)

select * from joined
  );
[0m13:27:56.563916 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:27:56.569189 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.fact_sales"
[0m13:27:56.569792 [debug] [Thread-3 (]: On model.retail_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.fact_sales"} */
alter table "retail_dwh"."mart"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m13:27:56.572046 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:27:56.576500 [debug] [Thread-3 (]: On model.retail_project.fact_sales: COMMIT
[0m13:27:56.577183 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.fact_sales"
[0m13:27:56.577920 [debug] [Thread-3 (]: On model.retail_project.fact_sales: COMMIT
[0m13:27:56.583853 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m13:27:56.587192 [debug] [Thread-3 (]: Applying DROP to: "retail_dwh"."mart"."fact_sales__dbt_backup"
[0m13:27:56.588262 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.fact_sales"
[0m13:27:56.588768 [debug] [Thread-3 (]: On model.retail_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.fact_sales"} */
drop view if exists "retail_dwh"."mart"."fact_sales__dbt_backup" cascade
[0m13:27:56.591745 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:27:56.594127 [debug] [Thread-3 (]: Timing info for model.retail_project.fact_sales (execute): 13:27:56.506379 => 13:27:56.593856
[0m13:27:56.594717 [debug] [Thread-3 (]: On model.retail_project.fact_sales: Close
[0m13:27:56.596298 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36182045-75ad-428c-a713-ec2f1023e53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effb9d28fe0>]}
[0m13:27:56.597214 [info ] [Thread-3 (]: 8 of 11 OK created sql view model mart.fact_sales .............................. [[32mCREATE VIEW[0m in 0.10s]
[0m13:27:56.600734 [debug] [Thread-3 (]: Finished running node model.retail_project.fact_sales
[0m13:27:56.603027 [debug] [Thread-1 (]: Began running node model.retail_project.customer_features
[0m13:27:56.604016 [info ] [Thread-1 (]: 9 of 11 START sql table model analytics.customer_features ...................... [RUN]
[0m13:27:56.607366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_project.dim_customer, now model.retail_project.customer_features)
[0m13:27:56.608428 [debug] [Thread-1 (]: Began compiling node model.retail_project.customer_features
[0m13:27:56.612461 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_project.customer_features"
[0m13:27:56.613626 [debug] [Thread-4 (]: Began running node model.retail_project.daily_sales_kpi
[0m13:27:56.614489 [info ] [Thread-4 (]: 10 of 11 START sql view model analytics.daily_sales_kpi ........................ [RUN]
[0m13:27:56.616208 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_project.dim_store, now model.retail_project.daily_sales_kpi)
[0m13:27:56.617835 [debug] [Thread-4 (]: Began compiling node model.retail_project.daily_sales_kpi
[0m13:27:56.629866 [debug] [Thread-2 (]: Began running node model.retail_project.daily_store_sales
[0m13:27:56.627477 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_project.daily_sales_kpi"
[0m13:27:56.635152 [debug] [Thread-1 (]: Timing info for model.retail_project.customer_features (compile): 13:27:56.609019 => 13:27:56.633927
[0m13:27:56.637902 [debug] [Thread-1 (]: Began executing node model.retail_project.customer_features
[0m13:27:56.631228 [info ] [Thread-2 (]: 11 of 11 START sql table model analytics.daily_store_sales ..................... [RUN]
[0m13:27:56.682138 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_project.dim_product, now model.retail_project.daily_store_sales)
[0m13:27:56.683801 [debug] [Thread-2 (]: Began compiling node model.retail_project.daily_store_sales
[0m13:27:56.699603 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_project.daily_store_sales"
[0m13:27:56.695765 [debug] [Thread-4 (]: Timing info for model.retail_project.daily_sales_kpi (compile): 13:27:56.621769 => 13:27:56.695208
[0m13:27:56.692137 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_project.customer_features"
[0m13:27:56.700759 [debug] [Thread-4 (]: Began executing node model.retail_project.daily_sales_kpi
[0m13:27:56.702644 [debug] [Thread-2 (]: Timing info for model.retail_project.daily_store_sales (compile): 13:27:56.696782 => 13:27:56.701985
[0m13:27:56.712503 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_project.daily_sales_kpi"
[0m13:27:56.715470 [debug] [Thread-2 (]: Began executing node model.retail_project.daily_store_sales
[0m13:27:56.714504 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.customer_features"
[0m13:27:56.723631 [debug] [Thread-1 (]: On model.retail_project.customer_features: BEGIN
[0m13:27:56.722684 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.daily_sales_kpi"
[0m13:27:56.725941 [debug] [Thread-4 (]: On model.retail_project.daily_sales_kpi: BEGIN
[0m13:27:56.724922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:56.721734 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_project.daily_store_sales"
[0m13:27:56.726686 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:27:56.737560 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.daily_store_sales"
[0m13:27:56.738477 [debug] [Thread-2 (]: On model.retail_project.daily_store_sales: BEGIN
[0m13:27:56.739029 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:27:56.749673 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:27:56.751547 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.customer_features"
[0m13:27:56.753019 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m13:27:56.756255 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.daily_sales_kpi"
[0m13:27:56.757203 [debug] [Thread-4 (]: On model.retail_project.daily_sales_kpi: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.daily_sales_kpi"} */

  create view "retail_dwh"."analytics"."daily_sales_kpi__dbt_tmp"
    
    
  as (
    select
    transaction_date::date                            as date,
    sum(gross_sales)                                  as total_sales,
    sum(quantity)                                     as total_qty,
    count(distinct customer_id)                       as unique_customers,
    case
        when sum(quantity) > 0 then sum(gross_sales) / sum(quantity)
        else null
    end                                               as avg_price_per_unit,
    case
        when count(distinct transaction_id) > 0
            then sum(gross_sales) / count(distinct transaction_id)
        else null
    end                                               as avg_order_value
from "retail_dwh"."mart"."fact_sales"
group by 1
order by 1;
  );
[0m13:27:56.754597 [debug] [Thread-1 (]: On model.retail_project.customer_features: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.customer_features"} */

  
    

  create  table "retail_dwh"."analytics"."customer_features__dbt_tmp"
  
  
    as
  
  (
    with base as (
    select
        customer_id,
        customer_name,
        customer_signup_date,
        current_date - customer_signup_date as customer_tenure_days
    from "retail_dwh"."mart"."dim_customer"
),

agg_sales as (
    select
        customer_id,
        count(distinct transaction_id)        as total_txn,
        sum(gross_sales)                      as total_spent,
        max(transaction_date)::date           as last_transaction_date
    from "retail_dwh"."mart"."fact_sales"
    group by customer_id
)

select
    b.customer_id,
    b.customer_name,
    b.customer_signup_date,
    b.customer_tenure_days,

    a.total_txn                                 as frequency,
    a.total_spent                               as monetary,
    a.last_transaction_date,
    current_date - a.last_transaction_date      as recency_days,
    case
        when a.total_txn > 0 then a.total_spent / a.total_txn
        else null
    end                                         as avg_order_value
from base b
left join agg_sales a
  on b.customer_id = a.customer_id;
  );
  
[0m13:27:56.759153 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 23: order by 1;
                   ^

[0m13:27:56.760022 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 47:   on b.customer_id = a.customer_id;
                                           ^

[0m13:27:56.761915 [debug] [Thread-1 (]: On model.retail_project.customer_features: ROLLBACK
[0m13:27:56.760954 [debug] [Thread-4 (]: On model.retail_project.daily_sales_kpi: ROLLBACK
[0m13:27:56.763531 [debug] [Thread-4 (]: Timing info for model.retail_project.daily_sales_kpi (execute): 13:27:56.703839 => 13:27:56.763185
[0m13:27:56.764147 [debug] [Thread-4 (]: On model.retail_project.daily_sales_kpi: Close
[0m13:27:56.770309 [debug] [Thread-1 (]: Timing info for model.retail_project.customer_features (execute): 13:27:56.638709 => 13:27:56.769593
[0m13:27:56.767218 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m13:27:56.772506 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.daily_store_sales"
[0m13:27:56.771703 [debug] [Thread-1 (]: On model.retail_project.customer_features: Close
[0m13:27:56.773330 [debug] [Thread-2 (]: On model.retail_project.daily_store_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.daily_store_sales"} */

  
    

  create  table "retail_dwh"."analytics"."daily_store_sales__dbt_tmp"
  
  
    as
  
  (
    with base as (
    select
        transaction_date::date    as date,
        store_id,
        store_name,
        store_city,
        sum(gross_sales)          as total_sales,
        sum(quantity)             as total_qty
    from "retail_dwh"."mart"."fact_sales"
    group by 1,2,3,4
)

select
    *,
    rank() over (partition by date order by total_sales desc) as sales_rank_in_day
from base
order by date, sales_rank_in_day;
  );
  
[0m13:27:56.782700 [debug] [Thread-4 (]: Database Error in model daily_sales_kpi (models/analytics/kpi/daily_sales_kpi.sql)
  syntax error at or near ";"
  LINE 23: order by 1;
                     ^
  compiled Code at target/run/retail_project/models/analytics/kpi/daily_sales_kpi.sql
[0m13:27:56.787056 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 28: order by date, sales_rank_in_day;
                                         ^

[0m13:27:56.788451 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36182045-75ad-428c-a713-ec2f1023e53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effb9d4e960>]}
[0m13:27:56.790822 [debug] [Thread-1 (]: Database Error in model customer_features (models/analytics/features/customer_features.sql)
  syntax error at or near ";"
  LINE 47:   on b.customer_id = a.customer_id;
                                             ^
  compiled Code at target/run/retail_project/models/analytics/features/customer_features.sql
[0m13:27:56.825813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36182045-75ad-428c-a713-ec2f1023e53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effba17fdd0>]}
[0m13:27:56.820596 [debug] [Thread-2 (]: On model.retail_project.daily_store_sales: ROLLBACK
[0m13:27:56.822635 [error] [Thread-4 (]: 10 of 11 ERROR creating sql view model analytics.daily_sales_kpi ............... [[31mERROR[0m in 0.17s]
[0m13:27:56.828935 [debug] [Thread-2 (]: Timing info for model.retail_project.daily_store_sales (execute): 13:27:56.717148 => 13:27:56.827992
[0m13:27:56.832120 [debug] [Thread-4 (]: Finished running node model.retail_project.daily_sales_kpi
[0m13:27:56.827125 [error] [Thread-1 (]: 9 of 11 ERROR creating sql table model analytics.customer_features ............. [[31mERROR[0m in 0.22s]
[0m13:27:56.835308 [debug] [Thread-2 (]: On model.retail_project.daily_store_sales: Close
[0m13:27:56.841533 [debug] [Thread-1 (]: Finished running node model.retail_project.customer_features
[0m13:27:56.849452 [debug] [Thread-2 (]: Database Error in model daily_store_sales (models/analytics/summaries/daily_store_sales.sql)
  syntax error at or near ";"
  LINE 28: order by date, sales_rank_in_day;
                                           ^
  compiled Code at target/run/retail_project/models/analytics/summaries/daily_store_sales.sql
[0m13:27:56.850093 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36182045-75ad-428c-a713-ec2f1023e53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effb9d4e600>]}
[0m13:27:56.850798 [error] [Thread-2 (]: 11 of 11 ERROR creating sql table model analytics.daily_store_sales ............ [[31mERROR[0m in 0.17s]
[0m13:27:56.856696 [debug] [Thread-2 (]: Finished running node model.retail_project.daily_store_sales
[0m13:27:56.874861 [debug] [MainThread]: Using postgres connection "master"
[0m13:27:56.876051 [debug] [MainThread]: On master: BEGIN
[0m13:27:56.876704 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:27:56.890355 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:27:56.891582 [debug] [MainThread]: On master: COMMIT
[0m13:27:56.892281 [debug] [MainThread]: Using postgres connection "master"
[0m13:27:56.892934 [debug] [MainThread]: On master: COMMIT
[0m13:27:56.893793 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:27:56.894477 [debug] [MainThread]: On master: Close
[0m13:27:56.900051 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:27:56.900751 [debug] [MainThread]: Connection 'model.retail_project.fact_sales' was properly closed.
[0m13:27:56.901321 [debug] [MainThread]: Connection 'model.retail_project.daily_store_sales' was properly closed.
[0m13:27:56.901907 [debug] [MainThread]: Connection 'model.retail_project.customer_features' was properly closed.
[0m13:27:56.902349 [debug] [MainThread]: Connection 'model.retail_project.daily_sales_kpi' was properly closed.
[0m13:27:56.902860 [info ] [MainThread]: 
[0m13:27:56.905257 [info ] [MainThread]: Finished running 9 view models, 2 table models in 0 hours 0 minutes and 1.52 seconds (1.52s).
[0m13:27:56.913242 [debug] [MainThread]: Command end result
[0m13:27:56.929460 [info ] [MainThread]: 
[0m13:27:56.934858 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m13:27:56.936231 [info ] [MainThread]: 
[0m13:27:56.938721 [error] [MainThread]:   Database Error in model daily_sales_kpi (models/analytics/kpi/daily_sales_kpi.sql)
  syntax error at or near ";"
  LINE 23: order by 1;
                     ^
  compiled Code at target/run/retail_project/models/analytics/kpi/daily_sales_kpi.sql
[0m13:27:56.941881 [info ] [MainThread]: 
[0m13:27:56.944599 [error] [MainThread]:   Database Error in model customer_features (models/analytics/features/customer_features.sql)
  syntax error at or near ";"
  LINE 47:   on b.customer_id = a.customer_id;
                                             ^
  compiled Code at target/run/retail_project/models/analytics/features/customer_features.sql
[0m13:27:56.948858 [info ] [MainThread]: 
[0m13:27:56.954941 [error] [MainThread]:   Database Error in model daily_store_sales (models/analytics/summaries/daily_store_sales.sql)
  syntax error at or near ";"
  LINE 28: order by date, sales_rank_in_day;
                                           ^
  compiled Code at target/run/retail_project/models/analytics/summaries/daily_store_sales.sql
[0m13:27:56.955644 [info ] [MainThread]: 
[0m13:27:56.957273 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=3 SKIP=0 TOTAL=11
[0m13:27:56.960885 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.317532, "process_user_time": 3.713822, "process_kernel_time": 1.044033, "process_mem_max_rss": "136844", "process_out_blocks": "2800", "command_success": false, "process_in_blocks": "0"}
[0m13:27:56.961905 [debug] [MainThread]: Command `dbt run` failed at 13:27:56.961641 after 2.32 seconds
[0m13:27:56.962971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effbbdf1880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effba5fffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effbb105640>]}
[0m13:27:56.963780 [debug] [MainThread]: Flushing usage events
[0m13:30:29.837740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe65b8dbb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe65bc164e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe65bf7cbf0>]}


============================== 13:30:29.842197 | 76955bb3-5bd4-403f-8fd6-d73334a37e60 ==============================
[0m13:30:29.842197 [info ] [MainThread]: Running with dbt=1.7.0
[0m13:30:29.843184 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/dbt/retail_project/retail_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /root/.dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:30:30.104024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76955bb3-5bd4-403f-8fd6-d73334a37e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe65b902db0>]}
[0m13:30:30.211575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76955bb3-5bd4-403f-8fd6-d73334a37e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe65ba70500>]}
[0m13:30:30.212484 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m13:30:30.228154 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m13:30:30.260937 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m13:30:30.261696 [debug] [MainThread]: Partial parsing: updated file: retail_project://models/analytics/summaries/daily_store_sales.sql
[0m13:30:30.262201 [debug] [MainThread]: Partial parsing: updated file: retail_project://models/analytics/features/customer_features.sql
[0m13:30:30.262702 [debug] [MainThread]: Partial parsing: updated file: retail_project://models/analytics/kpi/daily_sales_kpi.sql
[0m13:30:30.456643 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail_project.intermediate
[0m13:30:30.462357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76955bb3-5bd4-403f-8fd6-d73334a37e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe65b8d9550>]}
[0m13:30:30.485147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76955bb3-5bd4-403f-8fd6-d73334a37e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe65ab6d7c0>]}
[0m13:30:30.485965 [info ] [MainThread]: Found 11 models, 4 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m13:30:30.487923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76955bb3-5bd4-403f-8fd6-d73334a37e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe65a3411c0>]}
[0m13:30:30.492131 [info ] [MainThread]: 
[0m13:30:30.495498 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:30:30.499150 [debug] [ThreadPool]: Acquiring new postgres connection 'list_retail_dwh'
[0m13:30:30.501486 [debug] [ThreadPool]: Acquiring new postgres connection 'list_retail_dwh'
[0m13:30:30.520346 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh"
[0m13:30:30.523564 [debug] [ThreadPool]: On list_retail_dwh: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh"} */

    select distinct nspname from pg_namespace
  
[0m13:30:30.526376 [debug] [ThreadPool]: Acquiring new postgres connection 'list_retail_dwh'
[0m13:30:30.529950 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh"
[0m13:30:30.531894 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:30:30.614353 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh"
[0m13:30:30.615903 [debug] [ThreadPool]: On list_retail_dwh: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh"} */

    select distinct nspname from pg_namespace
  
[0m13:30:30.620041 [debug] [ThreadPool]: On list_retail_dwh: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh"} */

    select distinct nspname from pg_namespace
  
[0m13:30:30.622063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:30:30.623813 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:30:30.642157 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m13:30:30.643394 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m13:30:30.647719 [debug] [ThreadPool]: On list_retail_dwh: Close
[0m13:30:30.650337 [debug] [ThreadPool]: On list_retail_dwh: Close
[0m13:30:30.651165 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m13:30:30.657088 [debug] [ThreadPool]: On list_retail_dwh: Close
[0m13:30:30.665050 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_dwh, now list_retail_dwh_staging)
[0m13:30:30.667210 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_dwh, now list_retail_dwh_analytics)
[0m13:30:30.675985 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_staging"
[0m13:30:30.685109 [debug] [ThreadPool]: On list_retail_dwh_staging: BEGIN
[0m13:30:30.683092 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_dwh, now list_retail_dwh_mart)
[0m13:30:30.681298 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_analytics"
[0m13:30:30.685927 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:30:30.688826 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_mart"
[0m13:30:30.689769 [debug] [ThreadPool]: On list_retail_dwh_analytics: BEGIN
[0m13:30:30.692150 [debug] [ThreadPool]: On list_retail_dwh_mart: BEGIN
[0m13:30:30.694334 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:30:30.696231 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:30:30.710235 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:30:30.711262 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_staging"
[0m13:30:30.711974 [debug] [ThreadPool]: On list_retail_dwh_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh_staging"} */
select
      'retail_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'retail_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'retail_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m13:30:30.715957 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:30:30.716666 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_analytics"
[0m13:30:30.717245 [debug] [ThreadPool]: On list_retail_dwh_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh_analytics"} */
select
      'retail_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'retail_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'retail_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m13:30:30.718831 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:30:30.719957 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_mart"
[0m13:30:30.720558 [debug] [ThreadPool]: On list_retail_dwh_mart: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh_mart"} */
select
      'retail_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'retail_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
    union all
    select
      'retail_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'mart'
  
[0m13:30:30.721775 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:30:30.725033 [debug] [ThreadPool]: On list_retail_dwh_staging: ROLLBACK
[0m13:30:30.727017 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m13:30:30.730265 [debug] [ThreadPool]: On list_retail_dwh_analytics: ROLLBACK
[0m13:30:30.731870 [debug] [ThreadPool]: On list_retail_dwh_staging: Close
[0m13:30:30.732891 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:30:30.733368 [debug] [ThreadPool]: On list_retail_dwh_analytics: Close
[0m13:30:30.735661 [debug] [ThreadPool]: On list_retail_dwh_mart: ROLLBACK
[0m13:30:30.741356 [debug] [ThreadPool]: On list_retail_dwh_mart: Close
[0m13:30:30.756440 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:30.756984 [debug] [MainThread]: On master: BEGIN
[0m13:30:30.757637 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:30:30.771959 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:30:30.772625 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:30.773726 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:30:30.806413 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m13:30:30.813950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76955bb3-5bd4-403f-8fd6-d73334a37e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe65a7f9400>]}
[0m13:30:30.814584 [debug] [MainThread]: On master: ROLLBACK
[0m13:30:30.815792 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:30.816233 [debug] [MainThread]: On master: BEGIN
[0m13:30:30.818297 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:30:30.819187 [debug] [MainThread]: On master: COMMIT
[0m13:30:30.819588 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:30.820002 [debug] [MainThread]: On master: COMMIT
[0m13:30:30.821112 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:30:30.821574 [debug] [MainThread]: On master: Close
[0m13:30:30.823126 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:30:30.825224 [info ] [MainThread]: 
[0m13:30:30.842568 [debug] [Thread-1 (]: Began running node model.retail_project.stg_customers
[0m13:30:30.846937 [debug] [Thread-2 (]: Began running node model.retail_project.stg_products
[0m13:30:30.844326 [info ] [Thread-1 (]: 1 of 11 START sql view model staging.stg_customers ............................. [RUN]
[0m13:30:30.851038 [debug] [Thread-3 (]: Began running node model.retail_project.stg_sales_transaction
[0m13:30:30.853086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail_dwh_analytics, now model.retail_project.stg_customers)
[0m13:30:30.854899 [debug] [Thread-4 (]: Began running node model.retail_project.stg_stores
[0m13:30:30.850081 [info ] [Thread-2 (]: 2 of 11 START sql view model staging.stg_products .............................. [RUN]
[0m13:30:30.856983 [debug] [Thread-1 (]: Began compiling node model.retail_project.stg_customers
[0m13:30:30.854172 [info ] [Thread-3 (]: 3 of 11 START sql view model staging.stg_sales_transaction ..................... [RUN]
[0m13:30:30.861423 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_retail_dwh_mart, now model.retail_project.stg_products)
[0m13:30:30.872344 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_project.stg_customers"
[0m13:30:30.858561 [info ] [Thread-4 (]: 4 of 11 START sql view model staging.stg_stores ................................ [RUN]
[0m13:30:30.875368 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_retail_dwh_staging, now model.retail_project.stg_sales_transaction)
[0m13:30:30.877003 [debug] [Thread-2 (]: Began compiling node model.retail_project.stg_products
[0m13:30:30.878444 [debug] [Thread-1 (]: Timing info for model.retail_project.stg_customers (compile): 13:30:30.862536 => 13:30:30.877958
[0m13:30:30.888274 [debug] [Thread-1 (]: Began executing node model.retail_project.stg_customers
[0m13:30:30.882024 [debug] [Thread-3 (]: Began compiling node model.retail_project.stg_sales_transaction
[0m13:30:30.887311 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_project.stg_products"
[0m13:30:30.880139 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.retail_project.stg_stores'
[0m13:30:30.907789 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_project.stg_sales_transaction"
[0m13:30:30.950316 [debug] [Thread-4 (]: Began compiling node model.retail_project.stg_stores
[0m13:30:30.952179 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_project.stg_customers"
[0m13:30:30.953414 [debug] [Thread-2 (]: Timing info for model.retail_project.stg_products (compile): 13:30:30.882884 => 13:30:30.953106
[0m13:30:30.965648 [debug] [Thread-3 (]: Timing info for model.retail_project.stg_sales_transaction (compile): 13:30:30.902571 => 13:30:30.965356
[0m13:30:30.964155 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m13:30:30.967282 [debug] [Thread-2 (]: Began executing node model.retail_project.stg_products
[0m13:30:30.967929 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_project.stg_stores"
[0m13:30:30.968654 [debug] [Thread-3 (]: Began executing node model.retail_project.stg_sales_transaction
[0m13:30:30.969822 [debug] [Thread-1 (]: On model.retail_project.stg_customers: BEGIN
[0m13:30:30.975076 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_project.stg_products"
[0m13:30:30.977383 [debug] [Thread-4 (]: Timing info for model.retail_project.stg_stores (compile): 13:30:30.954158 => 13:30:30.976794
[0m13:30:30.985667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:30.986768 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_project.stg_sales_transaction"
[0m13:30:30.988390 [debug] [Thread-4 (]: Began executing node model.retail_project.stg_stores
[0m13:30:30.989464 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m13:30:30.998561 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_project.stg_stores"
[0m13:30:31.000314 [debug] [Thread-2 (]: On model.retail_project.stg_products: BEGIN
[0m13:30:31.001439 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m13:30:31.003924 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:30:31.006130 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: BEGIN
[0m13:30:31.007349 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m13:30:31.010854 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:30:31.012334 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:30:31.014056 [debug] [Thread-4 (]: On model.retail_project.stg_stores: BEGIN
[0m13:30:31.016195 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m13:30:31.018393 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:30:31.020152 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */

  create view "retail_dwh"."staging"."stg_customers__dbt_tmp"
    
    
  as (
    SELECT
    customer_id,
    customer_name,
    UPPER(TRIM(gender)) AS customer_gender,
    TRIM(city) AS customer_city,
    CAST(signup_date AS DATE) AS customer_signup_date
FROM
    "retail_dwh"."raw"."customers_raw"
  );
[0m13:30:31.029502 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:30:31.043203 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m13:30:31.049025 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
alter table "retail_dwh"."staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m13:30:31.051894 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m13:30:31.053804 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m13:30:31.055362 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m13:30:31.057304 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m13:30:31.058430 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */

  create view "retail_dwh"."staging"."stg_stores__dbt_tmp"
    
    
  as (
    with source as (
    select
        store_id,
        store_name,
        city,
        region
    from "retail_dwh"."raw"."stores_raw"
),

renamed as (
    select
        store_id,
        store_name,
        city,
        region as store_region
    from source
)

select * from renamed
  );
[0m13:30:31.060113 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:30:31.061393 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m13:30:31.063775 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m13:30:31.073318 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */

  create view "retail_dwh"."staging"."stg_products__dbt_tmp"
    
    
  as (
    SELECT
    product_id,
    product_name,
    TRIM(category) AS product_category,
    TRIM(sub_category) AS product_sub_category,
    CAST(price AS NUMERIC) AS product_price
FROM
    "retail_dwh"."raw"."products_raw"
  );
[0m13:30:31.074693 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m13:30:31.075947 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:30:31.078530 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */

  create view "retail_dwh"."staging"."stg_sales_transaction__dbt_tmp"
    
    
  as (
    with source as (
    select
        transaction_id,
        transaction_date,
        customer_id,
        product_id,
        store_id,
        quantity,
        total_price
    from "retail_dwh"."raw"."sales_transaction_raw"
),

typed as (
    select
        transaction_id,
        customer_id,
        product_id,
        store_id,
        transaction_date::date        as transaction_date,
        quantity::integer             as quantity,
        total_price::numeric(18,2)    as total_price,
        case
            when quantity::numeric <> 0
                then total_price::numeric(18,2) / quantity::numeric
            else null
        end                           as unit_price
    from source
)

select * from typed
  );
[0m13:30:31.091440 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m13:30:31.090035 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:30:31.093947 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
alter table "retail_dwh"."staging"."stg_stores" rename to "stg_stores__dbt_backup"
[0m13:30:31.081740 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
alter table "retail_dwh"."staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m13:30:31.099571 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m13:30:31.101586 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:30:31.103092 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:30:31.104570 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
alter table "retail_dwh"."staging"."stg_products" rename to "stg_products__dbt_backup"
[0m13:30:31.105144 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:30:31.140184 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m13:30:31.141686 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
alter table "retail_dwh"."staging"."stg_stores__dbt_tmp" rename to "stg_stores"
[0m13:30:31.144383 [debug] [Thread-1 (]: On model.retail_project.stg_customers: COMMIT
[0m13:30:31.147424 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m13:30:31.148766 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m13:30:31.149914 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:30:31.151362 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */
alter table "retail_dwh"."staging"."stg_sales_transaction" rename to "stg_sales_transaction__dbt_backup"
[0m13:30:31.152956 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:30:31.154018 [debug] [Thread-1 (]: On model.retail_project.stg_customers: COMMIT
[0m13:30:31.159108 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m13:30:31.163349 [debug] [Thread-4 (]: On model.retail_project.stg_stores: COMMIT
[0m13:30:31.165280 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:30:31.168288 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
alter table "retail_dwh"."staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:30:31.170534 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m13:30:31.171924 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:30:31.178943 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m13:30:31.180910 [debug] [Thread-4 (]: On model.retail_project.stg_stores: COMMIT
[0m13:30:31.183059 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:30:31.196108 [debug] [Thread-1 (]: Applying DROP to: "retail_dwh"."staging"."stg_customers__dbt_backup"
[0m13:30:31.198410 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */
alter table "retail_dwh"."staging"."stg_sales_transaction__dbt_tmp" rename to "stg_sales_transaction"
[0m13:30:31.204580 [debug] [Thread-2 (]: On model.retail_project.stg_products: COMMIT
[0m13:30:31.213499 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m13:30:31.217147 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m13:30:31.219203 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:30:31.220881 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m13:30:31.222591 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
drop view if exists "retail_dwh"."staging"."stg_customers__dbt_backup" cascade
[0m13:30:31.228255 [debug] [Thread-4 (]: Applying DROP to: "retail_dwh"."staging"."stg_stores__dbt_backup"
[0m13:30:31.232958 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: COMMIT
[0m13:30:31.234995 [debug] [Thread-2 (]: On model.retail_project.stg_products: COMMIT
[0m13:30:31.238145 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m13:30:31.240251 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m13:30:31.242085 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:30:31.244088 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
drop view if exists "retail_dwh"."staging"."stg_stores__dbt_backup" cascade
[0m13:30:31.245701 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: COMMIT
[0m13:30:31.249706 [debug] [Thread-1 (]: Timing info for model.retail_project.stg_customers (execute): 13:30:30.888680 => 13:30:31.249427
[0m13:30:31.252192 [debug] [Thread-1 (]: On model.retail_project.stg_customers: Close
[0m13:30:31.253603 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m13:30:31.258526 [debug] [Thread-2 (]: Applying DROP to: "retail_dwh"."staging"."stg_products__dbt_backup"
[0m13:30:31.261432 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m13:30:31.262808 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:30:31.264183 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
drop view if exists "retail_dwh"."staging"."stg_products__dbt_backup" cascade
[0m13:30:31.266370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76955bb3-5bd4-403f-8fd6-d73334a37e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe659f45250>]}
[0m13:30:31.268047 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m13:30:31.271230 [debug] [Thread-4 (]: Timing info for model.retail_project.stg_stores (execute): 13:30:30.992884 => 13:30:31.270957
[0m13:30:31.276938 [info ] [Thread-1 (]: 1 of 11 OK created sql view model staging.stg_customers ........................ [[32mCREATE VIEW[0m in 0.41s]
[0m13:30:31.279941 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:30:31.284548 [debug] [Thread-3 (]: Applying DROP to: "retail_dwh"."staging"."stg_sales_transaction__dbt_backup"
[0m13:30:31.286235 [debug] [Thread-4 (]: On model.retail_project.stg_stores: Close
[0m13:30:31.288297 [debug] [Thread-1 (]: Finished running node model.retail_project.stg_customers
[0m13:30:31.292684 [debug] [Thread-2 (]: Timing info for model.retail_project.stg_products (execute): 13:30:30.970474 => 13:30:31.292413
[0m13:30:31.294494 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m13:30:31.298058 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76955bb3-5bd4-403f-8fd6-d73334a37e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe659f274a0>]}
[0m13:30:31.299581 [debug] [Thread-2 (]: On model.retail_project.stg_products: Close
[0m13:30:31.302117 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */
drop view if exists "retail_dwh"."staging"."stg_sales_transaction__dbt_backup" cascade
[0m13:30:31.303448 [debug] [Thread-1 (]: Began running node model.retail_project.dim_customer
[0m13:30:31.305195 [info ] [Thread-4 (]: 4 of 11 OK created sql view model staging.stg_stores ........................... [[32mCREATE VIEW[0m in 0.42s]
[0m13:30:31.308184 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76955bb3-5bd4-403f-8fd6-d73334a37e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe659f26ff0>]}
[0m13:30:31.310072 [info ] [Thread-1 (]: 5 of 11 START sql view model mart.dim_customer ................................. [RUN]
[0m13:30:31.313273 [debug] [Thread-4 (]: Finished running node model.retail_project.stg_stores
[0m13:30:31.316154 [info ] [Thread-2 (]: 2 of 11 OK created sql view model staging.stg_products ......................... [[32mCREATE VIEW[0m in 0.45s]
[0m13:30:31.320040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_customers, now model.retail_project.dim_customer)
[0m13:30:31.321896 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:30:31.323413 [debug] [Thread-2 (]: Finished running node model.retail_project.stg_products
[0m13:30:31.325453 [debug] [Thread-1 (]: Began compiling node model.retail_project.dim_customer
[0m13:30:31.327193 [debug] [Thread-4 (]: Began running node model.retail_project.dim_store
[0m13:30:31.331483 [debug] [Thread-3 (]: Timing info for model.retail_project.stg_sales_transaction (execute): 13:30:30.978069 => 13:30:31.331126
[0m13:30:31.336706 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_project.dim_customer"
[0m13:30:31.338489 [info ] [Thread-4 (]: 6 of 11 START sql view model mart.dim_store .................................... [RUN]
[0m13:30:31.341361 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: Close
[0m13:30:31.345036 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_stores, now model.retail_project.dim_store)
[0m13:30:31.348587 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76955bb3-5bd4-403f-8fd6-d73334a37e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe659f27590>]}
[0m13:30:31.352028 [debug] [Thread-4 (]: Began compiling node model.retail_project.dim_store
[0m13:30:31.352950 [debug] [Thread-2 (]: Began running node model.retail_project.dim_product
[0m13:30:31.354308 [debug] [Thread-1 (]: Timing info for model.retail_project.dim_customer (compile): 13:30:31.333818 => 13:30:31.353482
[0m13:30:31.365359 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_project.dim_store"
[0m13:30:31.364757 [info ] [Thread-2 (]: 7 of 11 START sql view model mart.dim_product .................................. [RUN]
[0m13:30:31.356255 [info ] [Thread-3 (]: 3 of 11 OK created sql view model staging.stg_sales_transaction ................ [[32mCREATE VIEW[0m in 0.47s]
[0m13:30:31.366742 [debug] [Thread-1 (]: Began executing node model.retail_project.dim_customer
[0m13:30:31.370101 [debug] [Thread-4 (]: Timing info for model.retail_project.dim_store (compile): 13:30:31.357236 => 13:30:31.369198
[0m13:30:31.372191 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_products, now model.retail_project.dim_product)
[0m13:30:31.374291 [debug] [Thread-3 (]: Finished running node model.retail_project.stg_sales_transaction
[0m13:30:31.383544 [debug] [Thread-4 (]: Began executing node model.retail_project.dim_store
[0m13:30:31.385715 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_project.dim_customer"
[0m13:30:31.387324 [debug] [Thread-2 (]: Began compiling node model.retail_project.dim_product
[0m13:30:31.400391 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_project.dim_store"
[0m13:30:31.404943 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_project.dim_product"
[0m13:30:31.409076 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_customer"
[0m13:30:31.411207 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_store"
[0m13:30:31.413540 [debug] [Thread-2 (]: Timing info for model.retail_project.dim_product (compile): 13:30:31.401938 => 13:30:31.412401
[0m13:30:31.415640 [debug] [Thread-1 (]: On model.retail_project.dim_customer: BEGIN
[0m13:30:31.417294 [debug] [Thread-4 (]: On model.retail_project.dim_store: BEGIN
[0m13:30:31.418934 [debug] [Thread-2 (]: Began executing node model.retail_project.dim_product
[0m13:30:31.420225 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:31.421419 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:30:31.430411 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_project.dim_product"
[0m13:30:31.436292 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_product"
[0m13:30:31.437998 [debug] [Thread-2 (]: On model.retail_project.dim_product: BEGIN
[0m13:30:31.438975 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:30:31.452402 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:30:31.455287 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_customer"
[0m13:30:31.456764 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m13:30:31.457901 [debug] [Thread-1 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */

  create view "retail_dwh"."mart"."dim_customer__dbt_tmp"
    
    
  as (
    SELECT
    customer_id,
    customer_name,
    customer_gender,
    customer_city,
    customer_signup_date
FROM
    "retail_dwh"."staging"."stg_customers"
  );
[0m13:30:31.459176 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_store"
[0m13:30:31.460640 [debug] [Thread-4 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */

  create view "retail_dwh"."mart"."dim_store__dbt_tmp"
    
    
  as (
    select
    store_id,
    store_name,
    city as store_city,
    store_region
from "retail_dwh"."staging"."stg_stores"
  );
[0m13:30:31.461563 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m13:30:31.462618 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:30:31.463654 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:30:31.465038 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_product"
[0m13:30:31.473509 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_customer"
[0m13:30:31.480635 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_store"
[0m13:30:31.481850 [debug] [Thread-2 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */

  create view "retail_dwh"."mart"."dim_product__dbt_tmp"
    
    
  as (
    select
    product_id,
    product_name,
    product_category      as category,
    product_sub_category  as sub_category,
    product_price         as price
from "retail_dwh"."staging"."stg_products"
  );
[0m13:30:31.482870 [debug] [Thread-1 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */
alter table "retail_dwh"."mart"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m13:30:31.484183 [debug] [Thread-4 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */
alter table "retail_dwh"."mart"."dim_store__dbt_tmp" rename to "dim_store"
[0m13:30:31.485955 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:30:31.489603 [debug] [Thread-1 (]: On model.retail_project.dim_customer: COMMIT
[0m13:30:31.490849 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_customer"
[0m13:30:31.491916 [debug] [Thread-1 (]: On model.retail_project.dim_customer: COMMIT
[0m13:30:31.493436 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:30:31.504381 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:30:31.514062 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:30:31.515746 [debug] [Thread-4 (]: On model.retail_project.dim_store: COMMIT
[0m13:30:31.519385 [debug] [Thread-1 (]: Applying DROP to: "retail_dwh"."mart"."dim_customer__dbt_backup"
[0m13:30:31.523882 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_product"
[0m13:30:31.524972 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_store"
[0m13:30:31.527408 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_customer"
[0m13:30:31.528884 [debug] [Thread-2 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */
alter table "retail_dwh"."mart"."dim_product__dbt_tmp" rename to "dim_product"
[0m13:30:31.530452 [debug] [Thread-4 (]: On model.retail_project.dim_store: COMMIT
[0m13:30:31.531963 [debug] [Thread-1 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */
drop view if exists "retail_dwh"."mart"."dim_customer__dbt_backup" cascade
[0m13:30:31.534416 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:30:31.535990 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m13:30:31.540783 [debug] [Thread-2 (]: On model.retail_project.dim_product: COMMIT
[0m13:30:31.542245 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:30:31.549518 [debug] [Thread-4 (]: Applying DROP to: "retail_dwh"."mart"."dim_store__dbt_backup"
[0m13:30:31.551637 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_product"
[0m13:30:31.555475 [debug] [Thread-1 (]: Timing info for model.retail_project.dim_customer (execute): 13:30:31.375308 => 13:30:31.554795
[0m13:30:31.557662 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.dim_store"
[0m13:30:31.559253 [debug] [Thread-2 (]: On model.retail_project.dim_product: COMMIT
[0m13:30:31.561091 [debug] [Thread-1 (]: On model.retail_project.dim_customer: Close
[0m13:30:31.562808 [debug] [Thread-4 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */
drop view if exists "retail_dwh"."mart"."dim_store__dbt_backup" cascade
[0m13:30:31.566147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76955bb3-5bd4-403f-8fd6-d73334a37e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe659b24320>]}
[0m13:30:31.568011 [info ] [Thread-1 (]: 5 of 11 OK created sql view model mart.dim_customer ............................ [[32mCREATE VIEW[0m in 0.25s]
[0m13:30:31.569397 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m13:30:31.571064 [debug] [Thread-1 (]: Finished running node model.retail_project.dim_customer
[0m13:30:31.571747 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:30:31.576526 [debug] [Thread-2 (]: Applying DROP to: "retail_dwh"."mart"."dim_product__dbt_backup"
[0m13:30:31.580580 [debug] [Thread-4 (]: Timing info for model.retail_project.dim_store (execute): 13:30:31.388872 => 13:30:31.580307
[0m13:30:31.583288 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_product"
[0m13:30:31.585033 [debug] [Thread-4 (]: On model.retail_project.dim_store: Close
[0m13:30:31.586813 [debug] [Thread-2 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */
drop view if exists "retail_dwh"."mart"."dim_product__dbt_backup" cascade
[0m13:30:31.588831 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76955bb3-5bd4-403f-8fd6-d73334a37e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe659f68e90>]}
[0m13:30:31.590811 [info ] [Thread-4 (]: 6 of 11 OK created sql view model mart.dim_store ............................... [[32mCREATE VIEW[0m in 0.24s]
[0m13:30:31.593026 [debug] [Thread-4 (]: Finished running node model.retail_project.dim_store
[0m13:30:31.594360 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:30:31.599726 [debug] [Thread-2 (]: Timing info for model.retail_project.dim_product (execute): 13:30:31.422202 => 13:30:31.598967
[0m13:30:31.600888 [debug] [Thread-2 (]: On model.retail_project.dim_product: Close
[0m13:30:31.604609 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76955bb3-5bd4-403f-8fd6-d73334a37e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe659fffe00>]}
[0m13:30:31.605987 [info ] [Thread-2 (]: 7 of 11 OK created sql view model mart.dim_product ............................. [[32mCREATE VIEW[0m in 0.23s]
[0m13:30:31.607865 [debug] [Thread-2 (]: Finished running node model.retail_project.dim_product
[0m13:30:31.611208 [debug] [Thread-3 (]: Began running node model.retail_project.fact_sales
[0m13:30:31.613126 [info ] [Thread-3 (]: 8 of 11 START sql view model mart.fact_sales ................................... [RUN]
[0m13:30:31.615876 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_sales_transaction, now model.retail_project.fact_sales)
[0m13:30:31.616961 [debug] [Thread-3 (]: Began compiling node model.retail_project.fact_sales
[0m13:30:31.624241 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_project.fact_sales"
[0m13:30:31.626149 [debug] [Thread-3 (]: Timing info for model.retail_project.fact_sales (compile): 13:30:31.617981 => 13:30:31.625559
[0m13:30:31.626734 [debug] [Thread-3 (]: Began executing node model.retail_project.fact_sales
[0m13:30:31.636652 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_project.fact_sales"
[0m13:30:31.638262 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.fact_sales"
[0m13:30:31.638850 [debug] [Thread-3 (]: On model.retail_project.fact_sales: BEGIN
[0m13:30:31.639332 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:30:31.658917 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m13:30:31.659879 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.fact_sales"
[0m13:30:31.661038 [debug] [Thread-3 (]: On model.retail_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.fact_sales"} */

  create view "retail_dwh"."mart"."fact_sales__dbt_tmp"
    
    
  as (
    with sales as (
    select
        transaction_id,
        transaction_date,
        customer_id,
        product_id,
        store_id,
        quantity,
        unit_price,
        quantity * unit_price as gross_sales
    from "retail_dwh"."staging"."stg_sales_transaction"
),

joined as (
    select
        s.transaction_id,
        s.transaction_date,
        s.customer_id,
        s.product_id,
        s.store_id,
        s.quantity,
        s.unit_price,
        s.gross_sales,

        c.customer_name,
        p.product_name,
        -- p.category,   -- sementara DIHAPUS biar nggak error
        st.store_name,
        st.store_city,
        st.store_region
    from sales s
    left join "retail_dwh"."mart"."dim_customer" c
        on s.customer_id = c.customer_id
    left join "retail_dwh"."mart"."dim_product" p
        on s.product_id = p.product_id
    left join "retail_dwh"."mart"."dim_store" st
        on s.store_id = st.store_id
)

select * from joined
  );
[0m13:30:31.667668 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:30:31.676930 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.fact_sales"
[0m13:30:31.679334 [debug] [Thread-3 (]: On model.retail_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.fact_sales"} */
alter table "retail_dwh"."mart"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m13:30:31.682194 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:30:31.685577 [debug] [Thread-3 (]: On model.retail_project.fact_sales: COMMIT
[0m13:30:31.686383 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.fact_sales"
[0m13:30:31.689001 [debug] [Thread-3 (]: On model.retail_project.fact_sales: COMMIT
[0m13:30:31.694747 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m13:30:31.701923 [debug] [Thread-3 (]: Applying DROP to: "retail_dwh"."mart"."fact_sales__dbt_backup"
[0m13:30:31.703041 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.fact_sales"
[0m13:30:31.703569 [debug] [Thread-3 (]: On model.retail_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.fact_sales"} */
drop view if exists "retail_dwh"."mart"."fact_sales__dbt_backup" cascade
[0m13:30:31.705829 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:30:31.707871 [debug] [Thread-3 (]: Timing info for model.retail_project.fact_sales (execute): 13:30:31.627044 => 13:30:31.707598
[0m13:30:31.708391 [debug] [Thread-3 (]: On model.retail_project.fact_sales: Close
[0m13:30:31.709794 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76955bb3-5bd4-403f-8fd6-d73334a37e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe659ffcdd0>]}
[0m13:30:31.711129 [info ] [Thread-3 (]: 8 of 11 OK created sql view model mart.fact_sales .............................. [[32mCREATE VIEW[0m in 0.10s]
[0m13:30:31.716119 [debug] [Thread-3 (]: Finished running node model.retail_project.fact_sales
[0m13:30:31.722672 [debug] [Thread-4 (]: Began running node model.retail_project.customer_features
[0m13:30:31.725168 [debug] [Thread-2 (]: Began running node model.retail_project.daily_sales_kpi
[0m13:30:31.723512 [info ] [Thread-4 (]: 9 of 11 START sql table model analytics.customer_features ...................... [RUN]
[0m13:30:31.728970 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_project.dim_store, now model.retail_project.customer_features)
[0m13:30:31.731019 [debug] [Thread-4 (]: Began compiling node model.retail_project.customer_features
[0m13:30:31.738137 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_project.customer_features"
[0m13:30:31.741977 [debug] [Thread-1 (]: Began running node model.retail_project.daily_store_sales
[0m13:30:31.743404 [debug] [Thread-4 (]: Timing info for model.retail_project.customer_features (compile): 13:30:31.731822 => 13:30:31.743015
[0m13:30:31.726884 [info ] [Thread-2 (]: 10 of 11 START sql view model analytics.daily_sales_kpi ........................ [RUN]
[0m13:30:31.746914 [info ] [Thread-1 (]: 11 of 11 START sql table model analytics.daily_store_sales ..................... [RUN]
[0m13:30:31.753803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_project.dim_customer, now model.retail_project.daily_store_sales)
[0m13:30:31.751857 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_project.dim_product, now model.retail_project.daily_sales_kpi)
[0m13:30:31.757406 [debug] [Thread-2 (]: Began compiling node model.retail_project.daily_sales_kpi
[0m13:30:31.755030 [debug] [Thread-1 (]: Began compiling node model.retail_project.daily_store_sales
[0m13:30:31.749819 [debug] [Thread-4 (]: Began executing node model.retail_project.customer_features
[0m13:30:31.775003 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_project.daily_sales_kpi"
[0m13:30:31.801608 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_project.daily_store_sales"
[0m13:30:31.835858 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_project.customer_features"
[0m13:30:31.838257 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.customer_features"
[0m13:30:31.839271 [debug] [Thread-4 (]: On model.retail_project.customer_features: BEGIN
[0m13:30:31.840132 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:30:31.849183 [debug] [Thread-2 (]: Timing info for model.retail_project.daily_sales_kpi (compile): 13:30:31.758368 => 13:30:31.841520
[0m13:30:31.850128 [debug] [Thread-2 (]: Began executing node model.retail_project.daily_sales_kpi
[0m13:30:31.855959 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_project.daily_sales_kpi"
[0m13:30:31.856754 [debug] [Thread-1 (]: Timing info for model.retail_project.daily_store_sales (compile): 13:30:31.766563 => 13:30:31.856441
[0m13:30:31.857617 [debug] [Thread-1 (]: Began executing node model.retail_project.daily_store_sales
[0m13:30:31.862415 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_project.daily_store_sales"
[0m13:30:31.866458 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.daily_sales_kpi"
[0m13:30:31.868627 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m13:30:31.869975 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.daily_store_sales"
[0m13:30:31.874299 [debug] [Thread-1 (]: On model.retail_project.daily_store_sales: BEGIN
[0m13:30:31.873195 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.customer_features"
[0m13:30:31.876844 [debug] [Thread-4 (]: On model.retail_project.customer_features: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.customer_features"} */

  
    

  create  table "retail_dwh"."analytics"."customer_features__dbt_tmp"
  
  
    as
  
  (
    with base as (
    select
        customer_id,
        customer_name,
        customer_signup_date,
        current_date - customer_signup_date as customer_tenure_days
    from "retail_dwh"."mart"."dim_customer"
),

agg_sales as (
    select
        customer_id,
        count(distinct transaction_id)        as total_txn,
        sum(gross_sales)                      as total_spent,
        max(transaction_date)::date           as last_transaction_date
    from "retail_dwh"."mart"."fact_sales"
    group by customer_id
)

select
    b.customer_id,
    b.customer_name,
    b.customer_signup_date,
    b.customer_tenure_days,

    a.total_txn                                 as frequency,
    a.total_spent                               as monetary,
    a.last_transaction_date,
    current_date - a.last_transaction_date      as recency_days,
    case
        when a.total_txn > 0 then a.total_spent / a.total_txn
        else null
    end                                         as avg_order_value
from base b
left join agg_sales a
  on b.customer_id = a.customer_id
  );
  
[0m13:30:31.875752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:31.871572 [debug] [Thread-2 (]: On model.retail_project.daily_sales_kpi: BEGIN
[0m13:30:31.879896 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:30:31.891357 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:30:31.892134 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.daily_store_sales"
[0m13:30:31.892866 [debug] [Thread-1 (]: On model.retail_project.daily_store_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.daily_store_sales"} */

  
    

  create  table "retail_dwh"."analytics"."daily_store_sales__dbt_tmp"
  
  
    as
  
  (
    with base as (
    select
        transaction_date::date    as date,
        store_id,
        store_name,
        store_city,
        sum(gross_sales)          as total_sales,
        sum(quantity)             as total_qty
    from "retail_dwh"."mart"."fact_sales"
    group by 1,2,3,4
)

select
    *,
    rank() over (partition by date order by total_sales desc) as sales_rank_in_day
from base
order by date, sales_rank_in_day
  );
  
[0m13:30:32.211075 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m13:30:32.212364 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.daily_sales_kpi"
[0m13:30:32.213233 [debug] [Thread-2 (]: On model.retail_project.daily_sales_kpi: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.daily_sales_kpi"} */

  create view "retail_dwh"."analytics"."daily_sales_kpi__dbt_tmp"
    
    
  as (
    select
    transaction_date::date                            as date,
    sum(gross_sales)                                  as total_sales,
    sum(quantity)                                     as total_qty,
    count(distinct customer_id)                       as unique_customers,
    case
        when sum(quantity) > 0 then sum(gross_sales) / sum(quantity)
        else null
    end                                               as avg_price_per_unit,
    case
        when count(distinct transaction_id) > 0
            then sum(gross_sales) / count(distinct transaction_id)
        else null
    end                                               as avg_order_value
from "retail_dwh"."mart"."fact_sales"
group by 1
order by 1
  );
[0m13:30:32.217478 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:30:32.224562 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.daily_sales_kpi"
[0m13:30:32.225393 [debug] [Thread-2 (]: On model.retail_project.daily_sales_kpi: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.daily_sales_kpi"} */
alter table "retail_dwh"."analytics"."daily_sales_kpi__dbt_tmp" rename to "daily_sales_kpi"
[0m13:30:32.226740 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:30:32.231079 [debug] [Thread-2 (]: On model.retail_project.daily_sales_kpi: COMMIT
[0m13:30:32.232073 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.daily_sales_kpi"
[0m13:30:32.232946 [debug] [Thread-2 (]: On model.retail_project.daily_sales_kpi: COMMIT
[0m13:30:32.258848 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m13:30:32.264217 [debug] [Thread-2 (]: Applying DROP to: "retail_dwh"."analytics"."daily_sales_kpi__dbt_backup"
[0m13:30:32.265802 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.daily_sales_kpi"
[0m13:30:32.266651 [debug] [Thread-2 (]: On model.retail_project.daily_sales_kpi: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.daily_sales_kpi"} */
drop view if exists "retail_dwh"."analytics"."daily_sales_kpi__dbt_backup" cascade
[0m13:30:32.267808 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:30:32.270880 [debug] [Thread-2 (]: Timing info for model.retail_project.daily_sales_kpi (execute): 13:30:31.850527 => 13:30:32.270448
[0m13:30:32.278440 [debug] [Thread-2 (]: On model.retail_project.daily_sales_kpi: Close
[0m13:30:32.280178 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76955bb3-5bd4-403f-8fd6-d73334a37e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe659b3c6b0>]}
[0m13:30:32.281312 [info ] [Thread-2 (]: 10 of 11 OK created sql view model analytics.daily_sales_kpi ................... [[32mCREATE VIEW[0m in 0.53s]
[0m13:30:32.286662 [debug] [Thread-2 (]: Finished running node model.retail_project.daily_sales_kpi
[0m13:30:33.269169 [debug] [Thread-1 (]: SQL status: SELECT 99876 in 1.0 seconds
[0m13:30:33.274100 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.daily_store_sales"
[0m13:30:33.274660 [debug] [Thread-1 (]: On model.retail_project.daily_store_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.daily_store_sales"} */
alter table "retail_dwh"."analytics"."daily_store_sales" rename to "daily_store_sales__dbt_backup"
[0m13:30:33.276008 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:30:33.281129 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.daily_store_sales"
[0m13:30:33.281686 [debug] [Thread-1 (]: On model.retail_project.daily_store_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.daily_store_sales"} */
alter table "retail_dwh"."analytics"."daily_store_sales__dbt_tmp" rename to "daily_store_sales"
[0m13:30:33.284731 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:30:33.295319 [debug] [Thread-1 (]: On model.retail_project.daily_store_sales: COMMIT
[0m13:30:33.296204 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.daily_store_sales"
[0m13:30:33.296961 [debug] [Thread-1 (]: On model.retail_project.daily_store_sales: COMMIT
[0m13:30:33.352244 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:30:33.355668 [debug] [Thread-1 (]: Applying DROP to: "retail_dwh"."analytics"."daily_store_sales__dbt_backup"
[0m13:30:33.363291 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.daily_store_sales"
[0m13:30:33.364161 [debug] [Thread-1 (]: On model.retail_project.daily_store_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.daily_store_sales"} */
drop table if exists "retail_dwh"."analytics"."daily_store_sales__dbt_backup" cascade
[0m13:30:33.382524 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:30:33.384596 [debug] [Thread-1 (]: Timing info for model.retail_project.daily_store_sales (execute): 13:30:31.858064 => 13:30:33.384333
[0m13:30:33.385067 [debug] [Thread-1 (]: On model.retail_project.daily_store_sales: Close
[0m13:30:33.386428 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76955bb3-5bd4-403f-8fd6-d73334a37e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe65a709460>]}
[0m13:30:33.387493 [info ] [Thread-1 (]: 11 of 11 OK created sql table model analytics.daily_store_sales ................ [[32mSELECT 99876[0m in 1.63s]
[0m13:30:33.388948 [debug] [Thread-1 (]: Finished running node model.retail_project.daily_store_sales
[0m13:30:33.402894 [debug] [Thread-4 (]: SQL status: SELECT 100000 in 2.0 seconds
[0m13:30:33.408136 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.customer_features"
[0m13:30:33.409006 [debug] [Thread-4 (]: On model.retail_project.customer_features: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.customer_features"} */
alter table "retail_dwh"."analytics"."customer_features" rename to "customer_features__dbt_backup"
[0m13:30:33.411005 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:30:33.417007 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.customer_features"
[0m13:30:33.417587 [debug] [Thread-4 (]: On model.retail_project.customer_features: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.customer_features"} */
alter table "retail_dwh"."analytics"."customer_features__dbt_tmp" rename to "customer_features"
[0m13:30:33.419977 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:30:33.423093 [debug] [Thread-4 (]: On model.retail_project.customer_features: COMMIT
[0m13:30:33.423715 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.customer_features"
[0m13:30:33.424160 [debug] [Thread-4 (]: On model.retail_project.customer_features: COMMIT
[0m13:30:33.453498 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m13:30:33.458274 [debug] [Thread-4 (]: Applying DROP to: "retail_dwh"."analytics"."customer_features__dbt_backup"
[0m13:30:33.459226 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.customer_features"
[0m13:30:33.459677 [debug] [Thread-4 (]: On model.retail_project.customer_features: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.customer_features"} */
drop table if exists "retail_dwh"."analytics"."customer_features__dbt_backup" cascade
[0m13:30:33.473210 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:30:33.476263 [debug] [Thread-4 (]: Timing info for model.retail_project.customer_features (execute): 13:30:31.776134 => 13:30:33.475988
[0m13:30:33.477187 [debug] [Thread-4 (]: On model.retail_project.customer_features: Close
[0m13:30:33.478901 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76955bb3-5bd4-403f-8fd6-d73334a37e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe659b952b0>]}
[0m13:30:33.480033 [info ] [Thread-4 (]: 9 of 11 OK created sql table model analytics.customer_features ................. [[32mSELECT 100000[0m in 1.75s]
[0m13:30:33.483142 [debug] [Thread-4 (]: Finished running node model.retail_project.customer_features
[0m13:30:33.489748 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:33.490803 [debug] [MainThread]: On master: BEGIN
[0m13:30:33.491206 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:30:33.506662 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:30:33.507242 [debug] [MainThread]: On master: COMMIT
[0m13:30:33.507994 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:33.508381 [debug] [MainThread]: On master: COMMIT
[0m13:30:33.509870 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:30:33.510609 [debug] [MainThread]: On master: Close
[0m13:30:33.512395 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:30:33.513110 [debug] [MainThread]: Connection 'model.retail_project.fact_sales' was properly closed.
[0m13:30:33.513792 [debug] [MainThread]: Connection 'model.retail_project.daily_sales_kpi' was properly closed.
[0m13:30:33.515248 [debug] [MainThread]: Connection 'model.retail_project.daily_store_sales' was properly closed.
[0m13:30:33.516155 [debug] [MainThread]: Connection 'model.retail_project.customer_features' was properly closed.
[0m13:30:33.516702 [info ] [MainThread]: 
[0m13:30:33.519787 [info ] [MainThread]: Finished running 9 view models, 2 table models in 0 hours 0 minutes and 3.02 seconds (3.02s).
[0m13:30:33.524325 [debug] [MainThread]: Command end result
[0m13:30:33.540977 [info ] [MainThread]: 
[0m13:30:33.543902 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:30:33.546475 [info ] [MainThread]: 
[0m13:30:33.548035 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m13:30:33.550235 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.7633135, "process_user_time": 3.843787, "process_kernel_time": 0.87466, "process_mem_max_rss": "136164", "process_out_blocks": "2808", "process_in_blocks": "0"}
[0m13:30:33.551916 [debug] [MainThread]: Command `dbt run` succeeded at 13:30:33.551375 after 3.77 seconds
[0m13:30:33.552980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe65bae9e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe65b971d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe65b77e690>]}
[0m13:30:33.553824 [debug] [MainThread]: Flushing usage events
[0m13:31:51.358072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16e4b35a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16e4b36360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16e4b35ac0>]}


============================== 13:31:51.361479 | a3352bfc-54b1-44c9-b690-2f542ec3c16d ==============================
[0m13:31:51.361479 [info ] [MainThread]: Running with dbt=1.7.0
[0m13:31:51.372664 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/opt/dbt/retail_project/retail_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps --profiles-dir /root/.dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:31:51.488456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3352bfc-54b1-44c9-b690-2f542ec3c16d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16e4b35f40>]}
[0m13:31:51.489231 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:31:51.497399 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:31:51.502537 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.2037887, "process_user_time": 2.62744, "process_kernel_time": 0.329665, "process_mem_max_rss": "151568", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m13:31:51.503075 [debug] [MainThread]: Command `dbt deps` succeeded at 13:31:51.502942 after 0.20 seconds
[0m13:31:51.503437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16e4d7fa40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16e4bff0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16e9a32810>]}
[0m13:31:51.503794 [debug] [MainThread]: Flushing usage events
[0m13:31:58.182409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dc40ca1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dc40c8470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dc40c87a0>]}


============================== 13:31:58.197976 | 63e7c36b-5c88-450e-b149-667c3853a17b ==============================
[0m13:31:58.197976 [info ] [MainThread]: Running with dbt=1.7.0
[0m13:31:58.199401 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/dbt/retail_project/retail_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /root/.dbt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:31:58.443973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63e7c36b-5c88-450e-b149-667c3853a17b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dc3fb2600>]}
[0m13:31:58.575833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63e7c36b-5c88-450e-b149-667c3853a17b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dc3f73770>]}
[0m13:31:58.576709 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m13:31:58.597646 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m13:31:58.645683 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:31:58.646435 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:31:58.647346 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail_project.intermediate
[0m13:31:58.654399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63e7c36b-5c88-450e-b149-667c3853a17b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dc3348710>]}
[0m13:31:58.676044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63e7c36b-5c88-450e-b149-667c3853a17b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dc3384dd0>]}
[0m13:31:58.678382 [info ] [MainThread]: Found 11 models, 4 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m13:31:58.679202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63e7c36b-5c88-450e-b149-667c3853a17b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dc5a3ca10>]}
[0m13:31:58.681790 [info ] [MainThread]: 
[0m13:31:58.683546 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:31:58.687388 [debug] [ThreadPool]: Acquiring new postgres connection 'list_retail_dwh'
[0m13:31:58.700153 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh"
[0m13:31:58.702194 [debug] [ThreadPool]: On list_retail_dwh: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh"} */

    select distinct nspname from pg_namespace
  
[0m13:31:58.703077 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:31:58.707975 [debug] [ThreadPool]: Acquiring new postgres connection 'list_retail_dwh'
[0m13:31:58.710654 [debug] [ThreadPool]: Acquiring new postgres connection 'list_retail_dwh'
[0m13:31:58.714503 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh"
[0m13:31:58.718401 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh"
[0m13:31:58.719507 [debug] [ThreadPool]: On list_retail_dwh: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh"} */

    select distinct nspname from pg_namespace
  
[0m13:31:58.721675 [debug] [ThreadPool]: On list_retail_dwh: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh"} */

    select distinct nspname from pg_namespace
  
[0m13:31:58.723332 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:31:58.724919 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m13:31:58.726332 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:31:58.730009 [debug] [ThreadPool]: On list_retail_dwh: Close
[0m13:31:58.750731 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m13:31:58.751924 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m13:31:58.754699 [debug] [ThreadPool]: On list_retail_dwh: Close
[0m13:31:58.757499 [debug] [ThreadPool]: On list_retail_dwh: Close
[0m13:31:58.767100 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_dwh, now list_retail_dwh_staging)
[0m13:31:58.780185 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_staging"
[0m13:31:58.781858 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_dwh, now list_retail_dwh_analytics)
[0m13:31:58.782758 [debug] [ThreadPool]: On list_retail_dwh_staging: BEGIN
[0m13:31:58.784350 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_retail_dwh, now list_retail_dwh_mart)
[0m13:31:58.788043 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_analytics"
[0m13:31:58.791418 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:31:58.794523 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_mart"
[0m13:31:58.795952 [debug] [ThreadPool]: On list_retail_dwh_analytics: BEGIN
[0m13:31:58.797765 [debug] [ThreadPool]: On list_retail_dwh_mart: BEGIN
[0m13:31:58.798860 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:31:58.799803 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:31:58.814063 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:31:58.815336 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_analytics"
[0m13:31:58.815707 [debug] [ThreadPool]: On list_retail_dwh_analytics: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh_analytics"} */
select
      'retail_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'retail_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'retail_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m13:31:58.816498 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:31:58.817628 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_staging"
[0m13:31:58.818673 [debug] [ThreadPool]: On list_retail_dwh_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh_staging"} */
select
      'retail_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'retail_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'retail_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m13:31:58.824715 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:31:58.825772 [debug] [ThreadPool]: Using postgres connection "list_retail_dwh_mart"
[0m13:31:58.826220 [debug] [ThreadPool]: On list_retail_dwh_mart: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "list_retail_dwh_mart"} */
select
      'retail_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'retail_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
    union all
    select
      'retail_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'mart'
  
[0m13:31:58.827109 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m13:31:58.830069 [debug] [ThreadPool]: On list_retail_dwh_analytics: ROLLBACK
[0m13:31:58.832089 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:31:58.836579 [debug] [ThreadPool]: On list_retail_dwh_staging: ROLLBACK
[0m13:31:58.838739 [debug] [ThreadPool]: On list_retail_dwh_analytics: Close
[0m13:31:58.840113 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:31:58.846149 [debug] [ThreadPool]: On list_retail_dwh_staging: Close
[0m13:31:58.848980 [debug] [ThreadPool]: On list_retail_dwh_mart: ROLLBACK
[0m13:31:58.856891 [debug] [ThreadPool]: On list_retail_dwh_mart: Close
[0m13:31:58.869842 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:58.871254 [debug] [MainThread]: On master: BEGIN
[0m13:31:58.871602 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:31:58.888903 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:31:58.889605 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:58.890448 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:31:58.930683 [debug] [MainThread]: SQL status: SELECT 12 in 0.0 seconds
[0m13:31:58.938844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63e7c36b-5c88-450e-b149-667c3853a17b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dc2fd7290>]}
[0m13:31:58.939443 [debug] [MainThread]: On master: ROLLBACK
[0m13:31:58.941556 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:58.942067 [debug] [MainThread]: On master: BEGIN
[0m13:31:58.944172 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:31:58.944629 [debug] [MainThread]: On master: COMMIT
[0m13:31:58.944923 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:58.945277 [debug] [MainThread]: On master: COMMIT
[0m13:31:58.946701 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:31:58.947193 [debug] [MainThread]: On master: Close
[0m13:31:58.948581 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:31:58.949810 [info ] [MainThread]: 
[0m13:31:58.960311 [debug] [Thread-1 (]: Began running node model.retail_project.stg_customers
[0m13:31:58.961890 [debug] [Thread-2 (]: Began running node model.retail_project.stg_products
[0m13:31:58.962771 [info ] [Thread-1 (]: 1 of 11 START sql view model staging.stg_customers ............................. [RUN]
[0m13:31:58.964478 [debug] [Thread-3 (]: Began running node model.retail_project.stg_sales_transaction
[0m13:31:58.965818 [debug] [Thread-4 (]: Began running node model.retail_project.stg_stores
[0m13:31:58.966630 [info ] [Thread-2 (]: 2 of 11 START sql view model staging.stg_products .............................. [RUN]
[0m13:31:58.968214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_retail_dwh_mart, now model.retail_project.stg_customers)
[0m13:31:58.969612 [info ] [Thread-3 (]: 3 of 11 START sql view model staging.stg_sales_transaction ..................... [RUN]
[0m13:31:58.971276 [info ] [Thread-4 (]: 4 of 11 START sql view model staging.stg_stores ................................ [RUN]
[0m13:31:58.973841 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_retail_dwh_staging, now model.retail_project.stg_products)
[0m13:31:58.975326 [debug] [Thread-1 (]: Began compiling node model.retail_project.stg_customers
[0m13:31:58.976942 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_retail_dwh_analytics, now model.retail_project.stg_sales_transaction)
[0m13:31:58.978400 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.retail_project.stg_stores'
[0m13:31:58.979463 [debug] [Thread-2 (]: Began compiling node model.retail_project.stg_products
[0m13:31:58.986743 [debug] [Thread-3 (]: Began compiling node model.retail_project.stg_sales_transaction
[0m13:31:58.990882 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_project.stg_customers"
[0m13:31:59.002746 [debug] [Thread-1 (]: Timing info for model.retail_project.stg_customers (compile): 13:31:58.980115 => 13:31:59.002420
[0m13:31:58.996899 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_project.stg_products"
[0m13:31:59.001368 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_project.stg_sales_transaction"
[0m13:31:58.992801 [debug] [Thread-4 (]: Began compiling node model.retail_project.stg_stores
[0m13:31:59.005365 [debug] [Thread-1 (]: Began executing node model.retail_project.stg_customers
[0m13:31:59.009380 [debug] [Thread-2 (]: Timing info for model.retail_project.stg_products (compile): 13:31:58.993453 => 13:31:59.008978
[0m13:31:59.010536 [debug] [Thread-3 (]: Timing info for model.retail_project.stg_sales_transaction (compile): 13:31:58.997970 => 13:31:59.010282
[0m13:31:59.055485 [debug] [Thread-3 (]: Began executing node model.retail_project.stg_sales_transaction
[0m13:31:59.042282 [debug] [Thread-2 (]: Began executing node model.retail_project.stg_products
[0m13:31:59.014011 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_project.stg_stores"
[0m13:31:59.108149 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_project.stg_sales_transaction"
[0m13:31:59.109250 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_project.stg_customers"
[0m13:31:59.114112 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_project.stg_products"
[0m13:31:59.115969 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m13:31:59.118340 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: BEGIN
[0m13:31:59.121041 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:31:59.121961 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m13:31:59.124842 [debug] [Thread-1 (]: On model.retail_project.stg_customers: BEGIN
[0m13:31:59.125945 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:31:59.128200 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m13:31:59.130167 [debug] [Thread-2 (]: On model.retail_project.stg_products: BEGIN
[0m13:31:59.130723 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:31:59.129507 [debug] [Thread-4 (]: Timing info for model.retail_project.stg_stores (compile): 13:31:59.010921 => 13:31:59.128911
[0m13:31:59.132010 [debug] [Thread-4 (]: Began executing node model.retail_project.stg_stores
[0m13:31:59.221950 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m13:31:59.225194 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m13:31:59.227183 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */

  create view "retail_dwh"."staging"."stg_sales_transaction__dbt_tmp"
    
    
  as (
    with source as (
    select
        transaction_id,
        transaction_date,
        customer_id,
        product_id,
        store_id,
        quantity,
        total_price
    from "retail_dwh"."raw"."sales_transaction_raw"
),

typed as (
    select
        transaction_id,
        customer_id,
        product_id,
        store_id,
        transaction_date::date        as transaction_date,
        quantity::integer             as quantity,
        total_price::numeric(18,2)    as total_price,
        case
            when quantity::numeric <> 0
                then total_price::numeric(18,2) / quantity::numeric
            else null
        end                           as unit_price
    from source
)

select * from typed
  );
[0m13:31:59.229935 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_project.stg_stores"
[0m13:31:59.232090 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:31:59.233703 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m13:31:59.235639 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */

  create view "retail_dwh"."staging"."stg_customers__dbt_tmp"
    
    
  as (
    SELECT
    customer_id,
    customer_name,
    UPPER(TRIM(gender)) AS customer_gender,
    TRIM(city) AS customer_city,
    CAST(signup_date AS DATE) AS customer_signup_date
FROM
    "retail_dwh"."raw"."customers_raw"
  );
[0m13:31:59.236906 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:31:59.245320 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m13:31:59.247700 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m13:31:59.250009 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */
alter table "retail_dwh"."staging"."stg_sales_transaction" rename to "stg_sales_transaction__dbt_backup"
[0m13:31:59.250960 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:31:59.252633 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m13:31:59.253365 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m13:31:59.259423 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m13:31:59.261287 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */

  create view "retail_dwh"."staging"."stg_products__dbt_tmp"
    
    
  as (
    SELECT
    product_id,
    product_name,
    TRIM(category) AS product_category,
    TRIM(sub_category) AS product_sub_category,
    CAST(price AS NUMERIC) AS product_price
FROM
    "retail_dwh"."raw"."products_raw"
  );
[0m13:31:59.262982 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:31:59.264141 [debug] [Thread-4 (]: On model.retail_project.stg_stores: BEGIN
[0m13:31:59.265021 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
alter table "retail_dwh"."staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m13:31:59.270609 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m13:31:59.271667 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:31:59.274787 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:31:59.276536 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */
alter table "retail_dwh"."staging"."stg_sales_transaction__dbt_tmp" rename to "stg_sales_transaction"
[0m13:31:59.277854 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:31:59.284187 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m13:31:59.293225 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m13:31:59.294967 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:31:59.296978 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
alter table "retail_dwh"."staging"."stg_products" rename to "stg_products__dbt_backup"
[0m13:31:59.297845 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m13:31:59.298998 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
alter table "retail_dwh"."staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m13:31:59.322743 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: COMMIT
[0m13:31:59.328968 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:31:59.326854 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m13:31:59.330030 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m13:31:59.334910 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m13:31:59.335793 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:31:59.337042 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */

  create view "retail_dwh"."staging"."stg_stores__dbt_tmp"
    
    
  as (
    with source as (
    select
        store_id,
        store_name,
        city,
        region
    from "retail_dwh"."raw"."stores_raw"
),

renamed as (
    select
        store_id,
        store_name,
        city,
        region as store_region
    from source
)

select * from renamed
  );
[0m13:31:59.338154 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: COMMIT
[0m13:31:59.339427 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
alter table "retail_dwh"."staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:31:59.343068 [debug] [Thread-1 (]: On model.retail_project.stg_customers: COMMIT
[0m13:31:59.347301 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:31:59.348775 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:31:59.349971 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m13:31:59.350897 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m13:31:59.353781 [debug] [Thread-2 (]: On model.retail_project.stg_products: COMMIT
[0m13:31:59.358416 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m13:31:59.359815 [debug] [Thread-1 (]: On model.retail_project.stg_customers: COMMIT
[0m13:31:59.368029 [debug] [Thread-3 (]: Applying DROP to: "retail_dwh"."staging"."stg_sales_transaction__dbt_backup"
[0m13:31:59.370678 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m13:31:59.372518 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
alter table "retail_dwh"."staging"."stg_stores" rename to "stg_stores__dbt_backup"
[0m13:31:59.382772 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:31:59.389006 [debug] [Thread-2 (]: On model.retail_project.stg_products: COMMIT
[0m13:31:59.387668 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.stg_sales_transaction"
[0m13:31:59.398946 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:31:59.401597 [debug] [Thread-1 (]: Applying DROP to: "retail_dwh"."staging"."stg_customers__dbt_backup"
[0m13:31:59.403010 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_sales_transaction"} */
drop view if exists "retail_dwh"."staging"."stg_sales_transaction__dbt_backup" cascade
[0m13:31:59.413011 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m13:31:59.414124 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m13:31:59.418439 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.stg_customers"
[0m13:31:59.432021 [debug] [Thread-1 (]: On model.retail_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_customers"} */
drop view if exists "retail_dwh"."staging"."stg_customers__dbt_backup" cascade
[0m13:31:59.429497 [debug] [Thread-2 (]: Applying DROP to: "retail_dwh"."staging"."stg_products__dbt_backup"
[0m13:31:59.430774 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
alter table "retail_dwh"."staging"."stg_stores__dbt_tmp" rename to "stg_stores"
[0m13:31:59.427619 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:31:59.436016 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.stg_products"
[0m13:31:59.437964 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:31:59.442959 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:31:59.442207 [debug] [Thread-3 (]: Timing info for model.retail_project.stg_sales_transaction (execute): 13:31:59.056729 => 13:31:59.441681
[0m13:31:59.449935 [debug] [Thread-3 (]: On model.retail_project.stg_sales_transaction: Close
[0m13:31:59.446622 [debug] [Thread-4 (]: On model.retail_project.stg_stores: COMMIT
[0m13:31:59.449492 [debug] [Thread-1 (]: Timing info for model.retail_project.stg_customers (execute): 13:31:59.014723 => 13:31:59.449248
[0m13:31:59.443721 [debug] [Thread-2 (]: On model.retail_project.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_products"} */
drop view if exists "retail_dwh"."staging"."stg_products__dbt_backup" cascade
[0m13:31:59.451011 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m13:31:59.453177 [debug] [Thread-1 (]: On model.retail_project.stg_customers: Close
[0m13:31:59.452459 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63e7c36b-5c88-450e-b149-667c3853a17b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dc2bd95b0>]}
[0m13:31:59.455687 [debug] [Thread-4 (]: On model.retail_project.stg_stores: COMMIT
[0m13:31:59.458265 [info ] [Thread-3 (]: 3 of 11 OK created sql view model staging.stg_sales_transaction ................ [[32mCREATE VIEW[0m in 0.48s]
[0m13:31:59.461623 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63e7c36b-5c88-450e-b149-667c3853a17b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dc2bc55e0>]}
[0m13:31:59.463121 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:31:59.465813 [debug] [Thread-3 (]: Finished running node model.retail_project.stg_sales_transaction
[0m13:31:59.467935 [info ] [Thread-1 (]: 1 of 11 OK created sql view model staging.stg_customers ........................ [[32mCREATE VIEW[0m in 0.49s]
[0m13:31:59.471950 [debug] [Thread-2 (]: Timing info for model.retail_project.stg_products (execute): 13:31:59.064845 => 13:31:59.471706
[0m13:31:59.473787 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m13:31:59.475427 [debug] [Thread-1 (]: Finished running node model.retail_project.stg_customers
[0m13:31:59.476774 [debug] [Thread-2 (]: On model.retail_project.stg_products: Close
[0m13:31:59.480566 [debug] [Thread-4 (]: Applying DROP to: "retail_dwh"."staging"."stg_stores__dbt_backup"
[0m13:31:59.484438 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63e7c36b-5c88-450e-b149-667c3853a17b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dc2bd9ee0>]}
[0m13:31:59.486055 [debug] [Thread-3 (]: Began running node model.retail_project.dim_customer
[0m13:31:59.488503 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.stg_stores"
[0m13:31:59.494203 [info ] [Thread-2 (]: 2 of 11 OK created sql view model staging.stg_products ......................... [[32mCREATE VIEW[0m in 0.51s]
[0m13:31:59.497009 [debug] [Thread-4 (]: On model.retail_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.stg_stores"} */
drop view if exists "retail_dwh"."staging"."stg_stores__dbt_backup" cascade
[0m13:31:59.495883 [info ] [Thread-3 (]: 5 of 11 START sql view model mart.dim_customer ................................. [RUN]
[0m13:31:59.499016 [debug] [Thread-2 (]: Finished running node model.retail_project.stg_products
[0m13:31:59.501341 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_sales_transaction, now model.retail_project.dim_customer)
[0m13:31:59.505089 [debug] [Thread-3 (]: Began compiling node model.retail_project.dim_customer
[0m13:31:59.510347 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_project.dim_customer"
[0m13:31:59.511756 [debug] [Thread-1 (]: Began running node model.retail_project.dim_product
[0m13:31:59.513347 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:31:59.515064 [info ] [Thread-1 (]: 6 of 11 START sql view model mart.dim_product .................................. [RUN]
[0m13:31:59.518270 [debug] [Thread-4 (]: Timing info for model.retail_project.stg_stores (execute): 13:31:59.132591 => 13:31:59.517947
[0m13:31:59.522158 [debug] [Thread-4 (]: On model.retail_project.stg_stores: Close
[0m13:31:59.521288 [debug] [Thread-3 (]: Timing info for model.retail_project.dim_customer (compile): 13:31:59.506192 => 13:31:59.520734
[0m13:31:59.520175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_customers, now model.retail_project.dim_product)
[0m13:31:59.524250 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63e7c36b-5c88-450e-b149-667c3853a17b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dc2fef440>]}
[0m13:31:59.525955 [debug] [Thread-3 (]: Began executing node model.retail_project.dim_customer
[0m13:31:59.526914 [debug] [Thread-1 (]: Began compiling node model.retail_project.dim_product
[0m13:31:59.528284 [info ] [Thread-4 (]: 4 of 11 OK created sql view model staging.stg_stores ........................... [[32mCREATE VIEW[0m in 0.55s]
[0m13:31:59.534869 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_project.dim_customer"
[0m13:31:59.539273 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_project.dim_product"
[0m13:31:59.542485 [debug] [Thread-4 (]: Finished running node model.retail_project.stg_stores
[0m13:31:59.546275 [debug] [Thread-1 (]: Timing info for model.retail_project.dim_product (compile): 13:31:59.535845 => 13:31:59.545801
[0m13:31:59.547120 [debug] [Thread-1 (]: Began executing node model.retail_project.dim_product
[0m13:31:59.553044 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_project.dim_product"
[0m13:31:59.555048 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_customer"
[0m13:31:59.557910 [debug] [Thread-3 (]: On model.retail_project.dim_customer: BEGIN
[0m13:31:59.558893 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:31:59.562035 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_product"
[0m13:31:59.563112 [debug] [Thread-1 (]: On model.retail_project.dim_product: BEGIN
[0m13:31:59.564215 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:31:59.565418 [debug] [Thread-2 (]: Began running node model.retail_project.dim_store
[0m13:31:59.566043 [info ] [Thread-2 (]: 7 of 11 START sql view model mart.dim_store .................................... [RUN]
[0m13:31:59.567611 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_products, now model.retail_project.dim_store)
[0m13:31:59.568058 [debug] [Thread-2 (]: Began compiling node model.retail_project.dim_store
[0m13:31:59.571567 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_project.dim_store"
[0m13:31:59.574287 [debug] [Thread-2 (]: Timing info for model.retail_project.dim_store (compile): 13:31:59.568292 => 13:31:59.572761
[0m13:31:59.575611 [debug] [Thread-2 (]: Began executing node model.retail_project.dim_store
[0m13:31:59.582028 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_project.dim_store"
[0m13:31:59.586550 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_store"
[0m13:31:59.588103 [debug] [Thread-2 (]: On model.retail_project.dim_store: BEGIN
[0m13:31:59.589463 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:31:59.592159 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:31:59.593464 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_product"
[0m13:31:59.595178 [debug] [Thread-1 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */

  create view "retail_dwh"."mart"."dim_product__dbt_tmp"
    
    
  as (
    select
    product_id,
    product_name,
    product_category      as category,
    product_sub_category  as sub_category,
    product_price         as price
from "retail_dwh"."staging"."stg_products"
  );
[0m13:31:59.596177 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m13:31:59.596885 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_customer"
[0m13:31:59.597548 [debug] [Thread-3 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */

  create view "retail_dwh"."mart"."dim_customer__dbt_tmp"
    
    
  as (
    SELECT
    customer_id,
    customer_name,
    customer_gender,
    customer_city,
    customer_signup_date
FROM
    "retail_dwh"."staging"."stg_customers"
  );
[0m13:31:59.598796 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:31:59.604614 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_product"
[0m13:31:59.606764 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:31:59.608904 [debug] [Thread-1 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */
alter table "retail_dwh"."mart"."dim_product__dbt_tmp" rename to "dim_product"
[0m13:31:59.614719 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_customer"
[0m13:31:59.616326 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m13:31:59.618205 [debug] [Thread-3 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */
alter table "retail_dwh"."mart"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m13:31:59.619055 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:31:59.620291 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_store"
[0m13:31:59.624640 [debug] [Thread-1 (]: On model.retail_project.dim_product: COMMIT
[0m13:31:59.628652 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_product"
[0m13:31:59.627253 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:31:59.629825 [debug] [Thread-1 (]: On model.retail_project.dim_product: COMMIT
[0m13:31:59.626233 [debug] [Thread-2 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */

  create view "retail_dwh"."mart"."dim_store__dbt_tmp"
    
    
  as (
    select
    store_id,
    store_name,
    city as store_city,
    store_region
from "retail_dwh"."staging"."stg_stores"
  );
[0m13:31:59.632921 [debug] [Thread-3 (]: On model.retail_project.dim_customer: COMMIT
[0m13:31:59.634825 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_customer"
[0m13:31:59.636450 [debug] [Thread-3 (]: On model.retail_project.dim_customer: COMMIT
[0m13:31:59.637707 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:31:59.644045 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_store"
[0m13:31:59.645135 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:31:59.647087 [debug] [Thread-2 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */
alter table "retail_dwh"."mart"."dim_store__dbt_tmp" rename to "dim_store"
[0m13:31:59.648161 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m13:31:59.652870 [debug] [Thread-1 (]: Applying DROP to: "retail_dwh"."mart"."dim_product__dbt_backup"
[0m13:31:59.658483 [debug] [Thread-3 (]: Applying DROP to: "retail_dwh"."mart"."dim_customer__dbt_backup"
[0m13:31:59.660814 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.dim_product"
[0m13:31:59.662205 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:31:59.663715 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.dim_customer"
[0m13:31:59.665393 [debug] [Thread-1 (]: On model.retail_project.dim_product: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_product"} */
drop view if exists "retail_dwh"."mart"."dim_product__dbt_backup" cascade
[0m13:31:59.668555 [debug] [Thread-2 (]: On model.retail_project.dim_store: COMMIT
[0m13:31:59.669942 [debug] [Thread-3 (]: On model.retail_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_customer"} */
drop view if exists "retail_dwh"."mart"."dim_customer__dbt_backup" cascade
[0m13:31:59.671486 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_store"
[0m13:31:59.673184 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:31:59.675713 [debug] [Thread-2 (]: On model.retail_project.dim_store: COMMIT
[0m13:31:59.678808 [debug] [Thread-1 (]: Timing info for model.retail_project.dim_product (execute): 13:31:59.547469 => 13:31:59.678555
[0m13:31:59.680088 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:31:59.681825 [debug] [Thread-1 (]: On model.retail_project.dim_product: Close
[0m13:31:59.685663 [debug] [Thread-3 (]: Timing info for model.retail_project.dim_customer (execute): 13:31:59.529309 => 13:31:59.685421
[0m13:31:59.687203 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m13:31:59.688833 [debug] [Thread-3 (]: On model.retail_project.dim_customer: Close
[0m13:31:59.694935 [debug] [Thread-2 (]: Applying DROP to: "retail_dwh"."mart"."dim_store__dbt_backup"
[0m13:31:59.696143 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63e7c36b-5c88-450e-b149-667c3853a17b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dc2715040>]}
[0m13:31:59.698109 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63e7c36b-5c88-450e-b149-667c3853a17b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dc27143e0>]}
[0m13:31:59.700621 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.dim_store"
[0m13:31:59.702475 [info ] [Thread-1 (]: 6 of 11 OK created sql view model mart.dim_product ............................. [[32mCREATE VIEW[0m in 0.18s]
[0m13:31:59.704227 [info ] [Thread-3 (]: 5 of 11 OK created sql view model mart.dim_customer ............................ [[32mCREATE VIEW[0m in 0.20s]
[0m13:31:59.705333 [debug] [Thread-2 (]: On model.retail_project.dim_store: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.dim_store"} */
drop view if exists "retail_dwh"."mart"."dim_store__dbt_backup" cascade
[0m13:31:59.707478 [debug] [Thread-1 (]: Finished running node model.retail_project.dim_product
[0m13:31:59.709035 [debug] [Thread-3 (]: Finished running node model.retail_project.dim_customer
[0m13:31:59.710588 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:31:59.713416 [debug] [Thread-2 (]: Timing info for model.retail_project.dim_store (execute): 13:31:59.576764 => 13:31:59.713184
[0m13:31:59.714052 [debug] [Thread-2 (]: On model.retail_project.dim_store: Close
[0m13:31:59.715277 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63e7c36b-5c88-450e-b149-667c3853a17b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dc2707950>]}
[0m13:31:59.716189 [info ] [Thread-2 (]: 7 of 11 OK created sql view model mart.dim_store ............................... [[32mCREATE VIEW[0m in 0.15s]
[0m13:31:59.717997 [debug] [Thread-2 (]: Finished running node model.retail_project.dim_store
[0m13:31:59.721287 [debug] [Thread-4 (]: Began running node model.retail_project.fact_sales
[0m13:31:59.721838 [info ] [Thread-4 (]: 8 of 11 START sql view model mart.fact_sales ................................... [RUN]
[0m13:31:59.722843 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_project.stg_stores, now model.retail_project.fact_sales)
[0m13:31:59.723483 [debug] [Thread-4 (]: Began compiling node model.retail_project.fact_sales
[0m13:31:59.727260 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_project.fact_sales"
[0m13:31:59.730105 [debug] [Thread-4 (]: Timing info for model.retail_project.fact_sales (compile): 13:31:59.723903 => 13:31:59.727992
[0m13:31:59.731829 [debug] [Thread-4 (]: Began executing node model.retail_project.fact_sales
[0m13:31:59.737192 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_project.fact_sales"
[0m13:31:59.740246 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.fact_sales"
[0m13:31:59.740820 [debug] [Thread-4 (]: On model.retail_project.fact_sales: BEGIN
[0m13:31:59.741213 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:31:59.756303 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m13:31:59.756991 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.fact_sales"
[0m13:31:59.757563 [debug] [Thread-4 (]: On model.retail_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.fact_sales"} */

  create view "retail_dwh"."mart"."fact_sales__dbt_tmp"
    
    
  as (
    with sales as (
    select
        transaction_id,
        transaction_date,
        customer_id,
        product_id,
        store_id,
        quantity,
        unit_price,
        quantity * unit_price as gross_sales
    from "retail_dwh"."staging"."stg_sales_transaction"
),

joined as (
    select
        s.transaction_id,
        s.transaction_date,
        s.customer_id,
        s.product_id,
        s.store_id,
        s.quantity,
        s.unit_price,
        s.gross_sales,

        c.customer_name,
        p.product_name,
        -- p.category,   -- sementara DIHAPUS biar nggak error
        st.store_name,
        st.store_city,
        st.store_region
    from sales s
    left join "retail_dwh"."mart"."dim_customer" c
        on s.customer_id = c.customer_id
    left join "retail_dwh"."mart"."dim_product" p
        on s.product_id = p.product_id
    left join "retail_dwh"."mart"."dim_store" st
        on s.store_id = st.store_id
)

select * from joined
  );
[0m13:31:59.762830 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:31:59.766114 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.fact_sales"
[0m13:31:59.766697 [debug] [Thread-4 (]: On model.retail_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.fact_sales"} */
alter table "retail_dwh"."mart"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m13:31:59.770591 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:31:59.772909 [debug] [Thread-4 (]: On model.retail_project.fact_sales: COMMIT
[0m13:31:59.773832 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.fact_sales"
[0m13:31:59.774594 [debug] [Thread-4 (]: On model.retail_project.fact_sales: COMMIT
[0m13:31:59.780344 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m13:31:59.783250 [debug] [Thread-4 (]: Applying DROP to: "retail_dwh"."mart"."fact_sales__dbt_backup"
[0m13:31:59.784099 [debug] [Thread-4 (]: Using postgres connection "model.retail_project.fact_sales"
[0m13:31:59.784463 [debug] [Thread-4 (]: On model.retail_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.fact_sales"} */
drop view if exists "retail_dwh"."mart"."fact_sales__dbt_backup" cascade
[0m13:31:59.787154 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:31:59.790351 [debug] [Thread-4 (]: Timing info for model.retail_project.fact_sales (execute): 13:31:59.732778 => 13:31:59.789948
[0m13:31:59.790847 [debug] [Thread-4 (]: On model.retail_project.fact_sales: Close
[0m13:31:59.793261 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63e7c36b-5c88-450e-b149-667c3853a17b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dc2f1f830>]}
[0m13:31:59.793996 [info ] [Thread-4 (]: 8 of 11 OK created sql view model mart.fact_sales .............................. [[32mCREATE VIEW[0m in 0.07s]
[0m13:31:59.794636 [debug] [Thread-4 (]: Finished running node model.retail_project.fact_sales
[0m13:31:59.798647 [debug] [Thread-3 (]: Began running node model.retail_project.customer_features
[0m13:31:59.800874 [debug] [Thread-2 (]: Began running node model.retail_project.daily_sales_kpi
[0m13:31:59.801855 [info ] [Thread-3 (]: 9 of 11 START sql table model analytics.customer_features ...................... [RUN]
[0m13:31:59.802955 [debug] [Thread-1 (]: Began running node model.retail_project.daily_store_sales
[0m13:31:59.805524 [info ] [Thread-2 (]: 10 of 11 START sql view model analytics.daily_sales_kpi ........................ [RUN]
[0m13:31:59.813651 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_project.dim_store, now model.retail_project.daily_sales_kpi)
[0m13:31:59.808620 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_project.dim_customer, now model.retail_project.customer_features)
[0m13:31:59.811858 [info ] [Thread-1 (]: 11 of 11 START sql table model analytics.daily_store_sales ..................... [RUN]
[0m13:31:59.814514 [debug] [Thread-2 (]: Began compiling node model.retail_project.daily_sales_kpi
[0m13:31:59.816011 [debug] [Thread-3 (]: Began compiling node model.retail_project.customer_features
[0m13:31:59.817722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_project.dim_product, now model.retail_project.daily_store_sales)
[0m13:31:59.822556 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_project.daily_sales_kpi"
[0m13:31:59.828597 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_project.customer_features"
[0m13:31:59.830955 [debug] [Thread-1 (]: Began compiling node model.retail_project.daily_store_sales
[0m13:31:59.834044 [debug] [Thread-2 (]: Timing info for model.retail_project.daily_sales_kpi (compile): 13:31:59.818804 => 13:31:59.832864
[0m13:31:59.835160 [debug] [Thread-3 (]: Timing info for model.retail_project.customer_features (compile): 13:31:59.824063 => 13:31:59.834872
[0m13:31:59.841494 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_project.daily_store_sales"
[0m13:31:59.843435 [debug] [Thread-2 (]: Began executing node model.retail_project.daily_sales_kpi
[0m13:31:59.846259 [debug] [Thread-3 (]: Began executing node model.retail_project.customer_features
[0m13:31:59.850190 [debug] [Thread-1 (]: Timing info for model.retail_project.daily_store_sales (compile): 13:31:59.836855 => 13:31:59.849536
[0m13:31:59.869512 [debug] [Thread-1 (]: Began executing node model.retail_project.daily_store_sales
[0m13:31:59.920545 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_project.customer_features"
[0m13:31:59.926558 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_project.daily_sales_kpi"
[0m13:31:59.946690 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.customer_features"
[0m13:31:59.948772 [debug] [Thread-3 (]: On model.retail_project.customer_features: BEGIN
[0m13:31:59.950152 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:31:59.958455 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_project.daily_store_sales"
[0m13:31:59.960533 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.daily_sales_kpi"
[0m13:31:59.961847 [debug] [Thread-2 (]: On model.retail_project.daily_sales_kpi: BEGIN
[0m13:31:59.962843 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:31:59.964298 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.daily_store_sales"
[0m13:31:59.965477 [debug] [Thread-1 (]: On model.retail_project.daily_store_sales: BEGIN
[0m13:31:59.966689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:31:59.969327 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m13:31:59.970001 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.customer_features"
[0m13:31:59.971357 [debug] [Thread-3 (]: On model.retail_project.customer_features: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.customer_features"} */

  
    

  create  table "retail_dwh"."analytics"."customer_features__dbt_tmp"
  
  
    as
  
  (
    with base as (
    select
        customer_id,
        customer_name,
        customer_signup_date,
        current_date - customer_signup_date as customer_tenure_days
    from "retail_dwh"."mart"."dim_customer"
),

agg_sales as (
    select
        customer_id,
        count(distinct transaction_id)        as total_txn,
        sum(gross_sales)                      as total_spent,
        max(transaction_date)::date           as last_transaction_date
    from "retail_dwh"."mart"."fact_sales"
    group by customer_id
)

select
    b.customer_id,
    b.customer_name,
    b.customer_signup_date,
    b.customer_tenure_days,

    a.total_txn                                 as frequency,
    a.total_spent                               as monetary,
    a.last_transaction_date,
    current_date - a.last_transaction_date      as recency_days,
    case
        when a.total_txn > 0 then a.total_spent / a.total_txn
        else null
    end                                         as avg_order_value
from base b
left join agg_sales a
  on b.customer_id = a.customer_id
  );
  
[0m13:31:59.988160 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:31:59.992130 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.daily_store_sales"
[0m13:31:59.993185 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m13:31:59.994762 [debug] [Thread-1 (]: On model.retail_project.daily_store_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.daily_store_sales"} */

  
    

  create  table "retail_dwh"."analytics"."daily_store_sales__dbt_tmp"
  
  
    as
  
  (
    with base as (
    select
        transaction_date::date    as date,
        store_id,
        store_name,
        store_city,
        sum(gross_sales)          as total_sales,
        sum(quantity)             as total_qty
    from "retail_dwh"."mart"."fact_sales"
    group by 1,2,3,4
)

select
    *,
    rank() over (partition by date order by total_sales desc) as sales_rank_in_day
from base
order by date, sales_rank_in_day
  );
  
[0m13:31:59.996075 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.daily_sales_kpi"
[0m13:31:59.997621 [debug] [Thread-2 (]: On model.retail_project.daily_sales_kpi: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.daily_sales_kpi"} */

  create view "retail_dwh"."analytics"."daily_sales_kpi__dbt_tmp"
    
    
  as (
    select
    transaction_date::date                            as date,
    sum(gross_sales)                                  as total_sales,
    sum(quantity)                                     as total_qty,
    count(distinct customer_id)                       as unique_customers,
    case
        when sum(quantity) > 0 then sum(gross_sales) / sum(quantity)
        else null
    end                                               as avg_price_per_unit,
    case
        when count(distinct transaction_id) > 0
            then sum(gross_sales) / count(distinct transaction_id)
        else null
    end                                               as avg_order_value
from "retail_dwh"."mart"."fact_sales"
group by 1
order by 1
  );
[0m13:32:00.001247 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:32:00.007885 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.daily_sales_kpi"
[0m13:32:00.008672 [debug] [Thread-2 (]: On model.retail_project.daily_sales_kpi: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.daily_sales_kpi"} */
alter table "retail_dwh"."analytics"."daily_sales_kpi__dbt_tmp" rename to "daily_sales_kpi"
[0m13:32:00.013304 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:32:00.027889 [debug] [Thread-2 (]: On model.retail_project.daily_sales_kpi: COMMIT
[0m13:32:00.028581 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.daily_sales_kpi"
[0m13:32:00.029103 [debug] [Thread-2 (]: On model.retail_project.daily_sales_kpi: COMMIT
[0m13:32:00.033471 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m13:32:00.036788 [debug] [Thread-2 (]: Applying DROP to: "retail_dwh"."analytics"."daily_sales_kpi__dbt_backup"
[0m13:32:00.037628 [debug] [Thread-2 (]: Using postgres connection "model.retail_project.daily_sales_kpi"
[0m13:32:00.038005 [debug] [Thread-2 (]: On model.retail_project.daily_sales_kpi: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.daily_sales_kpi"} */
drop view if exists "retail_dwh"."analytics"."daily_sales_kpi__dbt_backup" cascade
[0m13:32:00.041699 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:32:00.044155 [debug] [Thread-2 (]: Timing info for model.retail_project.daily_sales_kpi (execute): 13:31:59.854155 => 13:32:00.043899
[0m13:32:00.044562 [debug] [Thread-2 (]: On model.retail_project.daily_sales_kpi: Close
[0m13:32:00.046922 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63e7c36b-5c88-450e-b149-667c3853a17b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dc274fa10>]}
[0m13:32:00.047929 [info ] [Thread-2 (]: 10 of 11 OK created sql view model analytics.daily_sales_kpi ................... [[32mCREATE VIEW[0m in 0.23s]
[0m13:32:00.049127 [debug] [Thread-2 (]: Finished running node model.retail_project.daily_sales_kpi
[0m13:32:01.197413 [debug] [Thread-1 (]: SQL status: SELECT 99876 in 1.0 seconds
[0m13:32:01.204670 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.daily_store_sales"
[0m13:32:01.207306 [debug] [Thread-1 (]: On model.retail_project.daily_store_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.daily_store_sales"} */
alter table "retail_dwh"."analytics"."daily_store_sales" rename to "daily_store_sales__dbt_backup"
[0m13:32:01.209761 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:32:01.215212 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.daily_store_sales"
[0m13:32:01.215946 [debug] [Thread-1 (]: On model.retail_project.daily_store_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.daily_store_sales"} */
alter table "retail_dwh"."analytics"."daily_store_sales__dbt_tmp" rename to "daily_store_sales"
[0m13:32:01.220687 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:32:01.231622 [debug] [Thread-1 (]: On model.retail_project.daily_store_sales: COMMIT
[0m13:32:01.232113 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.daily_store_sales"
[0m13:32:01.232481 [debug] [Thread-1 (]: On model.retail_project.daily_store_sales: COMMIT
[0m13:32:01.260711 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:32:01.270260 [debug] [Thread-1 (]: Applying DROP to: "retail_dwh"."analytics"."daily_store_sales__dbt_backup"
[0m13:32:01.278918 [debug] [Thread-1 (]: Using postgres connection "model.retail_project.daily_store_sales"
[0m13:32:01.279433 [debug] [Thread-1 (]: On model.retail_project.daily_store_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.daily_store_sales"} */
drop table if exists "retail_dwh"."analytics"."daily_store_sales__dbt_backup" cascade
[0m13:32:01.324412 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:32:01.327060 [debug] [Thread-1 (]: Timing info for model.retail_project.daily_store_sales (execute): 13:31:59.870664 => 13:32:01.326742
[0m13:32:01.327503 [debug] [Thread-1 (]: On model.retail_project.daily_store_sales: Close
[0m13:32:01.329873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63e7c36b-5c88-450e-b149-667c3853a17b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dc2fec800>]}
[0m13:32:01.331294 [info ] [Thread-1 (]: 11 of 11 OK created sql table model analytics.daily_store_sales ................ [[32mSELECT 99876[0m in 1.51s]
[0m13:32:01.333393 [debug] [Thread-1 (]: Finished running node model.retail_project.daily_store_sales
[0m13:32:01.370139 [debug] [Thread-3 (]: SQL status: SELECT 100000 in 1.0 seconds
[0m13:32:01.376026 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.customer_features"
[0m13:32:01.376725 [debug] [Thread-3 (]: On model.retail_project.customer_features: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.customer_features"} */
alter table "retail_dwh"."analytics"."customer_features" rename to "customer_features__dbt_backup"
[0m13:32:01.377889 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:32:01.383089 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.customer_features"
[0m13:32:01.383851 [debug] [Thread-3 (]: On model.retail_project.customer_features: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.customer_features"} */
alter table "retail_dwh"."analytics"."customer_features__dbt_tmp" rename to "customer_features"
[0m13:32:01.384933 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:32:01.388805 [debug] [Thread-3 (]: On model.retail_project.customer_features: COMMIT
[0m13:32:01.389290 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.customer_features"
[0m13:32:01.389719 [debug] [Thread-3 (]: On model.retail_project.customer_features: COMMIT
[0m13:32:01.430270 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m13:32:01.438793 [debug] [Thread-3 (]: Applying DROP to: "retail_dwh"."analytics"."customer_features__dbt_backup"
[0m13:32:01.440501 [debug] [Thread-3 (]: Using postgres connection "model.retail_project.customer_features"
[0m13:32:01.441135 [debug] [Thread-3 (]: On model.retail_project.customer_features: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "retail_project", "target_name": "dev", "node_id": "model.retail_project.customer_features"} */
drop table if exists "retail_dwh"."analytics"."customer_features__dbt_backup" cascade
[0m13:32:01.609412 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:32:01.611544 [debug] [Thread-3 (]: Timing info for model.retail_project.customer_features (execute): 13:31:59.861892 => 13:32:01.611231
[0m13:32:01.611991 [debug] [Thread-3 (]: On model.retail_project.customer_features: Close
[0m13:32:01.618405 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63e7c36b-5c88-450e-b149-667c3853a17b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dc2739100>]}
[0m13:32:01.619136 [info ] [Thread-3 (]: 9 of 11 OK created sql table model analytics.customer_features ................. [[32mSELECT 100000[0m in 1.81s]
[0m13:32:01.620488 [debug] [Thread-3 (]: Finished running node model.retail_project.customer_features
[0m13:32:01.626919 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:01.627568 [debug] [MainThread]: On master: BEGIN
[0m13:32:01.628057 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:32:01.639789 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:32:01.640325 [debug] [MainThread]: On master: COMMIT
[0m13:32:01.640698 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:01.640994 [debug] [MainThread]: On master: COMMIT
[0m13:32:01.642006 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:32:01.642439 [debug] [MainThread]: On master: Close
[0m13:32:01.643317 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:32:01.643784 [debug] [MainThread]: Connection 'model.retail_project.daily_store_sales' was properly closed.
[0m13:32:01.644065 [debug] [MainThread]: Connection 'model.retail_project.daily_sales_kpi' was properly closed.
[0m13:32:01.644375 [debug] [MainThread]: Connection 'model.retail_project.customer_features' was properly closed.
[0m13:32:01.644713 [debug] [MainThread]: Connection 'model.retail_project.fact_sales' was properly closed.
[0m13:32:01.645295 [info ] [MainThread]: 
[0m13:32:01.646159 [info ] [MainThread]: Finished running 9 view models, 2 table models in 0 hours 0 minutes and 2.96 seconds (2.96s).
[0m13:32:01.649199 [debug] [MainThread]: Command end result
[0m13:32:01.662690 [info ] [MainThread]: 
[0m13:32:01.663628 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:32:01.664180 [info ] [MainThread]: 
[0m13:32:01.664729 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m13:32:01.667330 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.5371997, "process_user_time": 3.282948, "process_kernel_time": 1.14106, "process_mem_max_rss": "151492", "process_out_blocks": "2000", "process_in_blocks": "0"}
[0m13:32:01.668136 [debug] [MainThread]: Command `dbt run` succeeded at 13:32:01.667904 after 3.54 seconds
[0m13:32:01.668725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dc41437d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dc42e3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dc2b53dd0>]}
[0m13:32:01.669284 [debug] [MainThread]: Flushing usage events
[0m13:32:08.743859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb169d61700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16a638170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb169d63170>]}


============================== 13:32:08.747954 | eebbb67f-b43e-4882-a015-bcd535ae3496 ==============================
[0m13:32:08.747954 [info ] [MainThread]: Running with dbt=1.7.0
[0m13:32:08.752915 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/opt/dbt/retail_project/retail_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /root/.dbt', 'send_anonymous_usage_stats': 'True'}
[0m13:32:09.028133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eebbb67f-b43e-4882-a015-bcd535ae3496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16a0beb40>]}
[0m13:32:09.189230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eebbb67f-b43e-4882-a015-bcd535ae3496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb169c13d70>]}
[0m13:32:09.191149 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m13:32:09.208722 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m13:32:09.253902 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:32:09.254658 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:32:09.255716 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail_project.intermediate
[0m13:32:09.265160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eebbb67f-b43e-4882-a015-bcd535ae3496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb169c50f20>]}
[0m13:32:09.291059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eebbb67f-b43e-4882-a015-bcd535ae3496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16939d370>]}
[0m13:32:09.292692 [info ] [MainThread]: Found 11 models, 4 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m13:32:09.293681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eebbb67f-b43e-4882-a015-bcd535ae3496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1696f9940>]}
[0m13:32:09.296847 [info ] [MainThread]: 
[0m13:32:09.298314 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:32:09.301550 [debug] [MainThread]: Command end result
[0m13:32:09.315821 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.6374055, "process_user_time": 3.490847, "process_kernel_time": 0.34918, "process_mem_max_rss": "151496", "process_out_blocks": "1656", "process_in_blocks": "0"}
[0m13:32:09.316927 [debug] [MainThread]: Command `dbt test` succeeded at 13:32:09.316744 after 0.64 seconds
[0m13:32:09.318545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16a638170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb169f83b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1696f9550>]}
[0m13:32:09.319027 [debug] [MainThread]: Flushing usage events
